# Core FastAPI - Versions stables
fastapi==0.112.2
uvicorn[standard]==0.30.6
python-dotenv==1.0.1

# HTTP clients - Versions compatibles
httpx==0.27.0
httpcore==1.0.5

# OpenAI API - Version LTS stable
openai==1.42.0

# CORRIGÉ: Weaviate Client - Version mise à jour pour corriger les erreurs API
weaviate-client==4.16.10

# Redis pour cache - Versions synchronisées
redis==5.0.1
hiredis==2.3.2

# Intelligence métier - Versions testées
langdetect==1.0.9
transformers==4.45.2
torch>=2.0.0,<2.5.0

# Traitement de texte - CRITIQUE pour normalisation
unidecode==1.3.8

# Reranking et similarité - Versions compatibles
sentence-transformers==3.1.1
voyageai==0.2.3

# === CORRIGÉ: LangSmith pour monitoring LLM ===
# Mise à jour vers versions compatibles
langchain-core==0.1.16
langsmith>=0.0.83,<0.1.0

# Utilitaires de base - Versions stables
numpy>=1.24.0,<2.0.0
scipy>=1.11.0,<1.15.0
pandas>=2.0.0,<3.0.0

# Sécurité et validation - Pydantic v2 stable
pydantic>=2.8.0,<3.0.0
email-validator==2.1.0

# Monitoring et logging
prometheus-client==0.20.0
structlog==23.2.0

# Support fichiers
openpyxl==3.1.2

# Tests - Versions compatibles
pytest==8.3.3
pytest-asyncio==0.24.0

# Outils développement
black==24.10.0
flake8==7.1.1

# Async et agents
dataclasses-json==0.6.7
asyncio-throttle==1.0.2

# Compatibilité Python 3.13
typing-extensions>=4.8.0

# ===== CONTRAINTES DE SÉCURITÉ =====

# Éviter les vulnérabilités connues
urllib3>=2.0.0,<3.0.0
certifi>=2023.7.22

# Versions minimales pour sécurité
cryptography>=41.0.0
requests>=2.31.0

# ===== OPTIMISATIONS POUR DÉPLOIEMENT =====

# Compression et performance
brotli>=1.0.9
zstandard>=0.22.0

# Monitoring système
psutil>=5.9.0

# ===== NOTES DE COMPATIBILITÉ =====

# Weaviate 4.16.10 : CORRIGÉ - Version récente qui résout les erreurs API
#   - Corrige les erreurs "near_vector() got an unexpected keyword argument 'vector'"
#   - Corrige les erreurs "hybrid() got an unexpected keyword argument 'where'" 
#   - Supporte correctement les dimensions vectorielles mixtes
#   - API v4 complètement stabilisée
# Redis 5.0.1 : Compatible avec toutes les fonctionnalités async
# OpenAI 1.42.0 : API stable avec support streaming
# Transformers 4.45.2 : Dernière version stable sans breaking changes
# Torch <2.5.0 : Évite les incompatibilités récentes
# Numpy <2.0.0 : Évite les breaking changes v2
# Pydantic <3.0.0 : Reste sur v2 pour stabilité
# LangSmith >=0.0.83,<0.1.0 : Compatible avec langchain-core 0.1.16

# ===== VARIABLES D'ENVIRONNEMENT DIGITAL OCEAN =====

# À configurer dans Digital Ocean App Platform :
# REDIS_URL=redis://localhost:6379
# WEAVIATE_URL=http://localhost:8080
# OPENAI_API_KEY=your_key_here
# LANGSMITH_API_KEY=your_langsmith_key_here
# LANGSMITH_PROJECT=intelia-aviculture
# CACHE_ENABLED=true
# CACHE_TOTAL_MEMORY_LIMIT_MB=100
# ENABLE_INTELLIGENT_RRF=false
# RRF_LEARNING_MODE=true
# RRF_GENETIC_BOOST=true
# LOG_LEVEL=INFO

# ===== CHANGEMENTS PRINCIPAUX =====

# 1. weaviate-client: 4.7.1 → 4.16.10 
#    - Résout les erreurs d'API v4 constatées dans les logs
#    - Compatible avec le code existant dans retriever.py
#    - Supporte les corrections runtime déjà implémentées
#
# 2. Cette mise à jour devrait éliminer :
#    - ❌ near_vector() got an unexpected keyword argument 'vector'
#    - ❌ hybrid() got an unexpected keyword argument 'where'
#    - ❌ vector lengths don't match (meilleure gestion des dimensions)
#    - ❌ Le mode dégradé au démarrage