# Voice Realtime - Redis & Sentry Implementation

**Date**: 2025-10-28
**Status**: ‚úÖ Impl√©ment√©
**Version**: 1.0.0
**Tasks**: #3 Voice Redis Migration, #4 Voice Monitoring Sentry, #5 Voice JWT Auth

---

## üìã Vue d'ensemble

Impl√©mentation compl√®te de:
1. **Redis** pour persistence des sessions Voice & rate limiting
2. **Sentry** pour error tracking et monitoring
3. **V√©rification JWT Auth** (d√©j√† impl√©ment√©, document√©)

---

## ‚úÖ Ce qui a √©t√© impl√©ment√©

### 1. Redis Session Storage (#3)

**Probl√®me r√©solu**:
- ‚ùå Sessions Voice stock√©es en m√©moire ‚Üí perdues au red√©marrage
- ‚ùå Rate limiting en m√©moire ‚Üí pas de partage entre instances

**Solution**:
- ‚úÖ Service Redis avec fallback graceful vers in-memory
- ‚úÖ Sessions persist√©es dans Redis (TTL 1h)
- ‚úÖ Rate limiting partag√© entre instances
- ‚úÖ Auto-reconnexion si Redis down

**Fichiers cr√©√©s/modifi√©s**:
- ‚ú® `backend/app/services/redis_session_service.py` (nouveau)
- ‚úèÔ∏è `backend/app/api/v1/voice_realtime.py` (modifi√©)
- ‚úèÔ∏è `backend/requirements.txt` (+redis>=5.0.0)

**API Redis Service**:
```python
from app.services.redis_session_service import redis_session_service

# Session management
redis_session_service.save_session(session_id, data)
redis_session_service.get_session(session_id)
redis_session_service.delete_session(session_id)

# Rate limiting
redis_session_service.check_rate_limit(user_id, max_sessions=5, window_seconds=3600)
redis_session_service.reset_rate_limit(user_id)

# Health check
redis_session_service.health_check()
```

---

### 2. Sentry Error Tracking (#4)

**Probl√®me r√©solu**:
- ‚ùå Pas de monitoring des erreurs Voice en production
- ‚ùå Difficile de debugger sans logs centralis√©s

**Solution**:
- ‚úÖ Sentry configur√© globalement dans `main.py`
- ‚úÖ Capture automatique des erreurs FastAPI
- ‚úÖ Logging int√©gr√© (ERROR+ envoy√© √† Sentry)
- ‚úÖ Performance monitoring (10% sample rate)
- ‚úÖ Configuration optionnelle via env vars

**Fichiers modifi√©s**:
- ‚úèÔ∏è `backend/app/main.py` (ajout Sentry init)
- ‚úèÔ∏è `backend/requirements.txt` (+sentry-sdk[fastapi]>=1.40.0)

**Configuration Sentry**:
```python
# Dans main.py (d√©j√† fait)
if SENTRY_DSN:
    sentry_sdk.init(
        dsn=SENTRY_DSN,
        environment=SENTRY_ENVIRONMENT,
        traces_sample_rate=0.1,
        profiles_sample_rate=0.1,
        integrations=[FastApiIntegration(), LoggingIntegration()],
        release=os.getenv("APP_VERSION", "1.4.1")
    )
```

---

### 3. JWT Auth Voice WebSocket (#5)

**Status**: ‚úÖ **D√âJ√Ä IMPL√âMENT√â** (v√©rification faite)

**S√©curit√© en place**:
- ‚úÖ JWT token requis via query param `?token=JWT_HERE`
- ‚úÖ Fonction `get_current_user_from_websocket()` d√©j√† utilis√©e
- ‚úÖ Plan verification: Voice r√©serv√© aux plans **Elite & Intelia**
- ‚úÖ Rate limiting: 5 sessions/heure/utilisateur
- ‚úÖ Session timeout: 10 minutes max

**Code (lignes 656-663 de voice_realtime.py)**:
```python
user = await get_current_user_from_websocket(websocket)
user_id = user.get("user_id")
user_email = user.get("email")
logger.info(f"‚úÖ User authenticated: {user_email} (id: {user_id})")
```

**Flow de s√©curit√© complet**:
```
1. Client ouvre WebSocket avec ?token=JWT
   ‚Üì
2. Backend v√©rifie JWT (get_current_user_from_websocket)
   ‚Üì
3. V√©rif plan (Elite/Intelia requis)
   ‚Üì
4. Rate limiting (Redis ou fallback)
   ‚Üì
5. Session cr√©√©e (max 10 min)
   ‚Üì
6. Streaming bidirectionnel OpenAI Realtime
```

---

## üîß Configuration requise

### Variables d'environnement Digital Ocean App Platform

Voici **TOUTES les variables d'environnement** √† ajouter:

```bash
# ============================================================================
# REDIS (Nouveau - Task #3)
# ============================================================================

# Option 1: DigitalOcean Managed Redis (RECOMMAND√â)
REDIS_URL=redis://default:PASSWORD@db-redis-XXXXX.ondigitalocean.com:25061
REDIS_ENABLED=true

# Option 2: Redis externe (AWS ElastiCache, Upstash, etc.)
REDIS_URL=redis://username:password@host:port/0
REDIS_ENABLED=true

# Option 3: Pas de Redis (fallback in-memory) - PAS RECOMMAND√â
REDIS_ENABLED=false

# ============================================================================
# SENTRY (Nouveau - Task #4)
# ============================================================================

# Option 1: Avec Sentry (RECOMMAND√â pour production)
SENTRY_DSN=https://examplePublicKey@o0.ingest.sentry.io/0
SENTRY_ENVIRONMENT=production  # ou staging, development

# Option 2: Sans Sentry (d√©veloppement local)
# (Ne pas d√©finir SENTRY_DSN)

# ============================================================================
# VOICE REALTIME (D√©j√† existants - Task #5)
# ============================================================================

ENABLE_VOICE_REALTIME=true
OPENAI_API_KEY=sk-proj-...  # Requis pour Voice
WEAVIATE_URL=https://...  # Optionnel pour RAG
WEAVIATE_API_KEY=...  # Si Weaviate activ√©

# ============================================================================
# AUTRES VARIABLES (D√©j√† configur√©es normalement)
# ============================================================================

DATABASE_URL=postgresql://...
STRIPE_SECRET_KEY=sk_live_...
# ... etc (vos variables existantes)
```

---

## üì¶ Setup Digital Ocean

### √âtape 1: Cr√©er Managed Redis

**Via Dashboard DO**:
1. Databases ‚Üí Create ‚Üí Redis
2. Choisir datacenter (m√™me r√©gion que votre app)
3. Taille: **Basic** (512MB suffit pour Voice)
4. Nom: `voice-sessions-redis`
5. Cr√©er

**R√©cup√©rer connexion**:
```
Connection String ‚Üí copier
Format: redis://default:PASSWORD@host:25061
```

### √âtape 2: Lier Redis √† l'app

**Via App Platform**:
1. Votre app ‚Üí Settings ‚Üí App-Level Environment Variables
2. Add Variable:
   - Key: `REDIS_URL`
   - Value: `redis://default:PASSWORD@...`
   - Type: Encrypted ‚úÖ
3. Add Variable:
   - Key: `REDIS_ENABLED`
   - Value: `true`
   - Type: Plain text
4. Save

### √âtape 3: Configurer Sentry (Optionnel)

**Cr√©er projet Sentry**:
1. Aller sur sentry.io
2. Create Project ‚Üí FastAPI
3. Copier DSN: `https://...@o0.ingest.sentry.io/...`

**Ajouter √† DO**:
1. App Platform ‚Üí Environment Variables
2. Add Variable:
   - Key: `SENTRY_DSN`
   - Value: `https://...`
   - Type: Encrypted ‚úÖ
3. Add Variable:
   - Key: `SENTRY_ENVIRONMENT`
   - Value: `production`
   - Type: Plain text

### √âtape 4: Red√©ployer

```bash
# Les changements requirements.txt d√©clencheront rebuild automatique
# Ou manuellement:
git push origin main

# Sur DO App Platform:
# ‚Üí Automatic deploy d√©marrera
# ‚Üí Installer redis + sentry-sdk
# ‚Üí Red√©marrer app avec nouvelles variables
```

---

## üß™ Tests

### Test 1: V√©rifier Redis

```bash
# Health check
curl https://expert.intelia.com/api/v1/voice/health

# R√©ponse attendue:
{
  "status": "healthy",
  "feature_enabled": true,
  "openai_configured": true,
  "weaviate_enabled": false,
  "redis": {
    "redis_available": true,
    "redis_enabled": true,
    "using_fallback": false,
    "redis_url": "redis://default:***@host:25061",
    "redis_version": "7.0.12",
    "connected_clients": 1,
    "used_memory_human": "1.23M"
  },
  "timestamp": "2025-10-28T..."
}
```

### Test 2: V√©rifier Sentry

```bash
# D√©clencher une erreur test
# Dans un endpoint temporaire ou logs:
import sentry_sdk
sentry_sdk.capture_message("Test Sentry integration", level="info")

# Aller sur sentry.io ‚Üí Issues
# ‚Üí Devrait voir "Test Sentry integration"
```

### Test 3: Tester persistence sessions

**Sc√©nario**:
1. Utilisateur cr√©e session Voice
2. Backend restart (simulate)
3. Session devrait persister dans Redis

**Test**:
```bash
# 1. Cr√©er session Voice depuis frontend
# (Ouvrir assistant vocal)

# 2. V√©rifier Redis
curl https://expert.intelia.com/api/v1/voice/health
# ‚Üí redis.connected_clients > 0

# 3. Restart backend
# (Sur DO: Manual restart ou redeploy)

# 4. V√©rifier session toujours l√†
# (R√©ouvrir assistant vocal)
# ‚Üí Devrait reconnecter sans probl√®me
```

### Test 4: Tester rate limiting

```bash
# Cr√©er 6 sessions Voice rapidement
# (Normalement limite = 5/heure)

# 6√®me session devrait √™tre refus√©e:
WebSocket Error 1008: "Rate limit exceeded (5 sessions/hour max)"
```

---

## üîç Monitoring & Debugging

### Logs √† surveiller

```bash
# Logs backend (DO App Platform ‚Üí Runtime Logs)

# Succ√®s Redis:
‚úÖ Redis connected successfully: redis://...

# Fallback in-memory:
‚ö†Ô∏è Redis connection failed: [Errno 111] Connection refused
‚ö†Ô∏è Falling back to in-memory session storage

# Sentry init:
‚úÖ Sentry initialized: production

# Rate limiting:
‚ö†Ô∏è Rate limit exceeded for user abc123: 5/5
```

### Dashboard Sentry

**Issues √† surveiller**:
- Erreurs WebSocket Voice (ConnectionError, TimeoutError)
- Erreurs OpenAI API (RateLimitError, APIError)
- Erreurs Redis (ConnectionError si down)

**Performance**:
- Latence WebSocket connection
- Dur√©e des sessions Voice
- Taux d'erreur Voice vs total requests

### M√©triques Redis (via DO Dashboard)

- **CPU Usage**: Devrait rester < 50%
- **Memory Usage**: Devrait rester < 80%
- **Connections**: Nombre d'instances backend connect√©es
- **Commands/sec**: Nombre d'op√©rations Redis

---

## üìä Architecture finale

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    USER (Frontend)                  ‚îÇ
‚îÇ              useVoiceRealtime.ts hook               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ WebSocket ?token=JWT
                  ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              BACKEND (FastAPI)                      ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  voice_realtime.py                           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  1. Accept WebSocket                         ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  2. Verify JWT (get_current_user_from_ws)    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  3. Check plan (Elite/Intelia only)          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  4. Rate limit via Redis ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  5. Create VoiceRealtimeSession        ‚îÇ     ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  redis_session_service.py                    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - save_session()                            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - get_session()                             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - check_rate_limit()                        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Fallback to in-memory if Redis down      ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                 ‚îÇ                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚Üì                      ‚Üì                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Redis     ‚îÇ    ‚îÇ  OpenAI Realtime ‚îÇ    ‚îÇ   Sentry    ‚îÇ
‚îÇ  (Sessions) ‚îÇ    ‚îÇ      API         ‚îÇ    ‚îÇ  (Errors)   ‚îÇ
‚îÇ             ‚îÇ    ‚îÇ                  ‚îÇ    ‚îÇ             ‚îÇ
‚îÇ DO Managed  ‚îÇ    ‚îÇ  Streaming       ‚îÇ    ‚îÇ  Dashboard  ‚îÇ
‚îÇ Redis DB    ‚îÇ    ‚îÇ  Audio <-> Text  ‚îÇ    ‚îÇ  Alerts     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üö® Troubleshooting

### Probl√®me: Redis connection failed

**Cause**: Redis URL incorrecte ou Redis down

**Solution**:
```bash
# 1. V√©rifier Redis est running (DO Dashboard)
# 2. V√©rifier REDIS_URL correcte
# 3. V√©rifier firewall/network (Redis doit √™tre accessible)

# Test connexion:
redis-cli -u $REDIS_URL ping
# ‚Üí Devrait retourner PONG
```

### Probl√®me: Sentry events not showing

**Cause**: SENTRY_DSN invalide ou environnement filtr√©

**Solution**:
```bash
# 1. V√©rifier SENTRY_DSN correcte
# 2. V√©rifier projet Sentry existe
# 3. Check environment filters dans Sentry settings

# Test manuel:
import sentry_sdk
sentry_sdk.capture_exception(Exception("Test error"))
```

### Probl√®me: Rate limit pas partag√© entre instances

**Cause**: Redis pas utilis√© (fallback in-memory)

**Solution**:
```bash
# V√©rifier logs backend:
# Si "Falling back to in-memory" ‚Üí Redis connection issue
# Fix Redis connection, redeploy
```

### Probl√®me: Sessions perdues apr√®s restart

**Cause**: Redis d√©sactiv√© ou sessions TTL expir√©

**Solution**:
```bash
# 1. V√©rifier REDIS_ENABLED=true
# 2. V√©rifier Redis accessible
# 3. Sessions ont TTL 1h (normal qu'elles expirent)
```

---

## üìù Maintenance

### Mise √† jour exchange rates

Non applicable pour Voice (pas de pricing)

### Mise √† jour Redis version

```bash
# Sur DO Managed Redis:
# 1. Dashboard ‚Üí Redis DB ‚Üí Settings
# 2. Upgrade to latest version
# 3. Scheduled maintenance window
# 4. Auto-upgrade avec minimal downtime
```

### Rotation Sentry DSN

```bash
# Si DSN compromise:
# 1. Sentry Dashboard ‚Üí Project Settings ‚Üí Client Keys
# 2. Revoke old DSN
# 3. Create new DSN
# 4. Update DO env var SENTRY_DSN
# 5. Redeploy
```

---

## üéØ Next Steps (Optionnel)

### Court terme

1. **Datadog metrics** (si budget)
   - Voice session duration metrics
   - OpenAI API latency tracking
   - Redis performance metrics

2. **Structured logging**
   - Remplacer logging standard par structlog
   - Logs JSON pour parsing automatique
   - Better query dans Sentry/Datadog

### Moyen terme

3. **Session replay Sentry**
   - Voir ce que l'utilisateur faisait avant erreur
   - Frontend integration required

4. **Redis Cluster** (si scaling)
   - Passer de Basic √† Professional
   - High availability + auto-failover

### Long terme

5. **Multi-region Redis**
   - Redis global pour latence minimale
   - Geo-replication

---

## üìö R√©f√©rences

- [Redis Python Client](https://redis-py.readthedocs.io/)
- [Sentry FastAPI Integration](https://docs.sentry.io/platforms/python/guides/fastapi/)
- [DigitalOcean Managed Redis](https://docs.digitalocean.com/products/databases/redis/)
- [Voice Realtime Phase 1](../reports/VOICE_REALTIME_PHASE1_COMPLETE.md)

---

## ‚úÖ Checklist d√©ploiement

- [ ] `requirements.txt` mis √† jour (redis + sentry-sdk)
- [ ] Code Redis service cr√©√©
- [ ] Code Sentry init ajout√© √† main.py
- [ ] Variables env Digital Ocean configur√©es:
  - [ ] `REDIS_URL`
  - [ ] `REDIS_ENABLED=true`
  - [ ] `SENTRY_DSN` (optionnel)
  - [ ] `SENTRY_ENVIRONMENT=production`
- [ ] Managed Redis DB cr√©√© sur DO
- [ ] Projet Sentry cr√©√© (si utilis√©)
- [ ] App red√©ploy√©e
- [ ] Tests health check passent
- [ ] Test session Voice fonctionne
- [ ] Test rate limiting fonctionne
- [ ] Logs backend v√©rifi√©s (Redis connected, Sentry initialized)
- [ ] Dashboard Sentry v√©rifi√© (events arrivent)

---

**Implementation compl√®te! Toutes les t√¢ches #3, #4, #5 sont termin√©es. üéâ**
