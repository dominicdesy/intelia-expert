# 🚀 REQUIREMENTS.TXT - DIGITAL OCEAN APP PLATFORM OPTIMIZED - VERSION FINALE
# 🔧 Toutes les corrections critiques appliquées pour éliminer les erreurs des logs

# =============================================================================
# CORE FASTAPI - Versions stables testées
# =============================================================================
fastapi==0.104.1
uvicorn[standard]==0.24.0
python-multipart==0.0.6
pydantic==2.5.0
email-validator==2.1.0.post1

# =============================================================================
# SUPABASE - Version compatible
# =============================================================================
supabase>=2.9.0,<3.0.0

# =============================================================================
# AUTH & SECURITY - Versions éprouvées
# =============================================================================
PyJWT==2.8.0
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4

# =============================================================================
# 🔧 OPENAI - CORRECTION CRITIQUE APPLIQUÉE
# =============================================================================
# ✅ CORRECTION: Version compatible sans paramètre 'proxies'
openai==1.51.0
# ANCIEN: openai==1.3.0 (causait l'erreur AsyncClient proxies)

# =============================================================================
# 🔧 HTTPX - CORRECTION DIGITAL OCEAN APP PLATFORM
# =============================================================================
# ✅ CORRECTION: Version compatible pour éviter l'erreur AsyncHttpxClientWrapper
httpx>=0.25.0,<0.26.0
# Résout: 'AsyncHttpxClientWrapper' object has no attribute '_state'

# =============================================================================
# RAG SYSTEM - Versions optimisées et compatibles
# =============================================================================
torch==2.2.2
torchvision==0.17.2
transformers==4.40.0
sentence-transformers==2.7.0
faiss-cpu==1.8.0
numpy==1.26.4

# 🔧 CORRECTION WARNINGS HUGGING FACE
huggingface_hub>=0.24.0
# Résout: FutureWarning resume_download deprecated
safetensors==0.4.3

# =============================================================================
# 🔧 PARSERS DOCUMENTS - CORRECTION WARNINGS CRITIQUES
# =============================================================================
# ✅ CORRECTION: Ajouter langchain-community pour parseurs complets
langchain==0.2.16
langchain-community==0.2.16
# Résout: Module langchain_community.document_loaders not found

# ✅ DATA PROCESSING - Requis pour parseurs avancés
pandas==2.2.2

# =============================================================================
# UTILS - Versions stables
# =============================================================================
python-dotenv==1.0.0
aiofiles==23.2.1
toml==0.10.2

# =============================================================================
# ML LIBS - Versions compatibles RAG
# =============================================================================
scikit-learn==1.4.2
scipy==1.13.0
tqdm==4.66.1
pillow==10.3.0

# =============================================================================
# HTTP REQUESTS
# =============================================================================
requests==2.31.0

# =============================================================================
# 🔧 CORRECTIONS FINALES DIGITAL OCEAN APP PLATFORM
# =============================================================================

# ✅ TYPING EXTENSIONS - Pour compatibilité Python 3.11
typing-extensions>=4.8.0

# ✅ ASYNC COMPATIBILITY - Pour éviter conflits asyncio
asyncio-compat==1.0.0

# ✅ PARSING UNIVERSEL (optionnel mais recommandé)
# Décommenter si vous voulez le parsing universel Tika
# tika==2.6.0

# =============================================================================
# 📊 RÉSUMÉ DES CORRECTIONS APPLIQUÉES
# =============================================================================
# 
# ✅ openai: 1.3.0 → 1.51.0 (corrige erreur proxies AsyncClient)
# ✅ httpx: Ajouté avec version compatible (corrige AsyncHttpxClientWrapper)
# ✅ langchain-community: Ajouté (corrige parseurs documents)
# ✅ huggingface_hub: Version mise à jour (corrige warnings deprecation)
# ✅ typing-extensions: Ajouté (compatibilité Python 3.11)
# ✅ asyncio-compat: Ajouté (évite conflits asyncio)
# ✅ pandas: Ajouté (requis pour parseurs avancés)
#
# 🎯 RÉSULTAT ATTENDU APRÈS DÉPLOIEMENT:
# - ❌ AsyncClient proxies error → ✅ RÉSOLU
# - ❌ AsyncHttpxClientWrapper _state error → ✅ RÉSOLU  
# - ❌ langchain_community not found → ✅ RÉSOLU
# - ❌ Hugging Face deprecation warnings → ✅ RÉSOLU
# - ✅ OpenAI IA pleinement fonctionnelle
# - ✅ Parsing de documents complet
# - ✅ Système 100% opérationnel sur Digital Ocean
#
# =============================================================================s