exports.id=190,exports.ids=[190],exports.modules={679:(e,n,t)=>{Promise.resolve().then(t.bind(t,2711)),Promise.resolve().then(t.bind(t,8054)),Promise.resolve().then(t.bind(t,5174))},6428:(e,n,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},2711:(e,n,t)=>{"use strict";t.d(n,{AuthProvider:()=>i});var r=t(326),a=t(7577),o=t(799);t(2960);function i({children:e}){const{hasHydrated:n,setHasHydrated:t,checkAuth:i}=(0,o.useAuthStore)();(0,a.useRef)(!0),(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(!1),(0,a.useRef)(null);return r.jsx(r.Fragment,{children:e})}},8054:(e,n,t)=>{"use strict";t.d(n,{LanguageProvider:()=>i});var r=t(326),a=t(7577),o=t(6007);t(4619);function i({children:e}){const{changeLanguage:n,currentLanguage:t}=(0,o.$G)();(0,a.useRef)(!1),(0,a.useRef)(!1);return r.jsx(r.Fragment,{children:e})}},4619:(e,n,t)=>{"use strict";t.d(n,{Ik:()=>o,L_:()=>i,Yc:()=>s,k$:()=>a,mT:()=>r});const r=[{code:"fr",name:"French",nativeName:"Fran\xe7ais",region:"France",flag:"\ud83c\uddeb\ud83c\uddf7",dateFormat:"fr-FR"},{code:"en",name:"English",nativeName:"English",region:"United States",flag:"\ud83c\uddfa\ud83c\uddf8",dateFormat:"en-US"},{code:"es",name:"Spanish",nativeName:"Espa\xf1ol",region:"Spain",flag:"\ud83c\uddea\ud83c\uddf8",dateFormat:"es-ES"},{code:"pt",name:"Portuguese",nativeName:"Portugu\xeas",region:"Portugal",flag:"\ud83c\uddf5\ud83c\uddf9",dateFormat:"pt-PT"},{code:"de",name:"German",nativeName:"Deutsch",region:"Germany",flag:"\ud83c\udde9\ud83c\uddea",dateFormat:"de-DE"},{code:"nl",name:"Dutch",nativeName:"Nederlands",region:"Netherlands",flag:"\ud83c\uddf3\ud83c\uddf1",dateFormat:"nl-NL"},{code:"pl",name:"Polish",nativeName:"Polski",region:"Poland",flag:"\ud83c\uddf5\ud83c\uddf1",dateFormat:"pl-PL"},{code:"th",name:"Thai",nativeName:"\u0e44\u0e17\u0e22",region:"Thailand",flag:"\ud83c\uddf9\ud83c\udded",dateFormat:"th-TH"},{code:"hi",name:"Hindi",nativeName:"\u0939\u093f\u0902\u0926\u0940",region:"India",flag:"\ud83c\uddee\ud83c\uddf3",dateFormat:"hi-IN"},{code:"zh",name:"Chinese (Mandarin)",nativeName:"\u4e2d\u6587",region:"China",flag:"\ud83c\udde8\ud83c\uddf3",dateFormat:"zh-CN"}],a="en",o=e=>r.find((n=>n.code===e)),i=e=>r.some((n=>n.code===e)),s=()=>a;new Set(["ar","he","fa","ur"])},6007:(e,n,t)=>{"use strict";t.d(n,{$G:()=>f,Ik:()=>o.Ik,mT:()=>o.mT});var r=t(7577),a=t(2960),o=t(4619);const i=(0,a.getSupabaseClient)();class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter((n=>n!==e))}}notify(){this.subscribers.forEach((e=>{try{e()}catch(n){console.error("Erreur notification i18n:",n)}}))}constructor(){this.subscribers=[]}}const l=s.getInstance(),u={},c=new Set;let d={},g=!0,m=null;const h=()=>{try{const e=localStorage.getItem("intelia-language");if(e){const n=JSON.parse(e);return n?.state?.currentLanguage||o.k$}}catch(e){console.warn("Erreur lecture langue stock\xe9e:",e)}return o.k$};async function p(e){if(c.has(e))return console.warn(`[i18n] Langue ${e} en cache d'erreur, utilisation de ${o.k$}`),e===o.k$?{}:p(o.k$);if(u[e])return d=u[e],g=!1,m=e,l.notify(),u[e];try{const n=await fetch(`/locales/${e}.json`);if(!n.ok)throw new Error(`HTTP ${n.status}: Failed to load translations for ${e}`);const t=await n.json();if(!t||"object"!==typeof t||0===Object.keys(t).length)throw new Error(`Empty or invalid translations for ${e}`);return u[e]=t,d=t,g=!1,m=e,l.notify(),console.log(`[i18n] \u2705 Traductions charg\xe9es pour ${e}: ${Object.keys(t).length} cl\xe9s`),t}catch(n){return console.error(`[i18n] \u274c Could not load translations for ${e}:`,n),c.add(e),e!==o.k$?(console.warn(`[i18n] \ud83d\udd04 Falling back to ${o.k$}`),p(o.k$)):(console.error(`[i18n] \ud83d\udca5 Even ${o.k$} failed to load, returning empty translations`),{})}}const f=()=>{const[e,n]=(0,r.useState)(o.k$),[t,a]=(0,r.useState)({}),[s,m]=(0,r.useState)(!0),[,f]=(0,r.useState)({});(0,r.useEffect)((()=>l.subscribe((()=>{f({})}))),[]),(0,r.useEffect)((()=>{(async()=>{try{const e=h();if(e&&(0,o.L_)(e))return console.log(`[i18n] \ud83d\udce6 Initialisation avec langue stock\xe9e: ${e}`),void n(e);const{data:{session:t}}=await i.auth.getSession(),r=t?.user?.user_metadata?.language;if(r&&(0,o.L_)(r))return console.log(`[i18n] \ud83d\udce6 Initialisation avec langue Supabase: ${r}`),void n(r);const a=(0,o.Yc)();console.log(`[i18n] \ud83d\udce6 Initialisation avec langue navigateur: ${a}`),n(a)}catch(e){console.log("Erreur initialisation langue, utilisation navigateur");const t=(0,o.Yc)();n(t)}})()}),[]),(0,r.useEffect)((()=>{const t=setInterval((()=>{const t=h();t&&t!==e&&(0,o.L_)(t)&&(console.log(`[i18n] \ud83d\udd04 Resynchronisation d\xe9tect\xe9e: ${e} \u2192 ${t}`),n(t))}),1e3);return()=>{clearInterval(t)}}),[e]),(0,r.useEffect)((()=>{const t=t=>{if("intelia-language"===t.key&&t.newValue)try{const r=JSON.parse(t.newValue),a=r?.state?.currentLanguage;a&&a!==e&&(0,o.L_)(a)&&(console.log(`[i18n] \ud83d\udd04 Changement localStorage d\xe9tect\xe9: ${e} \u2192 ${a}`),n(a))}catch(r){console.warn("Erreur parsing localStorage change:",r)}};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}}),[e]),(0,r.useEffect)((()=>{(async()=>{m(!0);try{const n=await p(e);a(n),m(!1)}catch(n){console.error("Erreur chargement traductions:",n),m(!1)}})()}),[e]),(0,r.useEffect)((()=>{const e=e=>{n(e.detail.language)};return window.addEventListener("languageChanged",e),()=>{window.removeEventListener("languageChanged",e)}}),[]);return{t:e=>{const n=Object.keys(t).length>0?t:d;return s&&g||!n[e]?e:n[e]},changeLanguage:async e=>{Object.keys(u).forEach((e=>{delete u[e]})),d={},g=!0,c.delete(e),n(e);try{const n={state:{currentLanguage:e}};localStorage.setItem("intelia-language",JSON.stringify(n)),console.log("[i18n] Langue sauvegard\xe9e:",e)}catch(t){console.warn("[i18n] Erreur sauvegarde langue:",t)}await p(e),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}}))},getCurrentLanguage:()=>e,formatDate:n=>{const t=(0,o.Ik)(e),r=t?.dateFormat||"en-US";return n.toLocaleDateString(r,{day:"numeric",month:"long",year:"numeric"})},currentLanguage:e,loading:s}}},799:(e,n,t)=>{"use strict";t.d(n,{useAuthStore:()=>f});var r=t(7294),a=t(3028),o=t(5174),i=t(2960);const s=(...e)=>{console.debug("[SupabaseAuthStore/Singleton]",...e)};s("Store Auth Supabase NATIF charg\xe9 (singleton + React #300 fix)");let l=!0,u=!1;const c=()=>{console.log("[DEBUG-LOGOUT] Fin logout - r\xe9activation setState"),u=!1};let d=null;const g=(e,n=!1,t="unknown")=>{if(l)if(!u||t.includes("logout"))try{d&&(d(e,n),console.log("[DEBUG-IMMEDIATE] setState appliqu\xe9 imm\xe9diatement:",t))}catch(r){console.error("[DEBUG-IMMEDIATE] Erreur setState imm\xe9diat:",t,r)}else console.log("[DEBUG-IMMEDIATE] safeSet bloqu\xe9 - logout en cours:",t);else console.log("[DEBUG-IMMEDIATE] safeSet bloqu\xe9 - store inactif:",t)};let m=null;const h=async()=>{if(!m)try{const{rememberMeUtils:e}=await t.e(239).then(t.bind(t,4239));m=e,console.log("[RememberMe] Utilitaires charg\xe9s dans auth store")}catch(e){console.warn("[RememberMe] Impossible de charger les utilitaires:",e),m={preserveOnLogout:()=>null,restoreAfterLogout:()=>{},clear:()=>{}}}return m};function p(e,n){const t=n?.full_name||e.user_metadata?.full_name||e.email?.split("@")[0]||"Utilisateur",r=String(t).trim()||"Utilisateur",a=r.trim().split(" "),o=a[0]||"",i=a.slice(1).join(" ")||"";return{id:e.id,email:e.email||"",name:r,firstName:o,lastName:i,phone:n?.phone||"",country:n?.country||"",linkedinProfile:n?.linkedinProfile||"",companyName:n?.companyName||"",companyWebsite:n?.companyWebsite||"",linkedinCorporate:n?.linkedinCorporate||"",user_type:n?.user_type||"producer",language:n?.language||"fr",created_at:n?.created_at||(new Date).toISOString(),plan:n?.plan||"essential",country_code:n?.country_code,area_code:n?.area_code,phone_number:n?.phone_number,full_name:r,avatar_url:n?.avatar_url,consent_given:n?.consent_given??!0,consent_date:n?.consent_date,updated_at:n?.updated_at,user_id:e.id,profile_id:n?.profile_id,preferences:n?.preferences,is_admin:n?.is_admin||!1}}const f=(0,r.Ue)()((0,a.tJ)(((e,n)=>(d=e,{user:null,isLoading:!1,isAuthenticated:!1,hasHydrated:!1,lastAuthCheck:0,authErrors:[],setHasHydrated:e=>{g({hasHydrated:e},!1,"setHasHydrated")},handleAuthError:(e,n)=>{const t=(e?.message||"Authentication error").toString();console.error("[SupabaseAuth/Singleton]",n||"",e),g((e=>({authErrors:[...e.authErrors,t]})),!1,"handleAuthError")},clearAuthErrors:()=>{g({authErrors:[]},!1,"clearAuthErrors")},initializeSession:async()=>{if(u)return console.log("[DEBUG-LOGOUT] initializeSession ignor\xe9 - logout en cours"),!1;try{s("initializeSession via Supabase natif (singleton)");const n=(0,i.getSupabaseClient)(),{data:{session:t},error:r}=await n.auth.getSession();if(r)return s("Erreur session Supabase (singleton):",r),g({user:null,isAuthenticated:!1,lastAuthCheck:Date.now()},!1,"initializeSession-error"),!1;if(!t||!t.user)return s("Pas de session Supabase (singleton)"),g({user:null,isAuthenticated:!1,lastAuthCheck:Date.now()},!1,"initializeSession-no-session"),!1;s("Session Supabase trouv\xe9e (singleton):",t.user.email);let a={};try{const{data:e}=await n.from("users").select("*").eq("auth_user_id",t.user.id).single();if(e)a=e,s("Profil utilisateur trouv\xe9 (singleton):",e.user_type);else{s("Pas de profil utilisateur, cr\xe9ation automatique (singleton)...");const{error:e}=await n.from("users").insert({auth_user_id:t.user.id,email:t.user.email,full_name:t.user.user_metadata?.full_name||t.user.email?.split("@")[0],user_type:"producer",language:"fr"});e||(a={user_type:"producer",language:"fr"},s("Profil cr\xe9\xe9 automatiquement (singleton)"))}}catch(e){s("Erreur profil, utilisation valeurs par d\xe9faut (singleton):",e),a={user_type:"producer",language:"fr"}}if(u)return console.log("[DEBUG-LOGOUT] initializeSession interrompu - logout en cours"),!1;const o=p(t.user,a);return g({user:o,isAuthenticated:!0,lastAuthCheck:Date.now()},!1,"initializeSession-success"),s("initializeSession r\xe9ussi (singleton):",o.email),!0}catch(t){return u||(n().handleAuthError(t,"initializeSession"),g({isAuthenticated:!1,user:null},!1,"initializeSession-catch")),!1}},checkAuth:async()=>{if(l)try{const n=(0,i.getSupabaseClient)(),{data:{session:t}}=await n.auth.getSession();if(!t||!t.user)return void g({user:null,isAuthenticated:!1,lastAuthCheck:Date.now()},!1,"checkAuth-no-session");let r={};try{const{data:e}=await n.from("users").select("*").eq("auth_user_id",t.user.id).single();e&&(r=e)}catch(e){s("Erreur r\xe9cup\xe9ration profil lors du checkAuth (singleton)")}if(!l)return void console.log("[DEBUG-TIMEOUT-STORE] checkAuth interrompu - store d\xe9mont\xe9");const a=p(t.user,r);g({user:a,isAuthenticated:!0,lastAuthCheck:Date.now()},!1,"checkAuth-success"),s("checkAuth r\xe9ussi (singleton)")}catch(t){l&&(n().handleAuthError(t,"checkAuth"),g({isAuthenticated:!1,user:null},!1,"checkAuth-error"))}else console.log("[DEBUG-TIMEOUT-STORE] checkAuth ignor\xe9 - store d\xe9mont\xe9")},login:async(e,t)=>{if(l){g({isLoading:!0,authErrors:[]},!1,"login-start"),s("login via Supabase natif (singleton):",e);try{const n=(0,i.getSupabaseClient)(),{data:r,error:a}=await n.auth.signInWithPassword({email:e,password:t});if(a)throw new Error(a.message);if(!r.user)throw new Error("Aucun utilisateur retourn\xe9");s("Login Supabase r\xe9ussi (singleton):",r.user.email),g({isLoading:!1},!1,"login-success"),sessionStorage.removeItem("recent-logout"),console.log("[Login] Flag recent-logout nettoy\xe9"),setTimeout((()=>{console.log("[Login] D\xe9clenchement \xe9v\xe9nement auth-state-changed"),window.dispatchEvent(new Event("auth-state-changed"))}),100)}catch(r){if(l){n().handleAuthError(r,"login"),s("Erreur login (singleton):",r?.message);let e=r?.message||"Erreur de connexion";throw e.includes("Invalid login credentials")?e="Email ou mot de passe incorrect":e.includes("Email not confirmed")&&(e="Veuillez confirmer votre email avant de vous connecter"),new Error(e)}}finally{g({isLoading:!1},!1,"login-finally")}}else console.log("[DEBUG-TIMEOUT-STORE] login ignor\xe9 - store d\xe9mont\xe9")},register:async(e,t,r)=>{if(l){g({isLoading:!0,authErrors:[]},!1,"register-start"),s("register via Supabase natif (singleton):",e);try{const u=String(r?.name||"").trim();if(!u||u.length<2)throw new Error("Le nom doit contenir au moins 2 caract\xe8res");const c=(0,i.getSupabaseClient)(),{data:d,error:m}=await c.auth.signUp({email:e,password:t,options:{data:{full_name:u,user_type:r.user_type||"producer",language:r.language||"fr"}}});if(m)throw new Error(m.message);if(!d.user)throw new Error("Erreur lors de la cr\xe9ation du compte");if(s("Inscription Supabase r\xe9ussie (singleton):",d.user.email),d.user.id)try{const{error:n}=await c.from("users").insert({auth_user_id:d.user.id,email:e,full_name:u,user_type:r.user_type||"producer",language:r.language||"fr"});n?s("Erreur cr\xe9ation profil (singleton):",n):s("Profil utilisateur cr\xe9\xe9 (singleton)")}catch(a){s("Erreur cr\xe9ation profil (singleton):",a)}g({isLoading:!1},!1,"register-profile-done"),d.session?l&&await n().initializeSession():o.ZP.success("Compte cr\xe9\xe9 ! V\xe9rifiez votre email pour confirmer votre inscription.")}catch(u){if(l){n().handleAuthError(u,"register"),s("Erreur register (singleton):",u?.message);let e=u?.message||"Erreur lors de la cr\xe9ation du compte";throw e.includes("already registered")?e="Cette adresse email est d\xe9j\xe0 utilis\xe9e":e.includes("Password should be at least")&&(e="Le mot de passe doit contenir au moins 6 caract\xe8res"),new Error(e)}}finally{g({isLoading:!1},!1,"register-finally")}}else console.log("[DEBUG-TIMEOUT-STORE] register ignor\xe9 - store d\xe9mont\xe9")},logout:async()=>{if(console.log("[DEBUG-LOGOUT] D\xe9but d\xe9connexion sans protections bloquantes"),l)try{const n=await h(),t=n.preserveOnLogout();console.log("[DEBUG-LOGOUT] Donn\xe9es RememberMe pr\xe9serv\xe9es:",t);const r=(0,i.getSupabaseClient)(),{error:a}=await r.auth.signOut();if(a)throw new Error(a.message);console.log("[DEBUG-LOGOUT] Nettoyage localStorage s\xe9lectif");try{const e=[];for(let n=0;n<localStorage.length;n++){const t=localStorage.key(n);t&&"intelia-remember-me-persist"!==t&&(t.startsWith("supabase-")||t.startsWith("intelia-")&&"intelia-remember-me-persist"!==t||t.includes("auth")||t.includes("session")||"intelia-expert-auth"===t||"intelia-chat-storage"===t)&&e.push(t)}e.forEach((e=>{try{localStorage.removeItem(e),console.log(`[DEBUG-LOGOUT] Supprim\xe9: ${e}`)}catch(n){console.warn(`[DEBUG-LOGOUT] Impossible de supprimer ${e}:`,n)}})),console.log(`[DEBUG-LOGOUT] ${e.length} cl\xe9s supprim\xe9es, RememberMe pr\xe9serv\xe9`)}catch(e){console.warn("[DEBUG-LOGOUT] Erreur nettoyage localStorage:",e)}console.log("[DEBUG-LOGOUT] Nettoyage imm\xe9diat du store pour \xe9viter les boucles"),d&&(d({user:null,isAuthenticated:!1,isLoading:!1,authErrors:[],lastAuthCheck:Date.now()},!1),console.log("[DEBUG-LOGOUT] Store Zustand nettoy\xe9 imm\xe9diatement")),sessionStorage.setItem("recent-logout",Date.now().toString()),sessionStorage.removeItem("current-session"),c(),t&&setTimeout((()=>{try{n.restoreAfterLogout(t),console.log("[DEBUG-LOGOUT] RememberMe restaur\xe9 apr\xe8s nettoyage")}catch(a){console.warn("[DEBUG-LOGOUT] Erreur restauration RememberMe:",a)}}),100),s("Logout r\xe9ussi avec pr\xe9servation RememberMe (singleton)")}catch(n){throw console.error("[DEBUG-LOGOUT] Erreur durant logout:",n),d&&d({user:null,isAuthenticated:!1,isLoading:!1,authErrors:[],lastAuthCheck:Date.now()},!1),c(),new Error(n?.message||"Erreur lors de la d\xe9connexion")}else console.log("[DEBUG-TIMEOUT-STORE] logout ignor\xe9 - store d\xe9mont\xe9")},updateProfile:async e=>{if(l){g({isLoading:!0},!1,"updateProfile-start"),s("updateProfile via Supabase (singleton)");try{const t=n().user;if(!t)throw new Error("Utilisateur non connect\xe9");const r={};if(void 0!==e.firstName&&(r.first_name=String(e.firstName).trim()),void 0!==e.lastName&&(r.last_name=String(e.lastName).trim()),void 0!==e.firstName||void 0!==e.lastName){const n=`${e.firstName||t.firstName||""} ${e.lastName||t.lastName||""}`.trim();if(n.length<2)throw new Error("Le nom doit contenir au moins 2 caract\xe8res");r.full_name=n}if(void 0!==e.user_type){const n=String(e.user_type);if(!["producer","professional","super_admin"].includes(n))throw new Error("Type d'utilisateur invalide");r.user_type=n}if(void 0!==e.language){const n=String(e.language);if(!["fr","en","es"].includes(n))throw new Error("Langue non support\xe9e");r.language=n}void 0!==e.country_code&&(r.country_code=e.country_code),void 0!==e.area_code&&(r.area_code=e.area_code),void 0!==e.phone_number&&(r.phone_number=e.phone_number),void 0!==e.country&&(r.country=e.country),void 0!==e.linkedinProfile&&(r.linkedin_profile=e.linkedinProfile),void 0!==e.companyName&&(r.company_name=e.companyName),void 0!==e.companyWebsite&&(r.company_website=e.companyWebsite),void 0!==e.linkedinCorporate&&(r.linkedin_corporate=e.linkedinCorporate);const a=(0,i.getSupabaseClient)(),{error:o}=await a.from("users").update(r).eq("auth_user_id",t.id);if(o)throw new Error(o.message);if(l){const r=n();if(Object.keys(e).some((n=>{const t=r.user?.[n];return t!==e[n]}))){console.log("[updateProfile] Changements d\xe9tect\xe9s - mise \xe0 jour du store");const n={...t,...e,email:t.email};g({user:n},!1,"updateProfile-success")}else console.log("[updateProfile] Pas de changements d\xe9tect\xe9s - setState l\xe9ger"),g({},!1,"updateProfile-no-changes")}s("updateProfile r\xe9ussi (singleton)")}catch(t){if(l)throw n().handleAuthError(t,"updateProfile"),new Error(t?.message||"Erreur de mise \xe0 jour du profil")}finally{g({isLoading:!1},!1,"updateProfile-finally")}}else console.log("[DEBUG-TIMEOUT-STORE] updateProfile ignor\xe9 - store d\xe9mont\xe9")},updateConsent:async e=>{if(l){s("updateConsent via Supabase (singleton)");try{const t=n().user;if(!t)return;const r=(0,i.getSupabaseClient)(),{error:a}=await r.from("users").update({rgpd_consent:e}).eq("auth_user_id",t.id);if(a)throw new Error(a.message)}catch(t){throw s("updateConsent error (singleton):",t?.message),new Error(t?.message||"Erreur de mise \xe0 jour du consentement")}}else console.log("[DEBUG-TIMEOUT-STORE] updateConsent ignor\xe9 - store d\xe9mont\xe9")},deleteUserData:async()=>{if(!l)return void console.log("[DEBUG-TIMEOUT-STORE] deleteUserData ignor\xe9 - store d\xe9mont\xe9");const e=n().user;if(!e)throw new Error("Non authentifi\xe9");try{const r=(0,i.getSupabaseClient)(),{error:a}=await r.from("users").delete().eq("auth_user_id",e.id);a&&s("Erreur suppression profil (singleton):",a);try{(await h()).clear(),console.log("[DEBUG-LOGOUT] RememberMe nettoy\xe9 lors de la suppression du compte")}catch(t){console.warn("[DEBUG-LOGOUT] Erreur nettoyage RememberMe:",t)}l&&await n().logout()}catch(r){throw new Error(r?.message||"Erreur de suppression des donn\xe9es")}},exportUserData:async()=>{const e=n().user;if(!e)throw new Error("Non authentifi\xe9");try{const n=(0,i.getSupabaseClient)(),{data:t}=await n.from("users").select("*").eq("auth_user_id",e.id).single();return{user_profile:t,export_date:(new Date).toISOString(),message:"Donn\xe9es utilisateur export\xe9es"}}catch(t){throw new Error(t?.message||"Erreur d'exportation des donn\xe9es")}},getAuthToken:async()=>{if(!l)return console.log("[DEBUG-TIMEOUT-STORE] getAuthToken ignor\xe9 - store d\xe9mont\xe9"),null;try{const e=(0,i.getSupabaseClient)(),{data:{session:n}}=await e.auth.getSession();return n?.access_token?(s("Token Supabase r\xe9cup\xe9r\xe9 pour API Expert"),n.access_token):(s("Pas de token Supabase disponible"),null)}catch(e){return s("Erreur r\xe9cup\xe9ration token:",e),null}}})),{name:"supabase-auth-store",storage:(0,a.FL)((()=>localStorage)),partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated,lastAuthCheck:e.lastAuthCheck,hasHydrated:e.hasHydrated}),onRehydrateStorage:()=>(e,n)=>{n&&console.error("Erreur rehydrate auth store:",n);const t=sessionStorage.getItem("recent-logout");if(t){const n=parseInt(t);if(Date.now()-n<1e3)return console.log("[AuthStore] Rehydration bloqu\xe9e - d\xe9connexion r\xe9cente"),void(e&&(e.user=null,e.isAuthenticated=!1))}e&&l&&(e.setHasHydrated(!0),s("Auth store rehydrat\xe9 (singleton)"))}}))},2960:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>c,getSupabaseClient:()=>s,resetSupabaseClient:()=>l,supabase:()=>u});var r=t(2885);const a=process.env.NEXT_PUBLIC_SUPABASE_URL,o=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!a||!o)throw new Error("\u274c Variables Supabase manquantes: NEXT_PUBLIC_SUPABASE_URL et NEXT_PUBLIC_SUPABASE_ANON_KEY requises");let i=null;const s=()=>(i?console.log("\u267b\ufe0f [Supabase] R\xe9utilisation instance singleton existante"):(console.log("\ud83d\ude80 [Supabase] Cr\xe9ation instance singleton"),i=(0,r.createClient)(a,o,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce",storage:void 0,storageKey:"intelia-expert-auth"},global:{headers:{"X-Client-Info":"intelia-expert-app"}},realtime:{params:{eventsPerSecond:10}}}),console.log("\u2705 [Supabase] Instance singleton cr\xe9\xe9e avec succ\xe8s")),i),l=()=>{console.log("\ud83d\uddd1\ufe0f [Supabase] Reset instance singleton"),i=null},u=s(),c=u},6465:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>m,metadata:()=>d,viewport:()=>c});var r=t(9510),a=t(7366),o=t.n(a),i=(t(7272),t(8570));const s=(0,i.createProxy)(String.raw`C:\intelia_gpt\intelia-expert\frontend\components\providers\AuthProvider.tsx#AuthProvider`),l=(0,i.createProxy)(String.raw`C:\intelia_gpt\intelia-expert\frontend\components\providers\LanguageProvider.tsx#LanguageProvider`);var u=t(4704);const c={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,viewportFit:"cover"},d={title:"Intelia Expert - AI Advisor",description:"Assistant IA sp\xe9cialis\xe9 pour les producteurs avicoles",keywords:"agriculture, IA, sant\xe9 animale, nutrition, \xe9levage, expert",authors:[{name:"Intelia"}],creator:"Intelia",publisher:"Intelia",formatDetection:{email:!1,address:!1,telephone:!1},metadataBase:new URL(process.env.NEXT_PUBLIC_APP_URL||"https://intelia-expert.com"),openGraph:{title:"Intelia Expert - Assistant IA Agriculture",description:"Assistant IA sp\xe9cialis\xe9 en sant\xe9 et nutrition animale",url:"https://intelia-expert.com",siteName:"Intelia Expert",locale:"fr_CA",type:"website"},manifest:"/manifest.json",icons:{icon:"/images/favicon.png",shortcut:"/images/favicon.png",apple:"/images/favicon.png",other:[{rel:"icon",type:"image/png",sizes:"32x32",url:"/images/favicon.png"},{rel:"icon",type:"image/png",sizes:"16x16",url:"/images/favicon.png"}]}},g="\n  (function() {\n    console.log('[AntiFlash] Initialisation...');\n    \n    // Fonction pour obtenir la langue pr\xe9f\xe9r\xe9e (m\xeame logique que LanguageProvider)\n    function getPreferredLanguage() {\n      try {\n        // 1. Priorit\xe9: localStorage Zustand\n        const zustandData = localStorage.getItem('intelia-language');\n        if (zustandData) {\n          const parsed = JSON.parse(zustandData);\n          const storedLang = parsed?.state?.currentLanguage;\n          \n          if (storedLang && ['en', 'fr', 'es', 'de', 'pt', 'nl', 'pl', 'zh', 'hi', 'th'].includes(storedLang)) {\n            console.log('[AntiFlash] Langue trouv\xe9e dans Zustand:', storedLang);\n            return storedLang;\n          }\n        }\n        \n        // 2. Fallback: langue du navigateur\n        const browserLang = navigator.language.split('-')[0];\n        if (['en', 'fr', 'es', 'de', 'pt', 'nl', 'pl', 'zh', 'hi', 'th'].includes(browserLang)) {\n          console.log('[AntiFlash] Langue depuis navigateur:', browserLang);\n          return browserLang;\n        }\n        \n        console.log('[AntiFlash] Langue par d\xe9faut: fr');\n        return 'fr';\n      } catch (e) {\n        console.warn('[AntiFlash] Erreur d\xe9tection langue:', e);\n        return 'fr';\n      }\n    }\n\n    // Initialisation imm\xe9diate\n    const preferredLang = getPreferredLanguage();\n    \n    // Marquer la langue d\xe9tect\xe9e\n    document.documentElement.setAttribute('lang', preferredLang);\n    document.documentElement.setAttribute('data-lang', preferredLang);\n    \n    // Timeout de s\xe9curit\xe9 absolu (3 secondes max)\n    const SAFETY_TIMEOUT = 3000;\n    const safetyTimer = setTimeout(function() {\n      if (!document.documentElement.classList.contains('language-ready')) {\n        console.warn('[AntiFlash] \u26a0\ufe0f Timeout s\xe9curit\xe9 - Affichage forc\xe9');\n        document.documentElement.classList.add('language-ready');\n      }\n    }, SAFETY_TIMEOUT);\n\n    // \xc9couter l'\xe9v\xe9nement de fin d'initialisation\n    window.addEventListener('languageReady', function() {\n      clearTimeout(safetyTimer);\n      document.documentElement.classList.add('language-ready');\n      console.log('[AntiFlash] \u2705 Interface pr\xeate');\n    });\n\n    // Fallback DOM ready\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', function() {\n        setTimeout(function() {\n          if (!document.documentElement.classList.contains('language-ready')) {\n            console.warn('[AntiFlash] \u26a0\ufe0f Timeout DOM - Affichage forc\xe9');\n            document.documentElement.classList.add('language-ready');\n          }\n        }, 500);\n      });\n    } else {\n      // Document d\xe9j\xe0 pr\xeat\n      setTimeout(function() {\n        if (!document.documentElement.classList.contains('language-ready')) {\n          console.warn('[AntiFlash] \u26a0\ufe0f Document ready - Affichage forc\xe9');\n          document.documentElement.classList.add('language-ready');\n        }\n      }, 100);\n    }\n  })();\n";function m({children:e}){return(0,r.jsxs)("html",{lang:"fr",className:"h-full",children:[(0,r.jsxs)("head",{children:[r.jsx("script",{dangerouslySetInnerHTML:{__html:g}}),r.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"}),r.jsx("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),r.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),r.jsx("meta",{name:"format-detection",content:"telephone=no"}),r.jsx("meta",{name:"mobile-web-app-capable",content:"yes"}),r.jsx("link",{rel:"icon",href:"/images/favicon.png",type:"image/png"}),r.jsx("link",{rel:"apple-touch-icon",href:"/images/favicon.png"}),r.jsx("meta",{name:"theme-color",content:"#2563eb"}),r.jsx("style",{dangerouslySetInnerHTML:{__html:'\n            /* === SOLUTION ANTI-FLASH === */\n            /* IMPORTANT: Doit \xeatre en premier */\n            html {\n              opacity: 0;\n              visibility: hidden;\n              transition: opacity 0.2s ease-in-out, visibility 0s linear 0.2s;\n            }\n            \n            html.language-ready {\n              opacity: 1;\n              visibility: visible;\n              transition: opacity 0.2s ease-in-out;\n            }\n            \n            /* Loader \xe9l\xe9gant pendant l\'initialisation */\n            html:not(.language-ready) body::before {\n              content: \'\';\n              position: fixed;\n              top: 0;\n              left: 0;\n              width: 100%;\n              height: 100%;\n              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n              z-index: 999999;\n              display: block;\n            }\n            \n            html:not(.language-ready) body::after {\n              content: \'Intelia Expert\';\n              position: fixed;\n              top: 50%;\n              left: 50%;\n              transform: translate(-50%, -50%);\n              color: white;\n              font-size: 24px;\n              font-weight: 600;\n              z-index: 1000000;\n              opacity: 0.9;\n              animation: pulse 1.5s ease-in-out infinite;\n              pointer-events: none;\n            }\n            \n            @keyframes pulse {\n              0%, 100% { opacity: 0.5; }\n              50% { opacity: 1; }\n            }\n            \n            /* Responsive loader */\n            @media (max-width: 768px) {\n              html:not(.language-ready) body::after {\n                font-size: 20px;\n              }\n            }\n            \n            /* === STYLES MOBILES EXISTANTS === */\n            \n            /* Corrections critiques iOS */\n            @supports (-webkit-touch-callout: none) {\n              .ios-input-fix {\n                font-size: 16px !important;\n                transform: translateZ(0);\n                -webkit-appearance: none;\n                border-radius: 0;\n              }\n            }\n            \n            /* Container mobile s\xe9curis\xe9 */\n            .mobile-safe-container {\n              width: 100%;\n              max-width: 100vw;\n              overflow-x: hidden;\n              box-sizing: border-box;\n              position: relative;\n            }\n            \n            /* Input container mobile */\n            .mobile-input-container {\n              display: flex;\n              align-items: center;\n              gap: 12px;\n              width: 100%;\n              max-width: 100%;\n              box-sizing: border-box;\n              padding: 0 16px;\n              min-height: 60px;\n            }\n            \n            .mobile-input-wrapper {\n              flex: 1;\n              min-width: 0;\n              max-width: calc(100% - 60px);\n            }\n            \n            .mobile-send-button {\n              flex-shrink: 0;\n              width: 48px;\n              height: 48px;\n              min-width: 48px;\n            }\n            \n            /* Viewport dynamique pour clavier */\n            .dynamic-viewport {\n              height: 100vh;\n              height: 100dvh;\n              min-height: 100vh;\n              min-height: 100dvh;\n            }\n            \n            /* Correction sp\xe9cifique iPhone */\n            @media screen and (max-width: 768px) {\n              body {\n                position: fixed;\n                width: 100%;\n                height: 100%;\n                overflow: hidden;\n              }\n              \n              .chat-main-container {\n                position: relative;\n                width: 100vw;\n                height: 100vh;\n                height: 100dvh;\n                overflow: hidden;\n                display: flex;\n                flex-direction: column;\n              }\n              \n              .chat-scroll-area {\n                flex: 1;\n                overflow-y: auto;\n                overflow-x: hidden;\n                -webkit-overflow-scrolling: touch;\n                overscroll-behavior: contain;\n              }\n              \n              .chat-input-fixed {\n                position: sticky;\n                bottom: 0;\n                left: 0;\n                right: 0;\n                z-index: 1000;\n                background: white;\n                border-top: 1px solid #e5e7eb;\n                padding-bottom: env(safe-area-inset-bottom);\n              }\n            }\n            \n            /* Pr\xe9vention zoom iOS sur focus input */\n            @media screen and (max-width: 768px) {\n              input[type="text"],\n              input[type="email"],\n              input[type="password"],\n              textarea {\n                font-size: 16px !important;\n                -webkit-appearance: none;\n                border-radius: 0;\n              }\n            }\n            \n            /* Fallback si JavaScript d\xe9sactiv\xe9 */\n            noscript {\n              position: fixed;\n              top: 0;\n              left: 0;\n              width: 100%;\n              height: 100%;\n              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n              color: white;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              z-index: 9999999;\n              font-size: 18px;\n              text-align: center;\n              flex-direction: column;\n              gap: 1rem;\n              padding: 2rem;\n            }\n            \n            /* Animation r\xe9duite si pr\xe9f\xe9rence utilisateur */\n            @media (prefers-reduced-motion: reduce) {\n              html, html.language-ready {\n                transition: none !important;\n              }\n              html:not(.language-ready) body::after {\n                animation: none !important;\n              }\n            }\n          '}}),r.jsx("noscript",{children:(0,r.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999999,fontSize:"18px",textAlign:"center",flexDirection:"column",gap:"1rem",padding:"2rem"},children:[r.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:"Intelia Expert"}),r.jsx("div",{children:"JavaScript est requis pour utiliser cette application"})]})})]}),r.jsx("body",{className:`${o().className} h-full antialiased mobile-safe-container`,children:r.jsx(s,{children:(0,r.jsxs)(l,{children:[e,r.jsx(u.x7,{position:"top-center",toastOptions:{style:{zIndex:9999}}})]})})})]})}},7272:()=>{}};