(()=>{var e={id:30,ids:[30]};e.modules={2885:e=>{"use strict";e.exports=require("@supabase/supabase-js")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6519:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>d});t(829),t(6465),t(5866);var a=t(3191),r=t(8716),i=t(7922),n=t.n(i),l=t(5231),c={};for(const h in l)["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(h)<0&&(c[h]=()=>l[h]);t.d(s,c);const d=["",{children:["admin",{children:["statistics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,829)),"C:\\intelia_gpt\\intelia-expert\\frontend\\app\\admin\\statistics\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,6465)),"C:\\intelia_gpt\\intelia-expert\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\intelia_gpt\\intelia-expert\\frontend\\app\\admin\\statistics\\page.tsx"],x="/admin/statistics/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/statistics/page",pathname:"/admin/statistics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1232:(e,s,t)=>{Promise.resolve().then(t.bind(t,4837))},4837:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var a=t(326),r=t(7577),i=t(799);const n=({systemStats:e,usageStats:s,billingStats:t,performanceStats:r,cacheStatus:i=null,isLoading:n=!1})=>n?a.jsx("div",{className:"flex items-center justify-center py-16",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Chargement du tableau de bord..."})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white border border-gray-200 p-4 relative",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Utilisateurs Actifs"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s?.unique_users||0}),i?.is_available&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full",title:"Donn\xe9es en cache"})})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-4 relative",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Questions ce mois"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s?.questions_this_month||0}),i?.is_available&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-4 relative",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Revenus Totaux"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:["$",t?.total_revenue||0]}),i?.is_available&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Sources des R\xe9ponses"})}),a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"space-y-3",children:s?.source_distribution&&Object.entries(s.source_distribution).map((([e,t])=>{const r=Object.values(s.source_distribution).reduce(((e,s)=>e+s),0),i=r>0?(t/r*100).toFixed(1):0,n=e=>{switch(e){case"rag_retriever":return"bg-blue-500";case"openai_fallback":return"bg-purple-500";case"perfstore":return"bg-green-500";default:return"bg-gray-400"}};return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`w-3 h-3 ${n(e)}`}),a.jsx("span",{className:"text-sm text-gray-700",children:(e=>{switch(e){case"rag_retriever":return"RAG Retriever";case"openai_fallback":return"OpenAI Fallback";case"perfstore":return"Performance Store";default:return e}})(e)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-16 bg-gray-200 h-2",children:a.jsx("div",{className:`h-2 ${n(e)} transition-all duration-300`,style:{width:`${i}%`}})}),a.jsx("span",{className:"text-sm font-medium text-gray-900 w-12 text-right",children:t})]})]},e)}))})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Sant\xe9 du Syst\xe8me"})}),a.jsx("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Uptime"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[e?.system_health?.uptime_hours?.toFixed(1)||"0.0","h"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Taux d'erreur"}),(0,a.jsxs)("span",{className:"text-sm font-medium "+((e?.system_health?.error_rate||0)<5?"text-green-600":"text-red-600"),children:[e?.system_health?.error_rate?.toFixed(1)||"0.0","%"]})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-gray-200",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Services RAG"}),a.jsx("div",{className:"space-y-2",children:e?.system_health?.rag_status&&Object.entries(e.system_health.rag_status).map((([e,s])=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs text-gray-600 capitalize",children:e}),a.jsx("span",{className:"text-xs px-2 py-1 "+(s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s?"Actif":"Inactif"})]},e)))})]})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Utilisateurs les Plus Actifs"})}),a.jsx("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Utilisateur"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Questions"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Plan"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[t?.top_users?.slice(0,5).map(((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 max-w-48",children:a.jsx("div",{className:"truncate",title:e.email||"Email non disponible",children:e.email||"Utilisateur anonyme"})}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:e.question_count||0}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium "+("enterprise"===e.plan?"bg-purple-100 text-purple-800":"professional"===e.plan?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.plan||"non d\xe9fini"})})]},e.email||`user-${s}`)))||[],(!t?.top_users||0===t.top_users.length)&&a.jsx("tr",{children:(0,a.jsxs)("td",{colSpan:3,className:"px-4 py-8 text-center text-gray-500",children:[a.jsx("div",{className:"text-gray-400 text-2xl mb-2",children:"\ud83d\udc65"}),a.jsx("p",{children:"Aucune donn\xe9e utilisateur disponible"})]})})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"R\xe9partition des Plans"})}),a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"space-y-3",children:t?.plans&&Object.entries(t.plans).map((([e,s])=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 capitalize",children:e}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:[s.user_count," utilisateurs"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold text-gray-900",children:["$",s.revenue]}),a.jsx("p",{className:"text-xs text-gray-600",children:"revenus"})]})]},e)))})})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Co\xfbts et Performance"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-white border border-gray-200",children:[(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["$",r?.openai_costs?.toFixed(2)||"0.00"]}),a.jsx("p",{className:"text-xs text-gray-600",children:"Co\xfbts OpenAI"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white border border-gray-200",children:[a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r?.error_count||0}),a.jsx("p",{className:"text-xs text-gray-600",children:"Erreurs"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white border border-gray-200",children:[a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:e?.system_health?.total_requests||0}),a.jsx("p",{className:"text-xs text-gray-600",children:"Requ\xeates Totales"})]})]}),r&&(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"M\xe9triques de Performance D\xe9taill\xe9es"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-3",children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("span",{className:"text-sm font-medium text-gray-800",children:"Temps M\xe9dian"})}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-blue-900",children:[r.median_response_time?.toFixed(1)||"0.0","s"]}),a.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Temps de r\xe9ponse m\xe9dian"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-3",children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("span",{className:"text-sm font-medium text-green-800",children:"Min/Max"})}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-green-900",children:[r.min_response_time?.toFixed(1)||"0.0","s / ",r.max_response_time?.toFixed(1)||"0.0","s"]}),a.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Temps min et max"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-3",children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Cache Hit"})}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-purple-900",children:[r.cache_hit_rate?.toFixed(1)||"0.0","%"]}),a.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"Taux de succ\xe8s cache"})]})]}),r.avg_response_time&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[a.jsx("span",{children:"Performance globale du syst\xe8me"}),a.jsx("span",{children:r.avg_response_time<2?"Excellent":r.avg_response_time<5?"Bon":r.avg_response_time<10?"Acceptable":"\xc0 am\xe9liorer"})]}),a.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-2 rounded-full transition-all duration-500 "+(r.avg_response_time<2?"bg-green-500":r.avg_response_time<5?"bg-blue-500":r.avg_response_time<10?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,Math.max(10,100-5*r.avg_response_time))}%`}})}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[a.jsx("span",{children:"Rapide (<2s)"}),a.jsx("span",{children:"Lent (>10s)"})]})]})]})]})]})]}),l=({questionLogs:e,questionFilters:s,setQuestionFilters:t,selectedTimeRange:r,setSelectedTimeRange:i,currentPage:n,setCurrentPage:l,questionsPerPage:c,setSelectedQuestion:d,isLoading:o=!1,totalQuestions:x=0,cacheStatus:m=null})=>{const u=e=>{switch(e){case"rag":return"text-blue-600 bg-blue-100";case"openai_fallback":return"text-purple-600 bg-purple-100";case"table_lookup":return"text-green-600 bg-green-100";case"validation_rejected":return"text-red-600 bg-red-100";case"quota_exceeded":return"text-orange-600 bg-orange-100";default:return"text-gray-600 bg-gray-100"}},h=e=>{switch(e){case"rag":return"RAG";case"openai_fallback":return"OpenAI";case"table_lookup":return"Table";case"validation_rejected":return"Rejet\xe9";case"quota_exceeded":return"Quota";default:return"Inconnu"}},p=e=>1===e?"\ud83d\udc4d":-1===e?"\ud83d\udc4e":"\u2753",g=()=>{try{const s=window.confirm(`\ud83e\udd14 Choix de l'export :\n\n\u2022 OUI = Exporter TOUTES les ${x} questions de la base\n\u2022 NON = Exporter seulement les ${b.length} questions affich\xe9es\n\nVoulez-vous exporter TOUTES les questions ?`);let t,a;if(s){if(t=e,a="TOUTES",e.length<x){if(!window.confirm(`\u26a0\ufe0f Attention :\n\n\u2022 Total questions dans la base : ${x}\n\u2022 Questions actuellement charg\xe9es : ${e.length}\n\nL'export contiendra seulement les ${e.length} questions charg\xe9es.\n\nContinuer l'export ?`))return}}else t=b,a="FILTR\xc9ES";if(0===t.length)return void alert("\u274c Aucune question \xe0 exporter dans la s\xe9lection");const r=(e=>{const s=new Map;e.forEach((e=>{const t=e.session_id;s.has(t)||s.set(t,[]),s.get(t).push(e)}));const t=[];return s.forEach(((e,s)=>{e.sort(((e,s)=>new Date(e.timestamp).getTime()-new Date(s.timestamp).getTime()));const a=e[0],r=e[e.length-1];t.push({session_id:s,user_email:a.user_email,user_name:a.user_name,start_time:a.timestamp,end_time:r.timestamp,total_questions:e.length,questions:e.map((e=>e.question)),responses:e.map((e=>e.response)),sources:e.map((e=>h(e.response_source))),confidence_scores:e.map((e=>e.confidence_score)),response_times:e.map((e=>e.response_time)),feedback_scores:e.map((e=>e.feedback)),feedback_comments:e.map((e=>e.feedback_comment))})})),t})(t),i=Math.max(...r.map((e=>e.total_questions)));console.log(`\ud83d\udcca Export CSV ${a} de ${r.length} conversations, max ${i} questions`);const n=["N\xb0","Session ID","Utilisateur","Email","D\xe9but","Fin","Nb Questions","Dur\xe9e (min)"];for(let e=0;e<i;e++)n.push(`Q${e+1}`,`R${e+1}`,`Source${e+1}`,`Confiance${e+1}`,`Temps${e+1}`,`Feedback${e+1}`,`Commentaire${e+1}`);const l=e=>{if(null===e||void 0===e)return"";const s=String(e);return s.includes('"')||s.includes(",")||s.includes("\n")||s.includes("\r")?`"${s.replace(/"/g,'""')}"`:s};let c=n.map(l).join(",")+"\n";r.forEach(((e,s)=>{const t=[s+1,e.session_id.substring(0,12)+"...",e.user_name,e.user_email,new Date(e.start_time).toLocaleString("fr-FR"),new Date(e.end_time).toLocaleString("fr-FR"),e.total_questions,Math.max(1,Math.round((new Date(e.end_time).getTime()-new Date(e.start_time).getTime())/6e4))];for(let a=0;a<i;a++)t.push(e.questions[a]||"",e.responses[a]||"",e.sources[a]||"",e.confidence_scores[a]?`${(100*e.confidence_scores[a]).toFixed(1)}%`:"",e.response_times[a]?`${e.response_times[a]}s`:"",null!==e.feedback_scores[a]?1===e.feedback_scores[a]?"Positif":"N\xe9gatif":"",e.feedback_comments[a]||"");c+=t.map(l).join(",")+"\n"}));const d=`conversations_${s?"TOUTES":"FILTREES"}_${(new Date).toISOString().split("T")[0]}_${Date.now()}.csv`,o=new Blob(["\ufeff"+c],{type:"text/csv;charset=utf-8"}),m=window.URL.createObjectURL(o),u=document.createElement("a");u.href=m,u.download=d,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(m),console.log(`\u2705 Export CSV conversations ${a} r\xe9ussi: ${d}`);const p=new Set(t.map((e=>e.user_email))).size,g=`\u2705 Export CSV ${a} r\xe9ussi !\n\n\ud83d\udcca Scope: ${a} les questions\n\u2022 ${r.length} conversations (lignes)\n\u2022 ${t.length} questions au total\n\u2022 ${p} utilisateurs uniques\n\u2022 ${i} questions max par conversation\n\n\ud83d\udcc4 Fichier: ${d}\n\n\ud83d\udccb Format: Une ligne par conversation\n\u2022 Colonnes fixes: Session, Utilisateur, Dates...\n\u2022 Colonnes dynamiques: Q1, R1, Q2, R2, Q3, R3...\n\n\ud83d\udca1 Ouvrir avec Excel pour format tabulaire !`;alert(g)}catch(s){console.error("\u274c Erreur export CSV conversations:",s),alert(`\u274c Erreur export CSV: ${s}`)}},b=e.filter((e=>{if(s.search&&!e.question.toLowerCase().includes(s.search.toLowerCase())&&!e.response.toLowerCase().includes(s.search.toLowerCase())&&!e.user_email.toLowerCase().includes(s.search.toLowerCase()))return!1;if("all"!==s.source&&e.response_source!==s.source)return!1;if("all"!==s.confidence){const t=e.confidence_score;if("high"===s.confidence&&t<.9)return!1;if("medium"===s.confidence&&(t<.7||t>=.9))return!1;if("low"===s.confidence&&t>=.7)return!1}if("all"!==s.feedback){if("positive"===s.feedback&&1!==e.feedback)return!1;if("negative"===s.feedback&&-1!==e.feedback)return!1;if("none"===s.feedback&&null!==e.feedback)return!1;if("with_comments"===s.feedback&&!e.feedback_comment)return!1;if("no_comments"===s.feedback&&e.feedback_comment)return!1}return"all"===s.user||e.user_email===s.user})),j=Array.from(new Set(e.map((e=>e.user_email)))),f={total:e.filter((e=>null!==e.feedback)).length,positive:e.filter((e=>1===e.feedback)).length,negative:e.filter((e=>-1===e.feedback)).length,withComments:e.filter((e=>e.feedback_comment)).length,satisfactionRate:e.filter((e=>null!==e.feedback)).length>0?e.filter((e=>1===e.feedback)).length/e.filter((e=>null!==e.feedback)).length*100:0},v=e.reduce(((e,s)=>(e[s.response_source]=(e[s.response_source]||0)+1,e)),{});return o&&0===e.length?a.jsx("div",{className:"flex items-center justify-center py-16",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Chargement des questions..."})]})}):(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-8 px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),a.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Questions & R\xe9ponses"})]}),o&&(0,a.jsxs)("div",{className:"flex items-center text-blue-600 ml-auto",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),a.jsx("span",{className:"text-sm",children:"Chargement..."})]})]})}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Filtres"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Recherche"}),a.jsx("input",{type:"text",value:s.search,onChange:e=>t((s=>({...s,search:e.target.value}))),placeholder:"Rechercher...",className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Source"}),(0,a.jsxs)("select",{value:s.source,onChange:e=>t((s=>({...s,source:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"Toutes les sources"}),a.jsx("option",{value:"rag",children:"RAG"}),a.jsx("option",{value:"openai_fallback",children:"OpenAI Fallback"}),a.jsx("option",{value:"table_lookup",children:"Table Lookup"}),a.jsx("option",{value:"validation_rejected",children:"Rejet\xe9"}),a.jsx("option",{value:"quota_exceeded",children:"Quota D\xe9pass\xe9"}),a.jsx("option",{value:"unknown",children:"Inconnu"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confiance"}),(0,a.jsxs)("select",{value:s.confidence,onChange:e=>t((s=>({...s,confidence:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"Tous niveaux"}),a.jsx("option",{value:"high",children:"\xc9lev\xe9e (\u226590%)"}),a.jsx("option",{value:"medium",children:"Moyenne (70-89%)"}),a.jsx("option",{value:"low",children:"Faible (<70%)"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Feedback"}),(0,a.jsxs)("select",{value:s.feedback,onChange:e=>t((s=>({...s,feedback:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"Tous feedback"}),a.jsx("option",{value:"positive",children:"Positif \ud83d\udc4d"}),a.jsx("option",{value:"negative",children:"N\xe9gatif \ud83d\udc4e"}),a.jsx("option",{value:"none",children:"Aucun feedback"}),a.jsx("option",{value:"with_comments",children:"Avec commentaires"}),a.jsx("option",{value:"no_comments",children:"Sans commentaires"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Utilisateur"}),(0,a.jsxs)("select",{value:s.user,onChange:e=>t((s=>({...s,user:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"Tous utilisateurs"}),j.map((e=>a.jsx("option",{value:e,children:e.length>25?e.substring(0,25)+"...":e},e)))]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"P\xe9riode"}),(0,a.jsxs)("select",{value:r,onChange:e=>i(e.target.value),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"day",children:"Aujourd'hui"}),a.jsx("option",{value:"week",children:"Cette semaine"}),a.jsx("option",{value:"month",children:"Ce mois"}),a.jsx("option",{value:"year",children:"Cette ann\xe9e"})]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:b.length})," question(s) trouv\xe9e(s) sur ",a.jsx("span",{className:"font-medium",children:e.length})," affich\xe9es",x>e.length&&(0,a.jsxs)("span",{className:"text-blue-600",children:[" (Total: ",x,")"]})]}),b.length!==e.length&&a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800",children:"Filtr\xe9"})]}),a.jsx("button",{onClick:()=>{t({search:"",source:"all",confidence:"all",feedback:"all",user:"all"}),l(1)},className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"R\xe9initialiser les filtres"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Analyse des Commentaires"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-green-50 border border-green-200",children:[a.jsx("div",{className:"text-xl font-semibold text-green-600",children:f.positive}),a.jsx("div",{className:"text-xs text-green-700",children:"Feedback Positifs"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-red-50 border border-red-200",children:[a.jsx("div",{className:"text-xl font-semibold text-red-600",children:f.negative}),a.jsx("div",{className:"text-xs text-red-700",children:"Feedback N\xe9gatifs"})]})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Total des feedback:"}),a.jsx("span",{className:"font-medium",children:f.total})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Avec commentaires:"}),a.jsx("span",{className:"font-medium",children:f.withComments})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Taux de satisfaction:"}),(0,a.jsxs)("span",{className:"font-medium "+(f.satisfactionRate>=80?"text-green-600":f.satisfactionRate>=60?"text-yellow-600":"text-red-600"),children:[f.satisfactionRate.toFixed(1),"%"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 h-2 mb-4",children:a.jsx("div",{className:"h-2 transition-all duration-300 "+(f.satisfactionRate>=80?"bg-green-500":f.satisfactionRate>=60?"bg-yellow-500":"bg-red-500"),style:{width:`${f.satisfactionRate}%`}})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Commentaires R\xe9cents"}),(0,a.jsxs)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[e.filter((e=>e.feedback_comment)).sort(((e,s)=>new Date(s.timestamp).getTime()-new Date(e.timestamp).getTime())).slice(0,3).map((e=>(0,a.jsxs)("div",{className:"border border-gray-200 p-2 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-xs text-gray-500",children:e.user_email}),a.jsx("span",{className:"text-sm",children:p(e.feedback)})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-700 italic line-clamp-2",children:['"',e.feedback_comment,'"']}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.timestamp).toLocaleDateString("fr-FR")})]},e.id))),0===e.filter((e=>e.feedback_comment)).length&&a.jsx("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"Aucun commentaire disponible"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Distribution des Sources"})}),(0,a.jsxs)("div",{className:"p-4",children:[a.jsx("div",{className:"space-y-3",children:Object.entries(v).sort((([,e],[,s])=>s-e)).map((([s,t])=>{const r=e.length>0?t/e.length*100:0;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium ${u(s)}`,children:h(s)})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-16 bg-gray-200 h-2",children:a.jsx("div",{className:"h-2 transition-all duration-300 "+("rag"===s?"bg-blue-500":"openai_fallback"===s?"bg-purple-500":"table_lookup"===s?"bg-green-500":"validation_rejected"===s?"bg-red-500":"quota_exceeded"===s?"bg-orange-500":"bg-gray-500"),style:{width:`${r}%`}})}),a.jsx("span",{className:"text-sm font-medium text-gray-900 w-12 text-right",children:t})]})]},s)}))}),(0,a.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"M\xe9triques de Qualit\xe9"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"text-center p-2 bg-blue-50 border border-blue-200",children:[(0,a.jsxs)("div",{className:"text-lg font-semibold text-blue-600",children:[e.length>0?(e.reduce(((e,s)=>e+s.confidence_score),0)/e.length*100).toFixed(1):"0.0","%"]}),a.jsx("div",{className:"text-xs text-blue-700",children:"Confiance Moyenne"})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-green-50 border border-green-200",children:[(0,a.jsxs)("div",{className:"text-lg font-semibold text-green-600",children:[e.length>0?(e.reduce(((e,s)=>e+s.response_time),0)/e.length).toFixed(1):"0.0","s"]}),a.jsx("div",{className:"text-xs text-green-700",children:"Temps Moyen"})]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Export des Donn\xe9es"})}),a.jsx("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-stretch",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Conversations"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Format ligne par conversation, compatible Excel"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsxs)("p",{children:["\u2022 Choix automatique: Filtr\xe9es (",b.length,") ou toutes (",x,")"]}),a.jsx("p",{children:"\u2022 Colonnes: Q1, R1, Source1, Q2, R2, Source2..."})]})]}),a.jsx("button",{onClick:()=>g(),disabled:0===e.length,className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Commentaires"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Feedback et commentaires utilisateurs"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[a.jsx("p",{children:"\u2022 Feedback positifs et n\xe9gatifs"}),a.jsx("p",{children:"\u2022 Commentaires avec contexte question"})]})]}),a.jsx("button",{onClick:()=>{const s="data:text/csv;charset=utf-8,Date,Utilisateur,Question,Feedback,Commentaire,Source,Confiance\n"+e.filter((e=>e.feedback_comment)).map((e=>({date:new Date(e.timestamp).toLocaleDateString("fr-FR"),user:e.user_email,question:e.question.substring(0,100)+"...",feedback:1===e.feedback?"Positif":"N\xe9gatif",comment:e.feedback_comment,source:h(e.response_source),confidence:(100*e.confidence_score).toFixed(1)+"%"}))).map((e=>Object.values(e).map((e=>`"${e}"`)).join(","))).join("\n"),t=encodeURI(s),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",`commentaires_feedback_${(new Date).toISOString().split("T")[0]}.csv`),document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Questions Filtr\xe9es"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Questions actuellement affich\xe9es"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsxs)("p",{children:["\u2022 ",b.length," questions s\xe9lectionn\xe9es"]}),a.jsx("p",{children:"\u2022 Donn\xe9es compl\xe8tes avec r\xe9ponses"})]})]}),a.jsx("button",{onClick:()=>{const e="data:text/csv;charset=utf-8,Date,Utilisateur,Question,R\xe9ponse,Source,Confiance,Temps,Feedback\n"+b.map((e=>({date:new Date(e.timestamp).toLocaleDateString("fr-FR"),user:e.user_email,question:e.question,response:e.response.substring(0,200)+"...",source:h(e.response_source),confidence:(100*e.confidence_score).toFixed(1)+"%",response_time:e.response_time+"s",feedback:1===e.feedback?"Positif":-1===e.feedback?"N\xe9gatif":"Aucun"}))).map((e=>Object.values(e).map((e=>`"${e}"`)).join(","))).join("\n"),s=encodeURI(e),t=document.createElement("a");t.setAttribute("href",s),t.setAttribute("download",`questions_export_${(new Date).toISOString().split("T")[0]}.csv`),document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Statistiques"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Donn\xe9es d'analyse et m\xe9triques"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[a.jsx("p",{children:"\u2022 M\xe9triques de satisfaction et performance"}),a.jsx("p",{children:"\u2022 Format JSON pour analyse avanc\xe9e"})]})]}),a.jsx("button",{onClick:()=>{const t={export_date:(new Date).toISOString(),total_questions:x,displayed_questions:e.length,filtered_questions:b.length,unique_users:j.length,feedback_stats:f,source_distribution:v,filters_applied:s},a="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t,null,2)),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download",`stats_export_${(new Date).toISOString().split("T")[0]}.json`),document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"Exporter JSON"})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Questions et R\xe9ponses"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[b.length," questions affich\xe9es"]})]}),0===b.length?(0,a.jsxs)("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:"\ud83d\udd0d"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune question trouv\xe9e"}),a.jsx("p",{className:"text-gray-500 mb-4",children:s.search||"all"!==s.source||"all"!==s.confidence||"all"!==s.feedback||"all"!==s.user?"Essayez de modifier vos filtres pour voir plus de r\xe9sultats.":"Il n'y a pas encore de questions dans cette p\xe9riode."}),(s.search||"all"!==s.source||"all"!==s.confidence||"all"!==s.feedback||"all"!==s.user)&&a.jsx("button",{onClick:()=>{t({search:"",source:"all",confidence:"all",feedback:"all",user:"all"})},className:"bg-blue-600 text-white px-4 py-2 hover:bg-blue-700 transition-colors",children:"R\xe9initialiser les filtres"})]}):a.jsx("div",{className:"divide-y divide-gray-200",children:b.map((e=>{return a.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:a.jsx("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-600 flex items-center justify-center text-white text-xs font-bold",children:e.user_name.split(" ").map((e=>e[0])).join("").toUpperCase()}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.user_name}),a.jsx("p",{className:"text-xs text-gray-500",children:e.user_email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium ${u(e.response_source)}`,children:h(e.response_source)}),(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium "+(s=e.confidence_score,s>=.9?"text-green-600 bg-green-100":s>=.7?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100"),children:[(100*e.confidence_score).toFixed(0),"%"]}),a.jsx("span",{className:"text-lg",children:p(e.feedback)}),e.feedback_comment&&a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800",children:"\ud83d\udcac"})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Question:"}),a.jsx("p",{className:"text-sm text-gray-700 bg-blue-50 p-3 border-l-4 border-blue-400",children:e.question})]}),(0,a.jsxs)("div",{className:"mb-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"R\xe9ponse:"}),a.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 p-3 max-h-32 overflow-y-auto border border-gray-200",children:e.response.split("\n").map(((e,s)=>a.jsx("p",{className:e.startsWith("**")?"font-semibold":"",children:e},s)))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("span",{children:new Date(e.timestamp).toLocaleString("fr-FR")}),(0,a.jsxs)("span",{children:[e.response_time,"s"]}),a.jsx("span",{children:e.language.toUpperCase()}),(0,a.jsxs)("span",{children:[e.session_id.substring(0,8),"..."]})]}),a.jsx("button",{onClick:()=>d(e),className:"text-blue-600 hover:text-blue-800 font-medium bg-blue-50 px-2 py-1 border border-blue-200",children:"Voir d\xe9tails \u2192"})]}),e.feedback_comment&&a.jsx("div",{className:"mt-3 p-3 bg-blue-50 border-l-4 border-blue-400",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[a.jsx("span",{className:"text-lg",children:p(e.feedback)}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Commentaire utilisateur:"}),(0,a.jsxs)("p",{className:"text-sm text-blue-800 italic",children:['"',e.feedback_comment,'"']}),(0,a.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:["Feedback ",1===e.feedback?"positif":"n\xe9gatif"," \u2022 ",new Date(e.timestamp).toLocaleDateString("fr-FR")]})]})]})})]})})},e.id);var s}))}),b.length>0&&(0,a.jsxs)("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>l(Math.max(1,n-1)),disabled:1===n,className:"px-3 py-1 border border-gray-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white transition-colors",children:"\u2190 Pr\xe9c\xe9dent"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 px-2 py-1 bg-white border border-gray-300",children:["Page ",n]}),a.jsx("button",{onClick:()=>l(n+1),disabled:b.length<c,className:"px-3 py-1 border border-gray-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white transition-colors",children:"Suivant \u2192"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[b.length," question(s) affich\xe9e(s)",x>e.length&&(0,a.jsxs)("span",{className:"text-blue-600",children:[" sur ",x," au total"]})]})]})]})]})},c=({invitationStats:e,cacheStatus:s=null,isLoading:t=!1})=>t?(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-8 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Chargement des statistiques d'invitations..."})]}):e?(0,a.jsxs)("div",{className:"space-y-4",children:[s&&!s.is_available&&a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-amber-800",children:[a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.jsx("span",{className:"text-sm font-medium",children:"Chargement en mode standard"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Invitations Envoy\xe9es"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.total_invitations_sent}),s&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:s.is_available?"Cache":"Direct"})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Invitations Accept\xe9es"}),a.jsx("p",{className:"text-2xl font-semibold text-green-600",children:e.total_invitations_accepted}),s&&s.is_available&&a.jsx("p",{className:"text-xs text-green-500 mt-1",children:"Donn\xe9es mises en cache"})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Utilisateurs Inviteurs"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.unique_inviters}),!s?.is_available&&a.jsx("p",{className:"text-xs text-amber-500 mt-1",children:"Mode direct"})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Taux d'Acceptation"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-blue-600",children:[e.acceptance_rate.toFixed(1),"%"]}),s?.is_available&&a.jsx("p",{className:"text-xs text-blue-500 mt-1",children:"Optimis\xe9"})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Analyse du Taux d'Acceptation"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[a.jsx("span",{children:"Taux global d'acceptation"}),(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[e.acceptance_rate.toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-4 rounded-full transition-all duration-500 "+(e.acceptance_rate>=75?"bg-green-500":e.acceptance_rate>=50?"bg-blue-500":e.acceptance_rate>=25?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,Math.max(5,e.acceptance_rate))}%`}})}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[a.jsx("span",{children:"0%"}),a.jsx("span",{children:"25%"}),a.jsx("span",{children:"50%"}),a.jsx("span",{children:"75%"}),a.jsx("span",{children:"100%"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[a.jsx("div",{className:"bg-blue-50 p-3 border border-blue-200 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold text-blue-600",children:e.total_invitations_sent}),a.jsx("p",{className:"text-xs text-blue-700",children:"Total Envoy\xe9es"})]})}),a.jsx("div",{className:"bg-green-50 p-3 border border-green-200 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold text-green-600",children:e.total_invitations_accepted}),a.jsx("p",{className:"text-xs text-green-700",children:"Total Accept\xe9es"})]})}),a.jsx("div",{className:"bg-gray-50 p-3 border border-gray-200 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold text-gray-600",children:e.total_invitations_sent-e.total_invitations_accepted}),a.jsx("p",{className:"text-xs text-gray-700",children:"En Attente"})]})})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Top 5 - Invitations Envoy\xe9es"}),s&&a.jsx("span",{className:"text-xs px-2 py-1 rounded "+(s.is_available?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:s.is_available?"Cache":"Direct"})]})}),a.jsx("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rang"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Inviteur"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Envoy\xe9es"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Accept\xe9es"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Taux"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[e.top_inviters.slice(0,5).map(((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm font-bold text-gray-900",children:a.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-600":"bg-blue-500"),children:s+1})}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 max-w-48",children:(0,a.jsxs)("div",{className:"truncate",title:e.inviter_email,children:[a.jsx("div",{className:"font-medium",children:e.inviter_name||"Nom non disponible"}),a.jsx("div",{className:"text-xs text-gray-500",children:e.inviter_email})]})}),a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-blue-900",children:e.invitations_sent}),a.jsx("td",{className:"px-4 py-2 text-sm text-green-600 font-medium",children:e.invitations_accepted}),a.jsx("td",{className:"px-4 py-2",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full "+(e.acceptance_rate>=70?"bg-green-100 text-green-800":e.acceptance_rate>=40?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[e.acceptance_rate.toFixed(0),"%"]})})]},e.inviter_email||`inviter-${s}`))),0===e.top_inviters.length&&a.jsx("tr",{children:(0,a.jsxs)("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:[a.jsx("div",{className:"text-gray-400 text-2xl mb-2",children:"\ud83d\udce8"}),a.jsx("p",{children:"Aucun inviteur trouv\xe9"}),s&&(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Mode ",s.is_available?"cache":"direct"," - Aucune donn\xe9e"]})]})})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Top 5 - Invitations Accept\xe9es"}),s&&s.is_available&&(0,a.jsxs)("span",{className:"text-xs text-green-600",children:[s.cache_age_minutes,"min"]})]})}),a.jsx("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rang"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Inviteur"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Accept\xe9es"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Efficacit\xe9"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[e.top_accepted.slice(0,5).map(((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm font-bold text-gray-900",children:a.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+(0===s?"bg-green-500":1===s?"bg-blue-500":2===s?"bg-purple-500":"bg-indigo-500"),children:s+1})}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 max-w-48",children:(0,a.jsxs)("div",{className:"truncate",title:e.inviter_email,children:[a.jsx("div",{className:"font-medium",children:e.inviter_name||"Nom non disponible"}),a.jsx("div",{className:"text-xs text-gray-500",children:e.inviter_email})]})}),a.jsx("td",{className:"px-4 py-2 text-sm font-bold text-green-600 text-lg",children:e.invitations_accepted}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:e.invitations_sent}),a.jsx("td",{className:"px-4 py-2",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full "+(e.acceptance_rate>=70?"bg-green-100 text-green-800":e.acceptance_rate>=40?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[e.acceptance_rate.toFixed(0),"%"]}),e.acceptance_rate>=80&&a.jsx("span",{className:"text-green-600 text-sm",children:"\ud83c\udfc6"})]})})]},e.inviter_email||`accepted-${s}`))),0===e.top_accepted.length&&a.jsx("tr",{children:(0,a.jsxs)("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:[a.jsx("div",{className:"text-gray-400 text-2xl mb-2",children:"\u2705"}),a.jsx("p",{children:"Aucune invitation accept\xe9e"}),s&&(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Donn\xe9es ",s.is_available?"en cache":"directes"," - Aucun r\xe9sultat"]})]})})]})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Performance des Invitations"}),s&&s.last_update&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Derni\xe8re M\xe0J: ",new Date(s.last_update).toLocaleString("fr-FR")]})]})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg relative",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-900",children:e.total_invitations_sent}),a.jsx("p",{className:"text-sm text-blue-700",children:"Total Envoy\xe9es"}),s?.is_available&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg relative",children:[a.jsx("p",{className:"text-2xl font-bold text-green-900",children:e.total_invitations_accepted}),a.jsx("p",{className:"text-sm text-green-700",children:"Total Accept\xe9es"}),s?.is_available&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg relative",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.total_invitations_sent-e.total_invitations_accepted}),a.jsx("p",{className:"text-sm text-gray-700",children:"En Attente"}),s?.is_available&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg relative",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-900",children:[e.acceptance_rate.toFixed(1),"%"]}),a.jsx("p",{className:"text-sm text-purple-700",children:"Taux Global"}),s?.is_available&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Analyse Avanc\xe9e"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold text-indigo-600",children:e.unique_inviters}),a.jsx("p",{className:"text-xs text-indigo-700",children:"Inviteurs Actifs"})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold text-teal-600",children:e.unique_inviters>0?(e.total_invitations_sent/e.unique_inviters).toFixed(1):"0.0"}),a.jsx("p",{className:"text-xs text-teal-700",children:"Moy. par Inviteur"})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold text-orange-600",children:e.total_invitations_accepted>0?(e.total_invitations_accepted/e.unique_inviters).toFixed(1):"0.0"}),a.jsx("p",{className:"text-xs text-orange-700",children:"Succ\xe8s par Inviteur"})]})}),a.jsx("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold "+(e.acceptance_rate>=75?"text-green-600":e.acceptance_rate>=50?"text-yellow-600":"text-red-600"),children:e.acceptance_rate>=75?"Excellent":e.acceptance_rate>=50?"Bon":"\xc0 am\xe9liorer"}),a.jsx("p",{className:"text-xs text-gray-700",children:"Performance"})]})})]})]}),s&&(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"inline-flex items-center space-x-1 "+(s.is_available?"text-green-600":"text-red-600"),children:s.is_available?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"}),a.jsx("span",{className:"font-medium",children:"Cache Actif"})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-red-600 rounded-full"}),a.jsx("span",{className:"font-medium",children:"Cache Indisponible"})]})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Source des donn\xe9es"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"font-medium text-blue-600",children:s.is_available?s.performance_gain:"Performance standard"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Temps de chargement"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"font-medium text-gray-700",children:s.next_update?new Date(s.next_update).toLocaleString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"Automatique"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Prochaine mise \xe0 jour"})]})]}),s.is_available&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[a.jsx("span",{children:"Fra\xeecheur des donn\xe9es"}),(0,a.jsxs)("span",{children:[Math.max(0,60-s.cache_age_minutes),"min restantes"]})]}),a.jsx("div",{className:"w-full bg-gray-200 h-2 rounded",children:a.jsx("div",{className:"h-2 rounded transition-all duration-300 "+(s.cache_age_minutes<30?"bg-green-500":s.cache_age_minutes<45?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.max(10,Math.min(100,100-s.cache_age_minutes/60*100))}%`}})})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Export des Statistiques d'Invitations"}),s?.is_available&&a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Donn\xe9es optimis\xe9es"})]})}),a.jsx("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Export CSV Complet"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Toutes les statistiques au format CSV"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[a.jsx("p",{children:"\u2022 Top inviteurs et statistiques d\xe9taill\xe9es"}),(0,a.jsxs)("p",{children:["\u2022 Donn\xe9es ",s?.is_available?"optimis\xe9es par cache":"en temps r\xe9el"]}),s?.is_available&&a.jsx("p",{children:"\u2022 Export\xe9 avec performance optimis\xe9e"})]})]}),a.jsx("button",{onClick:()=>{const t=[["M\xe9trique","Valeur","Source","Timestamp"],["Total Invitations Envoy\xe9es",e.total_invitations_sent,s?.is_available?"Cache":"Direct",(new Date).toISOString()],["Total Invitations Accept\xe9es",e.total_invitations_accepted,s?.is_available?"Cache":"Direct",(new Date).toISOString()],["Taux d'Acceptation Global",`${e.acceptance_rate.toFixed(1)}%`,s?.is_available?"Cache":"Direct",(new Date).toISOString()],["Nombre d'Inviteurs Uniques",e.unique_inviters,s?.is_available?"Cache":"Direct",(new Date).toISOString()],["Moyenne Invitations par Inviteur",e.unique_inviters>0?(e.total_invitations_sent/e.unique_inviters).toFixed(1):"0",s?.is_available?"Cache":"Direct",(new Date).toISOString()],["","","",""],["Top Inviteurs (Envoy\xe9es)","","",""],["Rang","Nom","Email","Envoy\xe9es","Accept\xe9es","Taux"],...e.top_inviters.map(((e,s)=>[s+1,e.inviter_name||"N/A",e.inviter_email,e.invitations_sent,e.invitations_accepted,`${e.acceptance_rate.toFixed(1)}%`])),["","","",""],["Top Inviteurs (Accept\xe9es)","","",""],["Rang","Nom","Email","Accept\xe9es","Total","Efficacit\xe9"],...e.top_accepted.map(((e,s)=>[s+1,e.inviter_name||"N/A",e.inviter_email,e.invitations_accepted,e.invitations_sent,`${e.acceptance_rate.toFixed(1)}%`]))].map((e=>e.map((e=>`"${e}"`)).join(","))).join("\n"),a=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8"}),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=`invitations_stats_${s?.is_available?"cache":"direct"}_${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"\ud83d\udcca Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Export JSON D\xe9taill\xe9"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Format JSON avec m\xe9tadonn\xe9es compl\xe8tes"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[a.jsx("p",{children:"\u2022 Structure compl\xe8te pour analyse avanc\xe9e"}),a.jsx("p",{children:"\u2022 M\xe9tadonn\xe9es de performance incluses"}),s?.is_available&&a.jsx("p",{children:"\u2022 Informations de cache d\xe9taill\xe9es"})]})]}),a.jsx("button",{onClick:()=>{const t={export_metadata:{timestamp:(new Date).toISOString(),data_source:s?.is_available?"ultra_fast_cache":"direct_query",performance_gain:s?.performance_gain||"N/A",cache_age_minutes:s?.cache_age_minutes||null,version:"2.0"},invitation_statistics:e,cache_information:s?{is_cache_enabled:s.is_available,last_cache_update:s.last_update,next_cache_update:s.next_update,cache_performance:s.performance_gain}:null,computed_metrics:{pending_invitations:e.total_invitations_sent-e.total_invitations_accepted,success_rate:e.acceptance_rate,average_invitations_per_inviter:e.unique_inviters>0?(e.total_invitations_sent/e.unique_inviters).toFixed(2):0,performance_rating:e.acceptance_rate>=75?"excellent":e.acceptance_rate>=50?"good":"needs_improvement"},detailed_analysis:{top_performers:e.top_accepted.slice(0,3).map((e=>({name:e.inviter_name,email:e.inviter_email,success_count:e.invitations_accepted,efficiency:e.acceptance_rate}))),most_active:e.top_inviters.slice(0,3).map((e=>({name:e.inviter_name,email:e.inviter_email,invitation_count:e.invitations_sent,success_rate:e.acceptance_rate})))}},a="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t,null,2)),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download",`invitations_complete_${s?.is_available?"cached":"direct"}_${(new Date).toISOString().split("T")[0]}.json`),document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"\ud83d\udd27 Exporter JSON"})]})]})})]})]}):a.jsx("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[a.jsx("div",{className:"text-gray-400 text-2xl mb-2",children:"\ud83d\udce8"}),a.jsx("p",{children:"Statistiques d'invitations non disponibles"})]})}),d=()=>{const{user:e}=(0,i.useAuthStore)(),[s,t]=(0,r.useState)("initializing"),[d,o]=(0,r.useState)(!1),[x,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(null),[b,j]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),[y,N]=(0,r.useState)(null),[_,w]=(0,r.useState)(""),[S,k]=(0,r.useState)(null),[C,q]=(0,r.useState)(null),[F,$]=(0,r.useState)(null),[T,R]=(0,r.useState)(null),[E,A]=(0,r.useState)(null),[P,D]=(0,r.useState)([]),[L,I]=(0,r.useState)(0),[M,O]=(0,r.useState)("month"),[U,Q]=(0,r.useState)("dashboard"),[z,V]=(0,r.useState)({search:"",source:"all",confidence:"all",feedback:"all",user:"all"}),[B,G]=(0,r.useState)(1),[H]=(0,r.useState)(20),[J,W]=(0,r.useState)(null),X=(0,r.useRef)(!1),K=(0,r.useRef)(0),Y=(0,r.useRef)(!1),Z=(0,r.useRef)(new Map),ee=(0,r.useRef)(!1);(0,r.useEffect)((()=>{let a;const r=()=>{if("ready"!==s||!X.current)return console.log("[StatisticsPage] Auth check:",{user:void 0===e?"undefined":null===e?"null":"defined",email:e?.email,user_type:e?.user_type,stabilityCounter:K.current,currentAuthStatus:s}),void 0===e?(console.log("[StatisticsPage] Phase 1: Attente initialisation auth..."),t("initializing"),void(K.current=0)):null===e||e.email&&e.user_type?("ready"!==s&&K.current++,K.current<2&&"ready"!==s?(console.log(`[StatisticsPage] Stabilisation... (${K.current}/2)`),t("checking"),void(a=setTimeout(r,150))):null===e?(console.log("[StatisticsPage] Utilisateur non connect\xe9"),t("unauthorized"),void g("Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 cette page")):"super_admin"!==e.user_type?(console.log("[StatisticsPage] Permissions insuffisantes:",e.user_type),t("forbidden"),void g("Acc\xe8s refus\xe9 - Permissions super_admin requises")):void(X.current||(console.log("[StatisticsPage] Authentification r\xe9ussie:",e.email),t("ready"),g(null),X.current=!0))):(console.log("[StatisticsPage] Phase 2: Donn\xe9es utilisateur incompl\xe8tes, attente..."),t("checking"),void(K.current=0))};return a=setTimeout(r,50),()=>{a&&clearTimeout(a)}}),[e,s]),(0,r.useEffect)((()=>{"ready"!==s||d||Y.current||(console.log("[StatisticsPage] Lancement chargement des statistiques"),Y.current=!0,ae())}),[s]),(0,r.useEffect)((()=>{if("ready"===s&&"questions"===U&&!x){const e=`${B}-${H}`;Z.current.get(e)||(console.log("[StatisticsPage] Lancement chargement des questions pour page:",e),Z.current.set(e,!0),re())}}),[s,U,B]),(0,r.useEffect)((()=>{"ready"!==s||"invitations"!==U||u||ee.current||(console.log("[StatisticsPage] Lancement chargement des invitations"),ee.current=!0,ie())}),[s,U]);const se=e=>{e!==U&&(console.log("[StatisticsPage] Changement onglet:",U,"->",e),"questions"===e&&Z.current.clear(),Q(e))},te=async()=>{try{console.log("\ud83d\udd0d getAuthHeaders: Utilisation localStorage direct");const e=localStorage.getItem("intelia-expert-auth");if(e){const s=JSON.parse(e);if(s.access_token)return console.log("\u2705 Token r\xe9cup\xe9r\xe9 depuis localStorage"),{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"}}return console.log("\u274c Pas de token trouv\xe9"),{}}catch(p){return console.error("\u274c Erreur getAuthHeaders:",p),{}}},ae=async()=>{if(d)return void console.log("\ud83d\udcca [StatisticsPage] Chargement d\xe9j\xe0 en cours, annulation...");console.log("\ud83d\ude80 [StatisticsPage] D\xc9BUT chargement statistiques"),o(!0),g(null);const e=performance.now();try{const s=await te();console.log("\u26a1 Tentative endpoint cache: /api/v1/stats-fast/dashboard");const t=await fetch("/api/v1/stats-fast/dashboard",{headers:s});if(!t.ok)throw new Error(`Erreur cache endpoint: ${t.status} - ${t.statusText}`);const a=await t.json();console.log("\ud83c\udf89 SUCC\xc8S endpoint!",a);const r=performance.now()-e;console.log(`\u26a1 Performance: ${r.toFixed(0)}ms`);const i=a.performanceStats?.performance_gain||a.performance_stats?.performance_gain||a.cache_info?.performance_gain||0,n="number"===typeof i?`${i}%`:i?.toString()||"0%",l={...a.cache_info,performance_gain:n};j(l),w(`${r.toFixed(0)}ms (vs ${n})`);const c=a.systemStats||a.system_stats,d=a.usageStats||a.usage_stats,o=a.billingStats||a.billing_stats,x=a.performanceStats||a.performance_stats,m=c?{...c,system_health:c.system_health?{...c.system_health,error_rate:"string"===typeof c.system_health.error_rate?parseFloat(c.system_health.error_rate)||0:c.system_health.error_rate||0}:c.system_health}:null,u=o?{...o,total_revenue:"string"===typeof o.total_revenue?parseFloat(o.total_revenue)||0:o.total_revenue||0}:null,h=x?{...x,avg_response_time:"string"===typeof x.avg_response_time?parseFloat(x.avg_response_time)||0:x.avg_response_time||0,median_response_time:"string"===typeof x.median_response_time?parseFloat(x.median_response_time)||0:x.median_response_time||0,min_response_time:"string"===typeof x.min_response_time?parseFloat(x.min_response_time)||0:x.min_response_time||0,max_response_time:"string"===typeof x.max_response_time?parseFloat(x.max_response_time)||0:x.max_response_time||0,response_time_count:"string"===typeof x.response_time_count?parseInt(x.response_time_count)||0:x.response_time_count||0,openai_costs:"string"===typeof x.openai_costs?parseFloat(x.openai_costs)||0:x.openai_costs||0,error_count:"string"===typeof x.error_count?parseInt(x.error_count)||0:x.error_count||0,cache_hit_rate:"string"===typeof x.cache_hit_rate?parseFloat(x.cache_hit_rate)||0:x.cache_hit_rate||0,performance_gain:"string"===typeof x.performance_gain?parseFloat(x.performance_gain)||0:x.performance_gain||0}:null;k(m),q(d),$(u),R(h),console.log("\u2705 Toutes les statistiques charg\xe9es depuis le cache!")}catch(s){console.error("\u274c [StatisticsPage] Erreur chargement statistiques:",s),g(`Erreur lors du chargement des statistiques: ${s}`),Y.current=!1}finally{o(!1)}},re=async()=>{if(x)return void console.log("\ud83d\udcdd [Questions] Chargement d\xe9j\xe0 en cours, annulation...");console.log("\u26a1 [Questions] Chargement"),m(!0);const e=performance.now();try{const s=await te(),t=new URLSearchParams({page:B.toString(),limit:H.toString()}),a=await fetch(`/api/v1/stats-fast/questions?${t}`,{headers:s});if(!a.ok)throw new Error(`Erreur questions: ${a.status} - ${a.statusText}`);const r=await a.json();console.log("\ud83c\udf89 Questions charg\xe9es!",r);const i=performance.now()-e;console.log(`\u26a1 Questions Performance: ${i.toFixed(0)}ms`);const n={is_available:!1,last_update:null,cache_age_minutes:0,performance_gain:`${i.toFixed(0)}ms`,next_update:null};v(n);const l=r.questions.map((e=>({id:e.id,timestamp:e.timestamp,user_email:e.user_email,user_name:e.user_name||(e.user_email||"").split("@")[0].replace("."," ").replace(/\b\w/g,(e=>e.toUpperCase())),question:e.question,response:e.response,response_source:ne(e.response_source),confidence_score:e.confidence_score,response_time:e.response_time,language:e.language,session_id:e.session_id,feedback:e.feedback,feedback_comment:e.feedback_comment})));D(l),I(r.pagination.total)}catch(s){console.error("\u274c Erreur chargement questions:",s),g(`Erreur chargement questions: ${s}`),D([]);const e=`${B}-${H}`;Z.current.delete(e)}finally{m(!1)}},ie=async()=>{if(u)return void console.log("\ud83d\udce8 [Invitations] Chargement d\xe9j\xe0 en cours, annulation...");console.log("\u26a1 [Invitations] Chargement"),h(!0),g(null);const e=performance.now();try{const s=await te();if(!s||!("Authorization"in s)||!s.Authorization)throw new Error("Pas de token d'authentification disponible");console.log("\u26a1 Tentative endpoint cache: /api/v1/stats-fast/invitations");const t=await fetch("/api/v1/stats-fast/invitations",{headers:s});if(!t.ok)throw new Error(`Erreur cache invitations: ${t.status} - ${t.statusText}`);const a=await t.json();console.log("\ud83c\udf89 Invitations charg\xe9es!",a);const r=performance.now()-e;console.log(`\u26a1 Invitations Performance: ${r.toFixed(0)}ms`),N(a.cache_info),A(a.invitation_stats)}catch(s){console.error("[StatisticsPage] Erreur chargement stats invitations:",s),g(`Erreur lors du chargement des statistiques d'invitations: ${s}`),ee.current=!1,A({total_invitations_sent:0,total_invitations_accepted:0,acceptance_rate:0,unique_inviters:0,top_inviters:[],top_accepted:[]})}finally{h(!1)}},ne=e=>{switch(e){case"rag":return"rag";case"openai_fallback":return"openai_fallback";case"table_lookup":return"table_lookup";case"validation_rejected":return"validation_rejected";case"quota_exceeded":return"quota_exceeded";default:return"unknown"}};return"initializing"===s?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Initialisation..."})]})}):"checking"===s?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"V\xe9rification des permissions..."}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Stabilisation des donn\xe9es d'authentification"})]})}):"unauthorized"===s?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 max-w-md w-full text-center p-8",children:[a.jsx("div",{className:"text-red-600 text-6xl mb-4",children:"\ud83d\udd12"}),a.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Connexion requise"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 cette page."}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>window.location.href="/login",className:"flex-1 bg-blue-600 text-white px-6 py-2 hover:bg-blue-700 transition-colors",children:"Se connecter"}),a.jsx("button",{onClick:()=>window.history.back(),className:"flex-1 bg-gray-100 text-gray-700 px-6 py-2 hover:bg-gray-200 transition-colors border border-gray-300",children:"Retour"})]})]})}):"forbidden"===s?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 max-w-md w-full text-center p-8",children:[a.jsx("div",{className:"text-red-600 text-6xl mb-4",children:"\ud83d\udeab"}),a.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Acc\xe8s refus\xe9"}),a.jsx("p",{className:"text-gray-600 mb-2",children:"Cette page est r\xe9serv\xe9e aux super administrateurs."}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:["Votre r\xf4le actuel : ",a.jsx("span",{className:"font-medium",children:e?.user_type||"non d\xe9fini"})]}),a.jsx("button",{onClick:()=>window.history.back(),className:"w-full bg-blue-600 text-white px-6 py-2 hover:bg-blue-700 transition-colors",children:"Retour"})]})}):d&&!S?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Chargement des statistiques..."})]})}):p&&"ready"===s&&!S?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 max-w-md w-full text-center p-8",children:[a.jsx("div",{className:"text-amber-600 text-6xl mb-4",children:"\u26a0\ufe0f"}),a.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Erreur"}),a.jsx("p",{className:"text-gray-600 mb-6",children:p}),a.jsx("button",{onClick:()=>{Y.current=!1,ae()},className:"w-full bg-blue-600 text-white px-6 py-2 hover:bg-blue-700 transition-colors",children:"R\xe9essayer"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[a.jsx("div",{className:"flex items-center",children:a.jsx("img",{src:"/images/logo.png",alt:"Logo",className:"h-8 w-auto"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[a.jsx("button",{onClick:()=>se("dashboard"),className:"px-3 py-2 text-sm font-medium transition-colors "+("dashboard"===U?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Tableau de bord"}),a.jsx("button",{onClick:()=>se("questions"),className:"px-3 py-2 text-sm font-medium transition-colors "+("questions"===U?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Questions & R\xe9ponses"}),a.jsx("button",{onClick:()=>se("invitations"),className:"px-3 py-2 text-sm font-medium transition-colors "+("invitations"===U?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Invitations"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:["dashboard"===U&&(0,a.jsxs)("button",{onClick:()=>{Y.current=!1,ae()},disabled:d,className:"bg-blue-600 text-white px-3 py-1 text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),a.jsx("span",{children:d?"Loading...":"Refresh"})]}),"questions"===U&&(0,a.jsxs)("button",{onClick:()=>{Z.current.clear(),re()},disabled:x,className:"bg-blue-600 text-white px-3 py-1 text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),a.jsx("span",{children:x?"Loading...":"Refresh"})]}),"invitations"===U&&(0,a.jsxs)("button",{onClick:()=>{ee.current=!1,ie()},disabled:u,className:"bg-blue-600 text-white px-3 py-1 text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),a.jsx("span",{children:u?"Loading...":"Refresh"})]})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:["dashboard"===U?a.jsx(n,{systemStats:S,usageStats:C,billingStats:F,performanceStats:T,cacheStatus:b?{...b,performance_gain:"string"===typeof b.performance_gain?b.performance_gain:`${b.performance_gain}%`}:null,isLoading:d}):"questions"===U?a.jsx(l,{questionLogs:P,questionFilters:z,setQuestionFilters:V,selectedTimeRange:M,setSelectedTimeRange:O,currentPage:B,setCurrentPage:G,questionsPerPage:H,setSelectedQuestion:W,isLoading:x,totalQuestions:L,cacheStatus:f?{...f,performance_gain:"string"===typeof f.performance_gain?f.performance_gain:`${f.performance_gain}%`}:null}):"invitations"===U?a.jsx(a.Fragment,{children:u&&!E?(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-8 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Chargement des statistiques d'invitations..."})]}):a.jsx(c,{invitationStats:E,cacheStatus:y?{...y,performance_gain:"string"===typeof y.performance_gain?y.performance_gain:`${y.performance_gain}%`}:null,isLoading:u})}):null,J&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsx("h3",{className:"text-base font-medium text-gray-900",children:"D\xe9tails de la Question"})]}),a.jsx("button",{onClick:()=>W(null),className:"text-gray-400 hover:text-gray-600 p-1",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 border border-blue-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[a.jsx("span",{children:"\u2753"}),a.jsx("span",{children:"Question:"})]}),a.jsx("p",{className:"text-gray-700",children:J.question})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 border border-gray-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[a.jsx("span",{children:"\ud83d\udcac"}),a.jsx("span",{children:"R\xe9ponse:"})]}),a.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:J.response})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-3 flex items-center space-x-2",children:[a.jsx("span",{children:"\ud83d\udcca"}),a.jsx("span",{children:"M\xe9tadonn\xe9es:"})]}),a.jsx("table",{className:"w-full text-sm",children:(0,a.jsxs)("tbody",{className:"space-y-2",children:[(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Source:"}),a.jsx("td",{className:"font-medium py-1",children:J.response_source})]}),(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Confiance:"}),(0,a.jsxs)("td",{className:"font-medium py-1",children:[(100*J.confidence_score).toFixed(1),"%"]})]}),(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Temps:"}),(0,a.jsxs)("td",{className:"font-medium py-1",children:[J.response_time,"s"]})]}),(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Langue:"}),a.jsx("td",{className:"font-medium py-1",children:J.language})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-3 flex items-center space-x-2",children:[a.jsx("span",{children:"\ud83d\udc64"}),a.jsx("span",{children:"Utilisateur:"})]}),a.jsx("table",{className:"w-full text-sm",children:(0,a.jsxs)("tbody",{className:"space-y-2",children:[(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Email:"}),a.jsx("td",{className:"font-medium py-1",children:J.user_email})]}),(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Session:"}),(0,a.jsxs)("td",{className:"font-medium py-1",children:[J.session_id.substring(0,12),"..."]})]}),(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Date:"}),a.jsx("td",{className:"font-medium py-1",children:new Date(J.timestamp).toLocaleString("fr-FR")})]}),(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"text-gray-600 py-1",children:"Feedback:"}),a.jsx("td",{className:"text-lg py-1",children:(le=J.feedback,1===le?"\ud83d\udc4d":-1===le?"\ud83d\udc4e":"\u2753")})]})]})})]})]}),J.feedback_comment&&(0,a.jsxs)("div",{className:"bg-purple-50 p-4 border border-purple-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[a.jsx("span",{children:"\ud83d\udcad"}),a.jsx("span",{children:"Commentaire:"})]}),(0,a.jsxs)("p",{className:"text-gray-700 italic",children:['"',J.feedback_comment,'"']})]})]})})]})})]})]});var le};function o(){return a.jsx(d,{})}},829:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});const a=(0,t(8570).createProxy)(String.raw`C:\intelia_gpt\intelia-expert\frontend\app\admin\statistics\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=s.X(0,[276,737,190],(()=>{return e=6519,s(s.s=e);var e}));module.exports=t})();