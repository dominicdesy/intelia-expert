(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[616],{2622:function(e,t,n){Promise.resolve().then(n.bind(n,1457))},1457:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var r=n(7437),a=n(2265),i=n(9376),s=n(7648),o=n(9272),c=n(7667),l=n(257);const d=e=>{let{className:t="w-12 h-12"}=e;return(0,r.jsx)("img",{src:"/images/favicon.png",alt:"Intelia Logo",className:t})},u=e=>{let{email:t}=e;const{t:n}=(0,c.$G)(),o=(0,i.useRouter)();return(0,a.useEffect)((()=>{const e=setTimeout((()=>{o.push("/")}),5e3);return()=>clearTimeout(e)}),[o]),(0,r.jsx)("div",{className:"bg-white py-8 px-6 shadow-lg rounded-lg border border-gray-200",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{className:"mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-green-100",children:(0,r.jsx)("svg",{className:"h-10 w-10 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:n("verification.success.title")}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:t?"".concat(n("verification.success.emailConfirmed"),": ").concat(t):n("verification.success.confirmed")}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:n("verification.success.canLogin")}),(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full"})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-6",children:n("verification.autoRedirect")}),(0,r.jsx)("div",{className:"space-y-3",children:(0,r.jsx)(s.default,{href:"/",className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:n("verification.loginNow")})})]})})},g=e=>{let{error:t}=e;const{t:n}=(0,c.$G)();return(0,r.jsx)("div",{className:"bg-white py-8 px-6 shadow-lg rounded-lg border border-red-200",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{className:"mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-red-100",children:(0,r.jsx)("svg",{className:"h-10 w-10 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:n("verification.error.title")}),(0,r.jsx)("p",{className:"text-red-600 mb-6",children:t}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-red-800 mb-2",children:n("verification.error.possibleCauses")}),(0,r.jsxs)("ul",{className:"text-sm text-red-700 list-disc list-inside space-y-1",children:[(0,r.jsx)("li",{children:n("verification.error.expired")}),(0,r.jsx)("li",{children:n("verification.error.alreadyUsed")}),(0,r.jsx)("li",{children:n("verification.error.invalid")})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(s.default,{href:"/?signup=true",className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:n("verification.error.retrySignup")}),(0,r.jsx)(s.default,{href:"/",className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:n("verification.backToLogin")})]})]})})},f=e=>{let{email:t}=e;const{t:n}=(0,c.$G)();return(0,r.jsx)("div",{className:"bg-white py-8 px-6 shadow-lg rounded-lg border border-gray-200",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{className:"mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-blue-100",children:(0,r.jsx)("svg",{className:"h-10 w-10 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:n("verification.pending.title")}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:t?"".concat(n("verification.pending.emailSentTo"),": ").concat(t):n("verification.pending.emailSent")}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:n("verification.pending.nextSteps")}),(0,r.jsxs)("ol",{className:"text-sm text-blue-700 list-decimal list-inside space-y-1",children:[(0,r.jsx)("li",{children:n("verification.pending.step1")}),(0,r.jsx)("li",{children:n("verification.pending.step2")}),(0,r.jsx)("li",{children:n("verification.pending.step3")})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(s.default,{href:"/",className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:n("verification.backToLogin")}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:n("verification.refreshPage")})]})]})})};function m(){const{t:e}=(0,c.$G)(),t=(0,i.useRouter)(),n=(0,i.useSearchParams)(),{isAuthenticated:m,user:h}=(0,o.useAuthStore)(),[x,v]=(0,a.useState)("loading"),[b,p]=(0,a.useState)(""),[j,y]=(0,a.useState)(null);return(0,a.useEffect)((()=>{m&&h&&(console.log("[VerifyEmail] Utilisateur d\xe9j\xe0 connect\xe9, redirection..."),t.push("/chat"))}),[m,h,t]),(0,a.useEffect)((()=>{(async()=>{const t=n.get("token"),r=n.get("confirmation_url"),a=n.get("email"),i=n.get("type");if(console.log("[VerifyEmail] Param\xe8tres URL:",{token:t,confirmationUrl:r,emailParam:a,type:i}),y(a),!t&&!r)return console.log("[VerifyEmail] Pas de token - page en attente"),v("pending"),void p(a?"".concat(e("verification.pending.emailSentTo"),": ").concat(a):e("verification.pending.checkEmail"));const s=t||r;try{console.log("[VerifyEmail] V\xe9rification en cours..."),p(e("verification.verifying"));const t=await fetch("".concat(l.env.NEXT_PUBLIC_API_BASE_URL||"https://expert-app-cngws.ondigitalocean.app/api","/v1/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s,type:i||"signup"})});if(t.ok){const n=await t.json();console.log("[VerifyEmail] V\xe9rification r\xe9ussie"),v("success"),p(e("verification.success.verified")),y(n.email||a)}else{const n=await t.json().catch((()=>({})));console.log("[VerifyEmail] V\xe9rification \xe9chou\xe9e:",n),v("error"),400===t.status?p(e("verification.error.invalidOrExpired")):409===t.status?p(e("verification.error.alreadyVerified")):p(n.detail||e("verification.error.generic"))}}catch(o){console.error("[VerifyEmail] Erreur r\xe9seau:",o),v("error"),p(e("verification.error.network"))}})()}),[n,e]),m&&h?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(d,{className:"w-16 h-16 mx-auto mb-4"}),(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:e("verification.redirecting")})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)(d,{className:"w-12 h-12"})}),(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:e("verification.title")}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:e("verification.subtitle")})]}),"loading"===x&&(0,r.jsx)("div",{className:"bg-white py-8 px-6 shadow-lg rounded-lg border border-gray-200",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:b})]})}),"success"===x&&(0,r.jsx)(u,{email:j||void 0}),"error"===x&&(0,r.jsx)(g,{error:b}),"pending"===x&&(0,r.jsx)(f,{email:j||void 0}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[e("verification.noEmail")," ",(0,r.jsx)(s.default,{href:"/?signup=true",className:"text-blue-600 hover:text-blue-500 font-medium",children:e("verification.retrySignup")})]})}),(0,r.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:[e("verification.supportQuestion")," ",(0,r.jsx)("button",{type:"button",onClick:()=>window.open("mailto:".concat(e("contact.supportEmail"),"?subject=").concat(encodeURIComponent(e("verification.supportSubject"))),"_blank"),className:"text-blue-600 hover:underline font-medium transition-colors",children:e("verification.contactSupport")})]})}),!1]})})}function h(){const{t:e}=(0,c.$G)();return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100 mb-4",children:(0,r.jsx)("svg",{className:"h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:e("verification.loadingVerification")})]})}),children:(0,r.jsx)(m,{})})}},9939:function(e,t,n){"use strict";n.d(t,{Ik:function(){return i},L_:function(){return s},Yc:function(){return o},k$:function(){return a},mT:function(){return r}});const r=[{code:"fr",name:"French",nativeName:"Fran\xe7ais",region:"France",flag:"\ud83c\uddeb\ud83c\uddf7",dateFormat:"fr-FR"},{code:"en",name:"English",nativeName:"English",region:"United States",flag:"\ud83c\uddfa\ud83c\uddf8",dateFormat:"en-US"},{code:"es",name:"Spanish",nativeName:"Espa\xf1ol",region:"Spain",flag:"\ud83c\uddea\ud83c\uddf8",dateFormat:"es-ES"},{code:"pt",name:"Portuguese",nativeName:"Portugu\xeas",region:"Portugal",flag:"\ud83c\uddf5\ud83c\uddf9",dateFormat:"pt-PT"},{code:"de",name:"German",nativeName:"Deutsch",region:"Germany",flag:"\ud83c\udde9\ud83c\uddea",dateFormat:"de-DE"},{code:"nl",name:"Dutch",nativeName:"Nederlands",region:"Netherlands",flag:"\ud83c\uddf3\ud83c\uddf1",dateFormat:"nl-NL"},{code:"pl",name:"Polish",nativeName:"Polski",region:"Poland",flag:"\ud83c\uddf5\ud83c\uddf1",dateFormat:"pl-PL"},{code:"th",name:"Thai",nativeName:"\u0e44\u0e17\u0e22",region:"Thailand",flag:"\ud83c\uddf9\ud83c\udded",dateFormat:"th-TH"},{code:"hi",name:"Hindi",nativeName:"\u0939\u093f\u0902\u0926\u0940",region:"India",flag:"\ud83c\uddee\ud83c\uddf3",dateFormat:"hi-IN"},{code:"zh",name:"Chinese (Mandarin)",nativeName:"\u4e2d\u6587",region:"China",flag:"\ud83c\udde8\ud83c\uddf3",dateFormat:"zh-CN"}],a="en",i=e=>r.find((t=>t.code===e)),s=e=>r.some((t=>t.code===e)),o=()=>{var e;const t=navigator.language||(null===(e=navigator.languages)||void 0===e?void 0:e[0]);if(!t)return a;const n=t.split("-")[0].toLowerCase();return s(n)?n:a};new Set(["ar","he","fa","ur"])},7667:function(e,t,n){"use strict";n.d(t,{$G:function(){return x},Ik:function(){return i.Ik},mT:function(){return i.mT}});var r=n(2265),a=n(8225),i=n(9939);const s=(0,a.getSupabaseClient)();class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter((t=>t!==e))}}notify(){this.subscribers.forEach((e=>{try{e()}catch(t){console.error("Erreur notification i18n:",t)}}))}constructor(){this.subscribers=[]}}const c=o.getInstance(),l={},d=new Set;let u={},g=!0,f=null;const m=()=>{try{const t=localStorage.getItem("intelia-language");if(t){var e;const n=JSON.parse(t);return(null===n||void 0===n||null===(e=n.state)||void 0===e?void 0:e.currentLanguage)||i.k$}}catch(t){console.warn("Erreur lecture langue stock\xe9e:",t)}return i.k$};async function h(e){if(d.has(e))return console.warn("[i18n] Langue ".concat(e," en cache d'erreur, utilisation de ").concat(i.k$)),e===i.k$?{}:h(i.k$);if(l[e])return u=l[e],g=!1,f=e,c.notify(),l[e];try{const t=await fetch("/locales/".concat(e,".json"));if(!t.ok)throw new Error("HTTP ".concat(t.status,": Failed to load translations for ").concat(e));const n=await t.json();if(!n||"object"!==typeof n||0===Object.keys(n).length)throw new Error("Empty or invalid translations for ".concat(e));return l[e]=n,u=n,g=!1,f=e,c.notify(),console.log("[i18n] \u2705 Traductions charg\xe9es pour ".concat(e,": ").concat(Object.keys(n).length," cl\xe9s")),n}catch(t){return console.error("[i18n] \u274c Could not load translations for ".concat(e,":"),t),d.add(e),e!==i.k$?(console.warn("[i18n] \ud83d\udd04 Falling back to ".concat(i.k$)),h(i.k$)):(console.error("[i18n] \ud83d\udca5 Even ".concat(i.k$," failed to load, returning empty translations")),{})}}const x=()=>{const[e,t]=(0,r.useState)(i.k$),[n,a]=(0,r.useState)({}),[o,f]=(0,r.useState)(!0),[,x]=(0,r.useState)({});(0,r.useEffect)((()=>c.subscribe((()=>{x({})}))),[]),(0,r.useEffect)((()=>{(async()=>{try{var e,n;const r=m();if(r&&(0,i.L_)(r))return console.log("[i18n] \ud83d\udce6 Initialisation avec langue stock\xe9e: ".concat(r)),void t(r);const{data:{session:a}}=await s.auth.getSession(),o=null===a||void 0===a||null===(n=a.user)||void 0===n||null===(e=n.user_metadata)||void 0===e?void 0:e.language;if(o&&(0,i.L_)(o))return console.log("[i18n] \ud83d\udce6 Initialisation avec langue Supabase: ".concat(o)),void t(o);const c=(0,i.Yc)();console.log("[i18n] \ud83d\udce6 Initialisation avec langue navigateur: ".concat(c)),t(c)}catch(r){console.log("Erreur initialisation langue, utilisation navigateur");const e=(0,i.Yc)();t(e)}})()}),[]),(0,r.useEffect)((()=>{const n=setInterval((()=>{const n=m();n&&n!==e&&(0,i.L_)(n)&&(console.log("[i18n] \ud83d\udd04 Resynchronisation d\xe9tect\xe9e: ".concat(e," \u2192 ").concat(n)),t(n))}),1e3);return()=>{clearInterval(n)}}),[e]),(0,r.useEffect)((()=>{const n=n=>{if("intelia-language"===n.key&&n.newValue)try{var r;const a=JSON.parse(n.newValue),s=null===a||void 0===a||null===(r=a.state)||void 0===r?void 0:r.currentLanguage;s&&s!==e&&(0,i.L_)(s)&&(console.log("[i18n] \ud83d\udd04 Changement localStorage d\xe9tect\xe9: ".concat(e," \u2192 ").concat(s)),t(s))}catch(a){console.warn("Erreur parsing localStorage change:",a)}};return window.addEventListener("storage",n),()=>{window.removeEventListener("storage",n)}}),[e]),(0,r.useEffect)((()=>{(async()=>{f(!0);try{const t=await h(e);a(t),f(!1)}catch(t){console.error("Erreur chargement traductions:",t),f(!1)}})()}),[e]),(0,r.useEffect)((()=>{const e=e=>{t(e.detail.language)};return window.addEventListener("languageChanged",e),()=>{window.removeEventListener("languageChanged",e)}}),[]);return{t:e=>{const t=Object.keys(n).length>0?n:u;return o&&g||!t[e]?e:t[e]},changeLanguage:async e=>{Object.keys(l).forEach((e=>{delete l[e]})),u={},g=!0,d.delete(e),t(e);try{const t={state:{currentLanguage:e}};localStorage.setItem("intelia-language",JSON.stringify(t)),console.log("[i18n] Langue sauvegard\xe9e:",e)}catch(n){console.warn("[i18n] Erreur sauvegarde langue:",n)}await h(e),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}}))},getCurrentLanguage:()=>e,formatDate:t=>{const n=(0,i.Ik)(e),r=(null===n||void 0===n?void 0:n.dateFormat)||"en-US";return t.toLocaleDateString(r,{day:"numeric",month:"long",year:"numeric"})},currentLanguage:e,loading:o}}}},function(e){e.O(0,[216,286,744],(function(){return t=2622,e(e.s=t);var t}));var t=e.O();_N_E=t}]);