(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{2391:function(e,t,a){Promise.resolve().then(a.bind(a,3491))},3491:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(7437),n=a(2265),o=a(9376),r=a(7667),i=a(257);const l=[{value:"CA",label:"Canada",phoneCode:"+1",flag:"\ud83c\udde8\ud83c\udde6"},{value:"US",label:"\xc9tats-Unis",phoneCode:"+1",flag:"\ud83c\uddfa\ud83c\uddf8"},{value:"FR",label:"France",phoneCode:"+33",flag:"\ud83c\uddeb\ud83c\uddf7"},{value:"GB",label:"Royaume-Uni",phoneCode:"+44",flag:"\ud83c\uddec\ud83c\udde7"},{value:"DE",label:"Allemagne",phoneCode:"+49",flag:"\ud83c\udde9\ud83c\uddea"},{value:"IT",label:"Italie",phoneCode:"+39",flag:"\ud83c\uddee\ud83c\uddf9"},{value:"ES",label:"Espagne",phoneCode:"+34",flag:"\ud83c\uddea\ud83c\uddf8"},{value:"BE",label:"Belgique",phoneCode:"+32",flag:"\ud83c\udde7\ud83c\uddea"},{value:"CH",label:"Suisse",phoneCode:"+41",flag:"\ud83c\udde8\ud83c\udded"},{value:"MX",label:"Mexique",phoneCode:"+52",flag:"\ud83c\uddf2\ud83c\uddfd"},{value:"BR",label:"Br\xe9sil",phoneCode:"+55",flag:"\ud83c\udde7\ud83c\uddf7"},{value:"AU",label:"Australie",phoneCode:"+61",flag:"\ud83c\udde6\ud83c\uddfa"},{value:"JP",label:"Japon",phoneCode:"+81",flag:"\ud83c\uddef\ud83c\uddf5"},{value:"CN",label:"Chine",phoneCode:"+86",flag:"\ud83c\udde8\ud83c\uddf3"},{value:"IN",label:"Inde",phoneCode:"+91",flag:"\ud83c\uddee\ud83c\uddf3"},{value:"NL",label:"Pays-Bas",phoneCode:"+31",flag:"\ud83c\uddf3\ud83c\uddf1"},{value:"SE",label:"Su\xe8de",phoneCode:"+46",flag:"\ud83c\uddf8\ud83c\uddea"},{value:"NO",label:"Norv\xe8ge",phoneCode:"+47",flag:"\ud83c\uddf3\ud83c\uddf4"},{value:"DK",label:"Danemark",phoneCode:"+45",flag:"\ud83c\udde9\ud83c\uddf0"},{value:"FI",label:"Finlande",phoneCode:"+358",flag:"\ud83c\uddeb\ud83c\uddee"}],c=()=>{const[e,t]=(0,n.useState)(l),[a,s]=(0,n.useState)(!0),[o,r]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const e=setTimeout((async()=>{try{console.log("[Countries] Tentative de chargement via API REST Countries...");const e=await fetch("https://restcountries.com/v3.1/all?fields=cca2,name,idd,flag,translations",{headers:{Accept:"application/json"}});if(!e.ok)throw new Error("API Error: ".concat(e.status," ").concat(e.statusText));const a=await e.json();console.log("[Countries] Donn\xe9es re\xe7ues:",a.length,"pays");const s=a.map((e=>{var t,a,s,n,o;const r=(null===(t=e.idd)||void 0===t?void 0:t.root)+((null===(s=e.idd)||void 0===s||null===(a=s.suffixes)||void 0===a?void 0:a[0])||"");return{value:e.cca2,label:(null===(o=e.translations)||void 0===o||null===(n=o.fra)||void 0===n?void 0:n.common)||e.name.common,phoneCode:r,flag:e.flag}})).filter((e=>e.phoneCode&&"undefined"!==e.phoneCode&&"null"!==e.phoneCode&&e.phoneCode.length>1&&e.phoneCode.startsWith("+")&&e.value&&e.label)).sort(((e,t)=>e.label.localeCompare(t.label)));if(!(s.length>=50))throw new Error("Donn\xe9es insuffisantes");t(s),r(!1),console.log("[Countries] API REST Countries utilis\xe9e avec succ\xe8s")}catch(e){console.warn("[Countries] API REST Countries bloqu\xe9e, utilisation du fallback:",e),t(l),r(!0)}finally{s(!1)}}),100);return()=>clearTimeout(e)}),[]),{countries:e,loading:a,usingFallback:o}},d=(e,t)=>{const a=[];return e.length<8&&a.push(t("validation.password.minLength")),/[A-Z]/.test(e)||a.push(t("validation.password.uppercase")),/[a-z]/.test(e)||a.push(t("validation.password.lowercase")),/\d/.test(e)||a.push(t("validation.password.number")),/[!@#$%^&*(),.?":{}|<>]/.test(e)||a.push(t("validation.password.special")),a},u=(e,t,a,s,n)=>{if(!e.trim()&&!t.trim()&&!a.trim())return!0;if(e.trim()&&!t.trim()&&!a.trim()&&s&&n[s]===e.trim())return!0;if(t.trim()||a.trim()){if(!e.trim()||!t.trim()||!a.trim())return!1;if(!/^\+[1-9]\d{0,3}$/.test(e.trim()))return!1;if(!/^\d{3}$/.test(t.trim()))return!1;if(!/^\d{7}$/.test(a.trim()))return!1}return!0},m=e=>{let{className:t="w-12 h-12"}=e;return(0,s.jsx)("img",{src:"/images/favicon.png",alt:"Intelia Logo",className:t})},p=e=>{let{result:t}=e;const{t:a}=(0,r.$G)();return(0,s.jsxs)("div",{className:"text-center",children:[t.success?(0,s.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}):(0,s.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})})}),(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 ".concat(t.success?"text-green-900":"text-red-900"),children:(()=>{switch(t.step){case"validation":return t.success?a("invitation.status.tokenValidated"):a("invitation.status.tokenError");case"completion":return t.success?a("invitation.status.accountCreated"):a("invitation.status.accountError");default:return a("invitation.status.processing")}})()}),(0,s.jsx)("div",{className:"text-sm mb-4 ".concat(t.success?"text-green-700":"text-red-700"),children:t.message}),t.success&&"completion"===t.step&&(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,s.jsx)("p",{children:a("invitation.redirecting.dashboard")}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-green-600 h-2 rounded-full animate-pulse",style:{width:"100%"}})})})]}),!t.success&&(0,s.jsx)("div",{className:"text-xs text-gray-600",children:a("invitation.redirecting.login")})]})};function h(){const{t:e}=(0,r.$G)(),t=(0,o.useRouter)(),a=(0,o.useSearchParams)(),[l,h]=(0,n.useState)("loading"),[g,x]=(0,n.useState)(""),[v,f]=(0,n.useState)(null),[b,N]=(0,n.useState)(!1),[y,j]=(0,n.useState)(!1),[w,k]=(0,n.useState)(null),{countries:C,loading:L,usingFallback:E}=c(),S=(0,n.useMemo)((()=>C.reduce(((e,t)=>(e[t.value]=t.phoneCode,e)),{})),[C]),[I,P]=(0,n.useState)({password:"",confirmPassword:"",firstName:"",lastName:"",linkedinProfile:"",email:"",country:"",countryCode:"",areaCode:"",phoneNumber:"",companyName:"",companyWebsite:"",companyLinkedin:"",jobTitle:""}),[_,T]=(0,n.useState)([]),[A,q]=(0,n.useState)(!1),[B,U]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const s=setTimeout((async()=>{try{if(y)return void console.log("[InvitationAccept] Token d\xe9j\xe0 trait\xe9, ignorer");console.log("[InvitationAccept] D\xe9but traitement invitation");const r=window.location.hash,l=a.get("token"),c=a.get("type"),d=r&&(r.includes("access_token")||r.includes("type=invite")),u=l&&"invite"===c;if(d||u){var s,n,o;console.log("[InvitationAccept] Invitation d\xe9tect\xe9e dans URL"),x(e("invitation.validating")),j(!0);let t="";if(d){t=new URLSearchParams(r.substring(1)).get("access_token")||""}else u&&(t=l||"");if(!t)throw new Error(e("invitation.errors.missingToken"));console.log("[InvitationAccept] Token extrait, validation via backend...");const a=i.env.NEXT_PUBLIC_API_URL||i.env.NEXT_PUBLIC_API_BASE_URL,c=await fetch("".concat(a,"/v1/auth/invitations/validate-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:t})});if(!c.ok){const t=await c.json();throw k({success:!1,step:"validation",message:t.detail||e("invitation.errors.tokenValidation"),details:t}),new Error(t.detail||e("invitation.errors.tokenValidation"))}const m=await c.json();console.log("[InvitationAccept] Token valid\xe9:",m.user_email),k({success:!0,step:"validation",message:"".concat(e("invitation.success.tokenValidated"),": ").concat(m.user_email),details:m}),f({email:m.user_email,inviterName:m.inviter_name,personalMessage:null===(s=m.invitation_data)||void 0===s?void 0:s.personal_message,language:null===(n=m.invitation_data)||void 0===n?void 0:n.language,invitationDate:null===(o=m.invitation_data)||void 0===o?void 0:o.invitation_date,accessToken:t}),P((e=>({...e,email:m.user_email}))),console.log("[InvitationAccept] Passage au mode set-password"),h("set-password"),x(e("invitation.completeProfile")),setTimeout((()=>{window.history.replaceState({},document.title,window.location.pathname)}),100)}else y||(console.log("[InvitationAccept] Pas d'invitation trouv\xe9e"),h("error"),x(e("invitation.errors.noInvitation")),k({success:!1,step:"validation",message:e("invitation.errors.noInvitation")}),setTimeout((()=>t.push("/auth/login")),2e3))}catch(r){console.error("[InvitationAccept] Erreur traitement:",r),h("error"),r instanceof Error?x(r.message):x(e("invitation.errors.processing")),setTimeout((()=>{t.push("/auth/login?error="+encodeURIComponent(r instanceof Error?r.message:e("invitation.errors.generic")))}),4e3)}}),500);return()=>clearTimeout(s)}),[t,a,y,e]);const M=(e,t)=>{P((a=>{const s={...a,[e]:t};return"country"===e&&t&&S[t]&&(s.countryCode=S[t],s.areaCode="",s.phoneNumber=""),s})),_.length>0&&T([])};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,s.jsx)("div",{className:"flex justify-center mb-8",children:(0,s.jsx)(m,{className:"w-16 h-16"})}),(0,s.jsx)("h1",{className:"text-center text-3xl font-bold text-gray-900 mb-2",children:e("common.appName")}),(0,s.jsx)("p",{className:"text-center text-sm text-gray-600 mb-8",children:e("set-password"===l?"invitation.completeProfile":"invitation.finalizingInvitation")})]}),(0,s.jsx)("div",{className:"sm:mx-auto sm:w-full sm:max-w-2xl",children:(0,s.jsxs)("div",{className:"bg-white py-8 px-4 shadow-lg sm:rounded-lg sm:px-10",children:["loading"===l&&(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:e("invitation.processing")}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:g||e("invitation.validating")}),(0,s.jsxs)("div",{className:"mt-4 text-xs text-gray-400",children:[(0,s.jsx)("p",{children:e("invitation.backendValidation")}),(0,s.jsx)("p",{children:e("invitation.waitMessage")})]}),w&&"validation"===w.step&&(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(p,{result:w})})]}),"set-password"===l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 text-center",children:e("invitation.welcomeComplete")}),v&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:e("invitation.validatedSuccess")}),(0,s.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,s.jsxs)("p",{children:[(0,s.jsxs)("strong",{children:[e("profile.email"),":"]})," ",v.email]}),v.inviterName&&(0,s.jsxs)("p",{children:[(0,s.jsxs)("strong",{children:[e("invitation.invitedBy"),":"]})," ",v.inviterName]}),v.personalMessage&&(0,s.jsxs)("div",{className:"mt-2 p-2 bg-white rounded border",children:[(0,s.jsxs)("p",{className:"text-xs text-gray-600 mb-1",children:[e("invitation.personalMessage"),":"]}),(0,s.jsxs)("p",{className:"text-sm italic",children:['"',v.personalMessage,'"']})]})]})]}),E&&!L&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})}),(0,s.jsx)("span",{className:"text-sm text-yellow-800",children:e("countries.limitedList")})]})}),_.length>0&&(0,s.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:e("validation.correctErrors")}),(0,s.jsx)("div",{className:"mt-1 text-sm text-red-700",children:_.map(((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)("span",{className:"text-red-500 font-bold",children:"\u2022"}),(0,s.jsx)("span",{children:e})]},t)))})]})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"border-b border-gray-200 pb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:e("profile.personalInfo")}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.firstName")," ",(0,s.jsx)("span",{className:"text-red-500",children:e("form.required")})]}),(0,s.jsx)("input",{type:"text",required:!0,value:I.firstName,onChange:e=>M("firstName",e.target.value),placeholder:e("placeholder.firstName"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.lastName")," ",(0,s.jsx)("span",{className:"text-red-500",children:e("form.required")})]}),(0,s.jsx)("input",{type:"text",required:!0,value:I.lastName,onChange:e=>M("lastName",e.target.value),placeholder:e("placeholder.lastName"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.linkedinProfile")," ",e("common.optional")]}),(0,s.jsx)("input",{type:"url",value:I.linkedinProfile,onChange:e=>M("linkedinProfile",e.target.value),placeholder:e("placeholder.linkedinPersonal"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]})]}),(0,s.jsxs)("div",{className:"border-b border-gray-200 pb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:e("profile.contact")}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.email")," ",(0,s.jsx)("span",{className:"text-red-500",children:e("form.required")})]}),(0,s.jsx)("input",{type:"email",required:!0,value:I.email,onChange:e=>M("email",e.target.value),placeholder:e("placeholder.email"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm bg-gray-50",disabled:!0,readOnly:!0}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:e("invitation.emailFromInvitation")})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.country")," ",(0,s.jsx)("span",{className:"text-red-500",children:e("form.required")})]}),L?(0,s.jsx)("div",{className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 bg-gray-50",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:e("countries.loading")})]})}):(0,s.jsxs)("select",{required:!0,value:I.country,onChange:e=>M("country",e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b,children:[(0,s.jsx)("option",{value:"",children:e("placeholder.countrySelect")}),C.map((e=>(0,s.jsxs)("option",{value:e.value,children:[e.flag," ",e.label]},e.value)))]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("profile.phone")," ",e("common.optional")]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:e("invitation.phoneAutoFill")}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:e("profile.countryCode")}),(0,s.jsx)("input",{type:"text",placeholder:"+1",value:I.countryCode,onChange:e=>M("countryCode",e.target.value),className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm bg-gray-50",disabled:b,readOnly:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:e("profile.areaCode")}),(0,s.jsx)("input",{type:"text",placeholder:"514",value:I.areaCode,onChange:e=>M("areaCode",e.target.value),className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:e("profile.phoneNumber")}),(0,s.jsx)("input",{type:"text",placeholder:"1234567",value:I.phoneNumber,onChange:e=>M("phoneNumber",e.target.value),className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]})]})]})]}),(0,s.jsxs)("div",{className:"border-b border-gray-200 pb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:e("profile.company")}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.companyName")," ",e("common.optional")]}),(0,s.jsx)("input",{type:"text",value:I.companyName,onChange:e=>M("companyName",e.target.value),placeholder:e("placeholder.companyName"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.companyWebsite")," ",e("common.optional")]}),(0,s.jsx)("input",{type:"url",value:I.companyWebsite,onChange:e=>M("companyWebsite",e.target.value),placeholder:e("placeholder.companyWebsite"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.companyLinkedin")," ",e("common.optional")]}),(0,s.jsx)("input",{type:"url",value:I.companyLinkedin,onChange:e=>M("companyLinkedin",e.target.value),placeholder:e("placeholder.linkedinCorporate"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.jobTitle")," ",e("common.optional")]}),(0,s.jsx)("input",{type:"text",value:I.jobTitle,onChange:e=>M("jobTitle",e.target.value),placeholder:e("placeholder.jobTitle"),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:e("profile.security")}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.password")," ",(0,s.jsx)("span",{className:"text-red-500",children:e("form.required")})]}),(0,s.jsxs)("div",{className:"mt-1 relative",children:[(0,s.jsx)("input",{type:A?"text":"password",required:!0,value:I.password,onChange:e=>M("password",e.target.value),className:"block w-full rounded-md border border-gray-300 px-3 py-2 pr-10 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b}),(0,s.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>q(!A),disabled:b,children:A?(0,s.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,s.jsxs)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),I.password&&(0,s.jsxs)("div",{className:"mt-3 bg-gray-50 rounded-lg p-3",children:[(0,s.jsxs)("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:[e("validation.password.requirements"),":"]}),(0,s.jsxs)("ul",{className:"text-xs text-gray-600 space-y-1",children:[(0,s.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:I.password.length>=8?"text-green-600":"text-gray-400",children:I.password.length>=8?"\u2713":"\u25cb"}),(0,s.jsx)("span",{children:e("validation.password.minLength")})]}),(0,s.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:/[A-Z]/.test(I.password)?"text-green-600":"text-gray-400",children:/[A-Z]/.test(I.password)?"\u2713":"\u25cb"}),(0,s.jsx)("span",{children:e("validation.password.uppercase")})]}),(0,s.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:/[a-z]/.test(I.password)?"text-green-600":"text-gray-400",children:/[a-z]/.test(I.password)?"\u2713":"\u25cb"}),(0,s.jsx)("span",{children:e("validation.password.lowercase")})]}),(0,s.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:/\d/.test(I.password)?"text-green-600":"text-gray-400",children:/\d/.test(I.password)?"\u2713":"\u25cb"}),(0,s.jsx)("span",{children:e("validation.password.number")})]}),(0,s.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:/[!@#$%^&*(),.?":{}|<>]/.test(I.password)?"text-green-600":"text-gray-400",children:/[!@#$%^&*(),.?":{}|<>]/.test(I.password)?"\u2713":"\u25cb"}),(0,s.jsx)("span",{children:e("validation.password.special")})]})]})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e("profile.confirmPassword")," ",(0,s.jsx)("span",{className:"text-red-500",children:e("form.required")})]}),(0,s.jsxs)("div",{className:"mt-1 relative",children:[(0,s.jsx)("input",{type:B?"text":"password",required:!0,value:I.confirmPassword,onChange:e=>M("confirmPassword",e.target.value),className:"block w-full rounded-md border border-gray-300 px-3 py-2 pr-10 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:b}),(0,s.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>U(!B),disabled:b,children:B?(0,s.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,s.jsxs)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),I.password&&I.confirmPassword&&(0,s.jsx)("div",{className:"mt-2 text-xs",children:I.confirmPassword===I.password?(0,s.jsxs)("span",{className:"text-green-600 flex items-center",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e("validation.password.match")]}):(0,s.jsxs)("span",{className:"text-red-600 flex items-center",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e("validation.password.mismatch")]})})]}),(0,s.jsx)("button",{type:"button",onClick:async()=>{console.log("[InvitationAccept] D\xe9but handleFormSubmit");const a=(()=>{const t=[];if(I.password){const a=d(I.password,e);t.push(...a)}else t.push(e("validation.required.password"));if(I.confirmPassword||t.push(e("validation.required.confirmPassword")),I.password!==I.confirmPassword&&t.push(e("validation.password.mismatch")),I.firstName.trim()||t.push(e("validation.required.firstName")),I.lastName.trim()||t.push(e("validation.required.lastName")),I.email.trim()||t.push(e("validation.required.email")),I.country||t.push(e("validation.required.country")),!u(I.countryCode,I.areaCode,I.phoneNumber,I.country,S)&&(I.areaCode.trim()||I.phoneNumber.trim())){const a=[];I.countryCode.trim()||a.push(e("profile.countryCode")),I.areaCode.trim()||a.push(e("profile.areaCode")),I.phoneNumber.trim()||a.push(e("profile.phoneNumber")),a.length>0?t.push("".concat(e("validation.phone.incomplete"),": ").concat(a.join(", "))):t.push(e("validation.phone.invalid"))}return t})();if(a.length>0)return console.log("[InvitationAccept] Erreurs de validation:",a),void T(a);console.log("[InvitationAccept] Validation formulaire pass\xe9e"),N(!0),T([]);try{if(console.log("[InvitationAccept] Finalisation du compte via backend..."),!(null===v||void 0===v?void 0:v.accessToken))throw new Error(e("invitation.errors.missingAccessToken"));const a={access_token:v.accessToken,fullName:"".concat(I.firstName.trim()," ").concat(I.lastName.trim()),firstName:I.firstName.trim(),lastName:I.lastName.trim(),email:I.email.trim(),linkedinProfile:I.linkedinProfile.trim()||null,country:I.country,phone:I.countryCode&&I.areaCode&&I.phoneNumber?"".concat(I.countryCode," ").concat(I.areaCode,"-").concat(I.phoneNumber):null,company:I.companyName.trim()||e("common.notSpecified"),companyName:I.companyName.trim()||null,companyWebsite:I.companyWebsite.trim()||null,companyLinkedin:I.companyLinkedin.trim()||null,jobTitle:I.jobTitle.trim()||e("common.notSpecified"),password:I.password},n=[];if(a.firstName||n.push(e("validation.required.firstName")),a.lastName||n.push(e("validation.required.lastName")),a.fullName||n.push(e("validation.required.fullName")),a.email||n.push(e("validation.required.email")),a.country||n.push(e("validation.required.country")),a.password||n.push(e("validation.required.password")),a.access_token||n.push(e("validation.required.accessToken")),n.length>0)throw console.error("[InvitationAccept] Erreurs validation client:",n),new Error(e("validation.invalidData")+": "+n.join(", "));const o=i.env.NEXT_PUBLIC_API_URL||i.env.NEXT_PUBLIC_API_BASE_URL,r=await fetch("".concat(o,"/v1/auth/invitations/complete-profile"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok){let t;const a=r.headers.get("content-type");try{if(a&&a.includes("application/json"))t=await r.json();else{const e=await r.text();t={detail:e,rawResponse:e}}}catch(s){console.error("[InvitationAccept] Erreur parsing r\xe9ponse:",s),t={detail:"".concat(e("error.generic")," ").concat(r.status,": ").concat(r.statusText)}}let n=e("invitation.errors.profileCompletion");throw t.detail&&(Array.isArray(t.detail)?n=t.detail.map((e=>"string"===typeof e?e:e.msg?"".concat(e.loc?e.loc.join(".")+": ":"").concat(e.msg):e.message?e.message:JSON.stringify(e))).join(", "):"string"===typeof t.detail?n=t.detail:"object"===typeof t.detail&&(n=t.detail.message||JSON.stringify(t.detail))),k({success:!1,step:"completion",message:n,details:t}),new Error(n)}const l=await r.json();console.log("[InvitationAccept] Profil finalis\xe9 avec succ\xe8s:",l),h("success"),x(e("invitation.success.accountCreated")),k({success:!0,step:"completion",message:"".concat(e("invitation.success.welcome"),", ").concat(I.firstName)}),setTimeout((()=>{console.log("[InvitationAccept] Redirection vers chat"),t.push(l.redirect_url||"/chat")}),2e3)}catch(n){console.error("[InvitationAccept] Erreur finalisation compte:",n);let t=e("invitation.errors.accountCompletion");n instanceof Error?t=n.message:"string"===typeof n?t=n:n&&"object"===typeof n&&(t=n.message||n.detail||JSON.stringify(n)),T([t])}finally{N(!1)}},disabled:b||!(I.password&&I.confirmPassword&&I.password===I.confirmPassword&&0===d(I.password,e).length&&I.firstName.trim()&&I.lastName.trim()&&I.email.trim()&&I.country&&u(I.countryCode,I.areaCode,I.phoneNumber,I.country,S)),className:"w-full py-3 px-4 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:b?(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{children:e("invitation.creatingAccount")})]}):e("invitation.createAccount")})]})]}),("success"===l||"error"===l)&&w&&(0,s.jsx)(p,{result:w}),(0,s.jsx)("div",{className:"mt-8 pt-4 border-t border-gray-200",children:(0,s.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:[e("invitation.needHelp")," ",e("contact.supportEmail")]})})]})})]})}function g(){const{t:e}=(0,r.$G)();return(0,s.jsx)(n.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(m,{className:"w-16 h-16 mx-auto mb-4"}),(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:e("invitation.loadingInvitation")})]})}),children:(0,s.jsx)(h,{})})}},9939:function(e,t,a){"use strict";a.d(t,{Ik:function(){return o},L_:function(){return r},Yc:function(){return i},k$:function(){return n},mT:function(){return s}});const s=[{code:"fr",name:"French",nativeName:"Fran\xe7ais",region:"France",flag:"\ud83c\uddeb\ud83c\uddf7",dateFormat:"fr-FR"},{code:"en",name:"English",nativeName:"English",region:"United States",flag:"\ud83c\uddfa\ud83c\uddf8",dateFormat:"en-US"},{code:"es",name:"Spanish",nativeName:"Espa\xf1ol",region:"Spain",flag:"\ud83c\uddea\ud83c\uddf8",dateFormat:"es-ES"},{code:"pt",name:"Portuguese",nativeName:"Portugu\xeas",region:"Portugal",flag:"\ud83c\uddf5\ud83c\uddf9",dateFormat:"pt-PT"},{code:"de",name:"German",nativeName:"Deutsch",region:"Germany",flag:"\ud83c\udde9\ud83c\uddea",dateFormat:"de-DE"},{code:"nl",name:"Dutch",nativeName:"Nederlands",region:"Netherlands",flag:"\ud83c\uddf3\ud83c\uddf1",dateFormat:"nl-NL"},{code:"pl",name:"Polish",nativeName:"Polski",region:"Poland",flag:"\ud83c\uddf5\ud83c\uddf1",dateFormat:"pl-PL"},{code:"th",name:"Thai",nativeName:"\u0e44\u0e17\u0e22",region:"Thailand",flag:"\ud83c\uddf9\ud83c\udded",dateFormat:"th-TH"},{code:"hi",name:"Hindi",nativeName:"\u0939\u093f\u0902\u0926\u0940",region:"India",flag:"\ud83c\uddee\ud83c\uddf3",dateFormat:"hi-IN"},{code:"zh",name:"Chinese (Mandarin)",nativeName:"\u4e2d\u6587",region:"China",flag:"\ud83c\udde8\ud83c\uddf3",dateFormat:"zh-CN"}],n="en",o=e=>s.find((t=>t.code===e)),r=e=>s.some((t=>t.code===e)),i=()=>{var e;const t=navigator.language||(null===(e=navigator.languages)||void 0===e?void 0:e[0]);if(!t)return n;const a=t.split("-")[0].toLowerCase();return r(a)?a:n};new Set(["ar","he","fa","ur"])},7667:function(e,t,a){"use strict";a.d(t,{$G:function(){return x},Ik:function(){return o.Ik},mT:function(){return o.mT}});var s=a(2265),n=a(8225),o=a(9939);const r=(0,n.getSupabaseClient)();class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter((t=>t!==e))}}notify(){this.subscribers.forEach((e=>{try{e()}catch(t){console.error("Erreur notification i18n:",t)}}))}constructor(){this.subscribers=[]}}const l=i.getInstance(),c={},d=new Set;let u={},m=!0,p=null;const h=()=>{try{const t=localStorage.getItem("intelia-language");if(t){var e;const a=JSON.parse(t);return(null===a||void 0===a||null===(e=a.state)||void 0===e?void 0:e.currentLanguage)||o.k$}}catch(t){console.warn("Erreur lecture langue stock\xe9e:",t)}return o.k$};async function g(e){if(d.has(e))return console.warn("[i18n] Langue ".concat(e," en cache d'erreur, utilisation de ").concat(o.k$)),e===o.k$?{}:g(o.k$);if(c[e])return u=c[e],m=!1,p=e,l.notify(),c[e];try{const t=await fetch("/locales/".concat(e,".json"));if(!t.ok)throw new Error("HTTP ".concat(t.status,": Failed to load translations for ").concat(e));const a=await t.json();if(!a||"object"!==typeof a||0===Object.keys(a).length)throw new Error("Empty or invalid translations for ".concat(e));return c[e]=a,u=a,m=!1,p=e,l.notify(),console.log("[i18n] \u2705 Traductions charg\xe9es pour ".concat(e,": ").concat(Object.keys(a).length," cl\xe9s")),a}catch(t){return console.error("[i18n] \u274c Could not load translations for ".concat(e,":"),t),d.add(e),e!==o.k$?(console.warn("[i18n] \ud83d\udd04 Falling back to ".concat(o.k$)),g(o.k$)):(console.error("[i18n] \ud83d\udca5 Even ".concat(o.k$," failed to load, returning empty translations")),{})}}const x=()=>{const[e,t]=(0,s.useState)(o.k$),[a,n]=(0,s.useState)({}),[i,p]=(0,s.useState)(!0),[,x]=(0,s.useState)({});(0,s.useEffect)((()=>l.subscribe((()=>{x({})}))),[]),(0,s.useEffect)((()=>{(async()=>{try{var e,a;const s=h();if(s&&(0,o.L_)(s))return console.log("[i18n] \ud83d\udce6 Initialisation avec langue stock\xe9e: ".concat(s)),void t(s);const{data:{session:n}}=await r.auth.getSession(),i=null===n||void 0===n||null===(a=n.user)||void 0===a||null===(e=a.user_metadata)||void 0===e?void 0:e.language;if(i&&(0,o.L_)(i))return console.log("[i18n] \ud83d\udce6 Initialisation avec langue Supabase: ".concat(i)),void t(i);const l=(0,o.Yc)();console.log("[i18n] \ud83d\udce6 Initialisation avec langue navigateur: ".concat(l)),t(l)}catch(s){console.log("Erreur initialisation langue, utilisation navigateur");const e=(0,o.Yc)();t(e)}})()}),[]),(0,s.useEffect)((()=>{const a=setInterval((()=>{const a=h();a&&a!==e&&(0,o.L_)(a)&&(console.log("[i18n] \ud83d\udd04 Resynchronisation d\xe9tect\xe9e: ".concat(e," \u2192 ").concat(a)),t(a))}),1e3);return()=>{clearInterval(a)}}),[e]),(0,s.useEffect)((()=>{const a=a=>{if("intelia-language"===a.key&&a.newValue)try{var s;const n=JSON.parse(a.newValue),r=null===n||void 0===n||null===(s=n.state)||void 0===s?void 0:s.currentLanguage;r&&r!==e&&(0,o.L_)(r)&&(console.log("[i18n] \ud83d\udd04 Changement localStorage d\xe9tect\xe9: ".concat(e," \u2192 ").concat(r)),t(r))}catch(n){console.warn("Erreur parsing localStorage change:",n)}};return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}),[e]),(0,s.useEffect)((()=>{(async()=>{p(!0);try{const t=await g(e);n(t),p(!1)}catch(t){console.error("Erreur chargement traductions:",t),p(!1)}})()}),[e]),(0,s.useEffect)((()=>{const e=e=>{t(e.detail.language)};return window.addEventListener("languageChanged",e),()=>{window.removeEventListener("languageChanged",e)}}),[]);return{t:e=>{const t=Object.keys(a).length>0?a:u;return i&&m||!t[e]?e:t[e]},changeLanguage:async e=>{Object.keys(c).forEach((e=>{delete c[e]})),u={},m=!0,d.delete(e),t(e);try{const t={state:{currentLanguage:e}};localStorage.setItem("intelia-language",JSON.stringify(t)),console.log("[i18n] Langue sauvegard\xe9e:",e)}catch(a){console.warn("[i18n] Erreur sauvegarde langue:",a)}await g(e),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}}))},getCurrentLanguage:()=>e,formatDate:t=>{const a=(0,o.Ik)(e),s=(null===a||void 0===a?void 0:a.dateFormat)||"en-US";return t.toLocaleDateString(s,{day:"numeric",month:"long",year:"numeric"})},currentLanguage:e,loading:i}}},8225:function(e,t,a){"use strict";a.d(t,{getSupabaseClient:function(){return l}});var s=a(9296),n=a(257);const o=n.env.NEXT_PUBLIC_SUPABASE_URL,r=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!o||!r)throw new Error("\u274c Variables Supabase manquantes: NEXT_PUBLIC_SUPABASE_URL et NEXT_PUBLIC_SUPABASE_ANON_KEY requises");let i=null;const l=()=>(i?console.log("\u267b\ufe0f [Supabase] R\xe9utilisation instance singleton existante"):(console.log("\ud83d\ude80 [Supabase] Cr\xe9ation instance singleton"),i=(0,s.eI)(o,r,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce",storage:window.localStorage,storageKey:"intelia-expert-auth"},global:{headers:{"X-Client-Info":"intelia-expert-app"}},realtime:{params:{eventsPerSecond:10}}}),console.log("\u2705 [Supabase] Instance singleton cr\xe9\xe9e avec succ\xe8s")),i);l()}},function(e){e.O(0,[216,744],(function(){return t=2391,e(e.s=t);var t}));var t=e.O();_N_E=t}]);