(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2716:function(e,n,t){Promise.resolve().then(t.bind(t,1618)),Promise.resolve().then(t.bind(t,7882)),Promise.resolve().then(t.t.bind(t,911,23)),Promise.resolve().then(t.t.bind(t,7960,23)),Promise.resolve().then(t.bind(t,4174))},1618:function(e,n,t){"use strict";t.d(n,{AuthProvider:function(){return i}});var r=t(7437),o=t(2265),a=t(9272),c=t(8225);function i(e){let{children:n}=e;const{hasHydrated:t,setHasHydrated:i,checkAuth:s}=(0,a.useAuthStore)(),u=(0,o.useRef)(!0),l=(0,o.useRef)(null),g=(0,o.useRef)(null),d=(0,o.useRef)(!1),f=(0,o.useRef)(null),h=async()=>{if(u.current&&!d.current)try{await s()}catch(e){u.current&&!d.current&&console.error("[AuthProvider] Erreur checkAuth s\xe9curis\xe9:",e)}else console.log("[AuthProvider] checkAuth ignor\xe9 - composant d\xe9mont\xe9 ou d\xe9connexion en cours")};return(0,o.useEffect)((()=>{const e=sessionStorage.getItem("recent-logout");if(e){const n=parseInt(e);if(Date.now()-n<5e3)return void console.log("[AuthProvider] Initialisation diff\xe9r\xe9e - d\xe9connexion r\xe9cente")}t||!u.current||d.current||(i(!0),console.log("[AuthProvider] Store hydrat\xe9 - AUCUNE initialisation automatique"))}),[t,i]),(0,o.useEffect)((()=>{let e=!1;const n=(0,c.getSupabaseClient)(),{data:{subscription:t}}=n.auth.onAuthStateChange((async(n,t)=>{if(console.log("\ud83d\udd25 [DEBUG-AUTH] === \xc9V\xc9NEMENT SUPABASE ==="),console.log("\ud83d\udd25 [DEBUG-AUTH] Event:",n,"Session:",!!t),console.log("\ud83d\udd25 [DEBUG-AUTH] isMountedRef:",u.current),console.log("\ud83d\udd25 [DEBUG-AUTH] isLoggingOutRef:",d.current),console.log("\ud83d\udd25 [DEBUG-AUTH] isCancelled:",e),e||!u.current||d.current)console.log("\ud83d\udd25 [DEBUG-AUTH] \xc9V\xc9NEMENT IGNOR\xc9 - composant d\xe9mont\xe9 ou d\xe9connexion active");else{console.log("\ud83d\udd25 [DEBUG-AUTH] Traitement de l'\xe9v\xe9nement:",n);try{switch(n){case"INITIAL_SESSION":console.log("\ud83d\udd25 [DEBUG-AUTH] INITIAL_SESSION ignor\xe9");break;case"SIGNED_IN":console.log("\ud83d\udd25 [DEBUG-AUTH] SIGNED_IN - v\xe9rification \xe9tat..."),d.current?console.log("\ud83d\udd25 [DEBUG-AUTH] SIGNED_IN ignor\xe9 - d\xe9connexion en cours"):(console.log("\ud83d\udd25 [DEBUG-AUTH] Utilisateur connect\xe9 - checkAuth"),await h());break;case"SIGNED_OUT":console.log("\ud83d\udd25 [DEBUG-AUTH] SIGNED_OUT - NOUVELLE STRAT\xc9GIE SANS setState"),d.current=!0,console.log("\ud83d\udd25 [DEBUG-AUTH] SIGNED_OUT trait\xe9 - PAS de setState, juste flag activ\xe9"),f.current&&clearTimeout(f.current),f.current=setTimeout((()=>{console.log("\ud83d\udd50 [DEBUG-TIMEOUT-AUTH] Execution timeout 5s - isMounted:",u.current),u.current?console.log("\ud83d\udd25 [DEBUG-AUTH] Fin du blocage apr\xe8s 5s"):console.log("\u26a0\ufe0f [DEBUG-TIMEOUT-AUTH] Timeout 5s ignor\xe9 - AuthProvider d\xe9mont\xe9")}),5e3);break;case"TOKEN_REFRESHED":d.current?console.log("\ud83d\udd25 [DEBUG-AUTH] TOKEN_REFRESHED ignor\xe9 - d\xe9connexion en cours"):(console.log("\ud83d\udd25 [DEBUG-AUTH] Token rafra\xeechi"),await h());break;case"USER_UPDATED":d.current?console.log("\ud83d\udd25 [DEBUG-AUTH] USER_UPDATED ignor\xe9 - d\xe9connexion en cours"):(console.log("\ud83d\udd25 [DEBUG-AUTH] Utilisateur mis \xe0 jour"),await h());break;default:console.log("\ud83d\udd25 [DEBUG-AUTH] \xc9v\xe9nement non g\xe9r\xe9:",n)}}catch(r){u.current&&!d.current&&console.error("\ud83d\udd25 [DEBUG-AUTH] Erreur traitement \xe9v\xe9nement:",n,r)}}}));l.current=t;const r=setInterval((async()=>{if(!e&&u.current&&!d.current)try{const n=(0,c.getSupabaseClient)(),{data:{session:t},error:r}=await n.auth.getSession();if(r)return void console.warn("[AuthProvider] Erreur v\xe9rification session:",r);if(!u.current||e||d.current)return;const o=a.useAuthStore.getState().isAuthenticated;o!==!!t&&(console.log("[AuthProvider] Synchronisation \xe9tat auth n\xe9cessaire"),await h())}catch(n){u.current&&!d.current&&console.warn("[AuthProvider] Erreur v\xe9rification p\xe9riodique:",n)}}),6e4);return g.current=r,()=>{if(e=!0,l.current)try{l.current.unsubscribe()}catch(n){console.warn("[AuthProvider] Erreur unsubscribe:",n)}g.current&&clearInterval(g.current),f.current&&clearTimeout(f.current),console.log("[AuthProvider] Nettoyage subscription et interval")}}),[s]),(0,o.useEffect)((()=>(u.current=!0,d.current=!1,()=>{if(console.log("[AuthProvider] D\xe9montage - nettoyage des refs"),u.current=!1,d.current=!0,l.current){try{l.current.unsubscribe()}catch(e){console.warn("[AuthProvider] Erreur final unsubscribe:",e)}l.current=null}g.current&&(clearInterval(g.current),g.current=null),f.current&&(clearTimeout(f.current),f.current=null)})),[]),(0,r.jsx)(r.Fragment,{children:n})}},7882:function(e,n,t){"use strict";t.d(n,{LanguageProvider:function(){return i}});var r=t(7437),o=t(2265),a=t(7667),c=t(9939);function i(e){let{children:n}=e;const{changeLanguage:t,currentLanguage:i}=(0,a.$G)(),s=(0,o.useRef)(!1),u=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{if(s.current||u.current)return;u.current=!0;(async()=>{try{console.log("[LanguageProvider] Synchronisation avec i18n, langue actuelle:",i),setTimeout((()=>{document.documentElement.classList.add("language-ready"),console.log("[LanguageProvider] \ud83c\udfaf Interface pr\xeate - Flash \xe9vit\xe9")}),200)}catch(e){console.error("[LanguageProvider] Erreur initialisation:",e),document.documentElement.classList.add("language-ready")}finally{s.current=!0,u.current=!1}})()}),[i]),(0,o.useEffect)((()=>{const e=e=>{if("intelia-language"===e.key&&e.newValue)try{var n;const r=JSON.parse(e.newValue),o=null===r||void 0===r||null===(n=r.state)||void 0===n?void 0:n.currentLanguage;o&&(0,c.L_)(o)&&o!==i&&(document.documentElement.classList.remove("language-ready"),t(o).then((()=>{setTimeout((()=>{document.documentElement.classList.add("language-ready")}),100)})),console.log("[LanguageProvider] \ud83d\udd04 Changement d\xe9tect\xe9:",o))}catch(r){console.warn("[LanguageProvider] Erreur storage change:",r)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)}),[t,i]),(0,o.useEffect)((()=>{const e=setTimeout((()=>{document.documentElement.classList.contains("language-ready")||(console.warn("[LanguageProvider] \u26a0\ufe0f Timeout s\xe9curit\xe9 atteint - Affichage forc\xe9"),document.documentElement.classList.add("language-ready"))}),3e3);return()=>clearTimeout(e)}),[]),(0,r.jsx)(r.Fragment,{children:n})}},9939:function(e,n,t){"use strict";t.d(n,{Ik:function(){return a},L_:function(){return c},Yc:function(){return i},k$:function(){return o},mT:function(){return r}});const r=[{code:"fr",name:"French",nativeName:"Fran\xe7ais",region:"France",flag:"\ud83c\uddeb\ud83c\uddf7",dateFormat:"fr-FR"},{code:"en",name:"English",nativeName:"English",region:"United States",flag:"\ud83c\uddfa\ud83c\uddf8",dateFormat:"en-US"},{code:"es",name:"Spanish",nativeName:"Espa\xf1ol",region:"Spain",flag:"\ud83c\uddea\ud83c\uddf8",dateFormat:"es-ES"},{code:"pt",name:"Portuguese",nativeName:"Portugu\xeas",region:"Portugal",flag:"\ud83c\uddf5\ud83c\uddf9",dateFormat:"pt-PT"},{code:"de",name:"German",nativeName:"Deutsch",region:"Germany",flag:"\ud83c\udde9\ud83c\uddea",dateFormat:"de-DE"},{code:"nl",name:"Dutch",nativeName:"Nederlands",region:"Netherlands",flag:"\ud83c\uddf3\ud83c\uddf1",dateFormat:"nl-NL"},{code:"pl",name:"Polish",nativeName:"Polski",region:"Poland",flag:"\ud83c\uddf5\ud83c\uddf1",dateFormat:"pl-PL"},{code:"th",name:"Thai",nativeName:"\u0e44\u0e17\u0e22",region:"Thailand",flag:"\ud83c\uddf9\ud83c\udded",dateFormat:"th-TH"},{code:"hi",name:"Hindi",nativeName:"\u0939\u093f\u0902\u0926\u0940",region:"India",flag:"\ud83c\uddee\ud83c\uddf3",dateFormat:"hi-IN"},{code:"zh",name:"Chinese (Mandarin)",nativeName:"\u4e2d\u6587",region:"China",flag:"\ud83c\udde8\ud83c\uddf3",dateFormat:"zh-CN"}],o="en",a=e=>r.find((n=>n.code===e)),c=e=>r.some((n=>n.code===e)),i=()=>{var e;const n=navigator.language||(null===(e=navigator.languages)||void 0===e?void 0:e[0]);if(!n)return o;const t=n.split("-")[0].toLowerCase();return c(t)?t:o};new Set(["ar","he","fa","ur"])},7667:function(e,n,t){"use strict";t.d(n,{$G:function(){return v},Ik:function(){return a.Ik},mT:function(){return a.mT}});var r=t(2265),o=t(8225),a=t(9939);const c=(0,o.getSupabaseClient)();class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter((n=>n!==e))}}notify(){this.subscribers.forEach((e=>{try{e()}catch(n){console.error("Erreur notification i18n:",n)}}))}constructor(){this.subscribers=[]}}const s=i.getInstance(),u={},l=new Set;let g={},d=!0,f=null;const h=()=>{try{const n=localStorage.getItem("intelia-language");if(n){var e;const t=JSON.parse(n);return(null===t||void 0===t||null===(e=t.state)||void 0===e?void 0:e.currentLanguage)||a.k$}}catch(n){console.warn("Erreur lecture langue stock\xe9e:",n)}return a.k$};async function E(e){if(l.has(e))return console.warn("[i18n] Langue ".concat(e," en cache d'erreur, utilisation de ").concat(a.k$)),e===a.k$?{}:E(a.k$);if(u[e])return g=u[e],d=!1,f=e,s.notify(),u[e];try{const n=await fetch("/locales/".concat(e,".json"));if(!n.ok)throw new Error("HTTP ".concat(n.status,": Failed to load translations for ").concat(e));const t=await n.json();if(!t||"object"!==typeof t||0===Object.keys(t).length)throw new Error("Empty or invalid translations for ".concat(e));return u[e]=t,g=t,d=!1,f=e,s.notify(),console.log("[i18n] \u2705 Traductions charg\xe9es pour ".concat(e,": ").concat(Object.keys(t).length," cl\xe9s")),t}catch(n){return console.error("[i18n] \u274c Could not load translations for ".concat(e,":"),n),l.add(e),e!==a.k$?(console.warn("[i18n] \ud83d\udd04 Falling back to ".concat(a.k$)),E(a.k$)):(console.error("[i18n] \ud83d\udca5 Even ".concat(a.k$," failed to load, returning empty translations")),{})}}const v=()=>{const[e,n]=(0,r.useState)(a.k$),[t,o]=(0,r.useState)({}),[i,f]=(0,r.useState)(!0),[,v]=(0,r.useState)({});(0,r.useEffect)((()=>s.subscribe((()=>{v({})}))),[]),(0,r.useEffect)((()=>{(async()=>{try{var e,t;const r=h();if(r&&(0,a.L_)(r))return console.log("[i18n] \ud83d\udce6 Initialisation avec langue stock\xe9e: ".concat(r)),void n(r);const{data:{session:o}}=await c.auth.getSession(),i=null===o||void 0===o||null===(t=o.user)||void 0===t||null===(e=t.user_metadata)||void 0===e?void 0:e.language;if(i&&(0,a.L_)(i))return console.log("[i18n] \ud83d\udce6 Initialisation avec langue Supabase: ".concat(i)),void n(i);const s=(0,a.Yc)();console.log("[i18n] \ud83d\udce6 Initialisation avec langue navigateur: ".concat(s)),n(s)}catch(r){console.log("Erreur initialisation langue, utilisation navigateur");const e=(0,a.Yc)();n(e)}})()}),[]),(0,r.useEffect)((()=>{const t=setInterval((()=>{const t=h();t&&t!==e&&(0,a.L_)(t)&&(console.log("[i18n] \ud83d\udd04 Resynchronisation d\xe9tect\xe9e: ".concat(e," \u2192 ").concat(t)),n(t))}),1e3);return()=>{clearInterval(t)}}),[e]),(0,r.useEffect)((()=>{const t=t=>{if("intelia-language"===t.key&&t.newValue)try{var r;const o=JSON.parse(t.newValue),c=null===o||void 0===o||null===(r=o.state)||void 0===r?void 0:r.currentLanguage;c&&c!==e&&(0,a.L_)(c)&&(console.log("[i18n] \ud83d\udd04 Changement localStorage d\xe9tect\xe9: ".concat(e," \u2192 ").concat(c)),n(c))}catch(o){console.warn("Erreur parsing localStorage change:",o)}};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}}),[e]),(0,r.useEffect)((()=>{(async()=>{f(!0);try{const n=await E(e);o(n),f(!1)}catch(n){console.error("Erreur chargement traductions:",n),f(!1)}})()}),[e]),(0,r.useEffect)((()=>{const e=e=>{n(e.detail.language)};return window.addEventListener("languageChanged",e),()=>{window.removeEventListener("languageChanged",e)}}),[]);return{t:e=>{const n=Object.keys(t).length>0?t:g;return i&&d||!n[e]?e:n[e]},changeLanguage:async e=>{Object.keys(u).forEach((e=>{delete u[e]})),g={},d=!0,l.delete(e),n(e);try{const n={state:{currentLanguage:e}};localStorage.setItem("intelia-language",JSON.stringify(n)),console.log("[i18n] Langue sauvegard\xe9e:",e)}catch(t){console.warn("[i18n] Erreur sauvegarde langue:",t)}await E(e),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}}))},getCurrentLanguage:()=>e,formatDate:n=>{const t=(0,a.Ik)(e),r=(null===t||void 0===t?void 0:t.dateFormat)||"en-US";return n.toLocaleDateString(r,{day:"numeric",month:"long",year:"numeric"})},currentLanguage:e,loading:i}}},7960:function(){}},function(e){e.O(0,[944,216,286,744],(function(){return n=2716,e(e.s=n);var n}));var n=e.O();_N_E=n}]);