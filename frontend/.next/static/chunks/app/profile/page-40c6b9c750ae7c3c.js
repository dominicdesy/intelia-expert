(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{4976:function(e,s,r){Promise.resolve().then(r.bind(r,5144))},5144:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return y}});var t=r(7437),a=r(2265),n=r(9376),l=r(9272),i=r(7648);const o=e=>{if(!(null===e||void 0===e?void 0:e.name))return"Utilisateur";const s=String(e.name).trim();return s.length>=2?s:"Utilisateur"},c=e=>(null===e||void 0===e?void 0:e.email)?String(e.email):"",d=e=>{const s=null===e||void 0===e?void 0:e.user_type;return"string"===typeof s&&s?s:"producer"},u=e=>{if(!(null===e||void 0===e?void 0:e.created_at))return null;try{const s=new Date(e.created_at);return isNaN(s.getTime())?null:s}catch(s){return null}},m=e=>{switch(e){case"professional":return"bg-blue-100 text-blue-800";case"producer":return"bg-green-100 text-green-800";case"super_admin":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},x=e=>{switch(e){case"professional":return"Professionnel";case"producer":return"Producteur";case"super_admin":return"Super Admin";default:return"Utilisateur"}},p=e=>{let{className:s}=e;return(0,t.jsx)("svg",{className:s,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})})},h=e=>{let{className:s}=e;return(0,t.jsxs)("svg",{className:s,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})},b=e=>{let{className:s}=e;return(0,t.jsx)("svg",{className:s,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.623 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"})})},g=e=>{let{className:s}=e;return(0,t.jsx)("svg",{className:s,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})})},f=e=>{if(!e||"string"!==typeof e)return"U";const s=e.trim();return 0===s.length?"U":s.split(" ").map((e=>e[0])).join("").toUpperCase().slice(0,2)||"U"};function j(){const e=(0,n.useRouter)(),s=(0,n.useSearchParams)(),{user:r,isLoading:j}=(0,l.useAuthStore)(),{updateProfile:y,exportUserData:v,deleteUserData:N}=(0,l.useAuthStore)(),[w,k]=(0,a.useState)("profile"),[C,L]=(0,a.useState)({fullName:"",email:"",userType:"producer"}),[S,T]=(0,a.useState)(""),[E,U]=(0,a.useState)(""),[P,_]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(!r)return void e.push("/auth/login");L({fullName:o(r),email:c(r),userType:d(r)});const t=s.get("tab");t&&["profile","settings","privacy"].includes(t)&&k(t)}),[r,e,s]);const M=e=>{const{name:s,value:r}=e.target;L((e=>({...e,[s]:r}))),T(""),U("")};if(!r)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const O=o(r),R=c(r),z=d(r),A=u(r),D=f(O),B=[{id:"profile",label:"Profil",icon:p},{id:"settings",label:"Param\xe8tres",icon:h},{id:"privacy",label:"Confidentialit\xe9",icon:b}];return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"flex items-center justify-between h-16",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(i.default,{href:"/chat",className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,t.jsx)(g,{className:"w-5 h-5 mr-2"}),"Retour au chat"]}),(0,t.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,t.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Mon profil"})]})})})}),(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"px-6 py-8 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-2xl",children:D}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:O}),(0,t.jsx)("p",{className:"text-gray-600",children:R}),(0,t.jsx)("div",{className:"inline-block px-3 py-1 rounded-full text-sm font-medium mt-2 ".concat(m(z)),children:x(z)})]})]})}),(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsx)("nav",{className:"flex space-x-8 px-6",children:B.map((e=>(0,t.jsx)("button",{onClick:()=>k(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(w===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(e.icon,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:e.label})]})},e.id)))})}),(0,t.jsxs)("div",{className:"p-6",children:[S&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg",children:S}),E&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:E}),"profile"===w&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations personnelles"}),(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),T(""),U("");const s=C.fullName.trim();if(!s||s.length<2)T("Le nom complet doit contenir au moins 2 caract\xe8res");else if(["producer","professional"].includes(C.userType))try{const e={name:s,user_type:C.userType};await y(e),U("Profil mis \xe0 jour avec succ\xe8s")}catch(S){T(S.message||"Erreur lors de la mise \xe0 jour")}else T("Type de compte invalide")},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom complet"}),(0,t.jsx)("input",{type:"text",id:"fullName",name:"fullName",value:C.fullName||"",onChange:M,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:C.email||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",disabled:!0}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"L'email ne peut pas \xeatre modifi\xe9 pour des raisons de s\xe9curit\xe9"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"userType",className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de compte"}),(0,t.jsxs)("select",{id:"userType",name:"userType",value:C.userType,onChange:M,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"producer",children:"Producteur agricole"}),(0,t.jsx)("option",{value:"professional",children:"Professionnel sant\xe9 animale"})]})]}),(0,t.jsx)("button",{type:"submit",disabled:j,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:j?"Enregistrement...":"Enregistrer les modifications"})]})]})}),"settings"===w&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Param\xe8tres du compte"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:"Langue de l'interface"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Choisissez votre langue pr\xe9f\xe9r\xe9e"})]}),(0,t.jsxs)("select",{className:"px-3 py-2 border border-gray-300 rounded-lg",children:[(0,t.jsx)("option",{value:"fr",children:"Fran\xe7ais"}),(0,t.jsx)("option",{value:"en",children:"English"}),(0,t.jsx)("option",{value:"es",children:"Espa\xf1ol"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:"Notifications"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Recevoir des notifications par email"})]}),(0,t.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 rounded"})]})]})]})}),"privacy"===w&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Gestion des donn\xe9es"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Exporter mes donn\xe9es"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"T\xe9l\xe9chargez toutes vos donn\xe9es personnelles au format JSON."}),(0,t.jsx)("button",{onClick:async()=>{try{const e=await v(),s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.download="intelia-expert-data-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r),U("Donn\xe9es export\xe9es avec succ\xe8s")}catch(S){T(S.message||"Erreur lors de l'export")}},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"T\xe9l\xe9charger mes donn\xe9es"})]}),(0,t.jsxs)("div",{className:"p-4 border border-red-200 rounded-lg bg-red-50",children:[(0,t.jsx)("h4",{className:"font-medium text-red-900 mb-2",children:"Supprimer mon compte"}),(0,t.jsx)("p",{className:"text-sm text-red-700 mb-4",children:"Cette action est irr\xe9versible. Toutes vos donn\xe9es seront d\xe9finitivement supprim\xe9es."}),P?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-red-800",children:"\xcates-vous vraiment s\xfbr ? Cette action ne peut pas \xeatre annul\xe9e."}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:()=>_(!1),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"}),(0,t.jsx)("button",{onClick:async()=>{if(P)try{await N(),e.push("/")}catch(S){T(S.message||"Erreur lors de la suppression"),_(!1)}else _(!0)},disabled:j,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors",children:j?"Suppression...":"Oui, supprimer d\xe9finitivement"})]})]}):(0,t.jsx)("button",{onClick:()=>_(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Supprimer mon compte"})]}),(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Politique de conservation"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Vos donn\xe9es de conversation sont automatiquement supprim\xe9es apr\xe8s 30 jours. Membre depuis : ",A?A.toLocaleDateString("fr-FR"):"N/A"]})]})]})]})})]})]})})]})}function y(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Chargement du profil..."})]})}),children:(0,t.jsx)(j,{})})}}},function(e){e.O(0,[216,286,744],(function(){return s=4976,e(e.s=s);var s}));var s=e.O();_N_E=s}]);