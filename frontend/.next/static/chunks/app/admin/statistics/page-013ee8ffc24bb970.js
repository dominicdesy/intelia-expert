(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{2241:function(e,s,t){Promise.resolve().then(t.bind(t,9470))},9470:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x}});var a=t(7437),r=t(2265),i=t(9272),n=t(8225);const l=e=>{let{systemStats:s,usageStats:t,billingStats:r,performanceStats:i,cacheStatus:n=null,isLoading:l=!1}=e;var c,o,d,x,m,u,h,p,g,b,v,j,f,y;return l?(0,a.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chargement du tableau de bord..."})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4 relative",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Utilisateurs Actifs"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(null===t||void 0===t?void 0:t.unique_users)||0}),(null===n||void 0===n?void 0:n.is_available)&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full",title:"Donn\xe9es en cache"})})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4 relative",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Questions ce mois"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(null===t||void 0===t?void 0:t.questions_this_month)||0}),(null===n||void 0===n?void 0:n.is_available)&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4 relative",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Revenus Totaux"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:["$",(null===r||void 0===r?void 0:r.total_revenue)||0]}),(null===n||void 0===n?void 0:n.is_available)&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4 relative",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Temps de R\xe9ponse"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[(null===i||void 0===i?void 0:i.avg_response_time)||0,"s"]}),n?(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(n.is_available?"bg-green-500":"bg-red-500")})}):(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Mode standard"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Sources des R\xe9ponses"})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"space-y-3",children:(null===t||void 0===t?void 0:t.source_distribution)&&Object.entries(t.source_distribution).map((e=>{let[s,r]=e;const i=Object.values(t.source_distribution).reduce(((e,s)=>e+s),0),n=i>0?(r/i*100).toFixed(1):0,l=e=>{switch(e){case"rag_retriever":return"bg-blue-500";case"openai_fallback":return"bg-purple-500";case"perfstore":return"bg-green-500";default:return"bg-gray-400"}};return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 ".concat(l(s))}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:(e=>{switch(e){case"rag_retriever":return"RAG Retriever";case"openai_fallback":return"OpenAI Fallback";case"perfstore":return"Performance Store";default:return e}})(s)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-16 bg-gray-200 h-2",children:(0,a.jsx)("div",{className:"h-2 ".concat(l(s)," transition-all duration-300"),style:{width:"".concat(n,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900 w-12 text-right",children:r})]})]},s)}))})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Sant\xe9 du Syst\xe8me"})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Uptime"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[(null===s||void 0===s||null===(o=s.system_health)||void 0===o||null===(c=o.uptime_hours)||void 0===c?void 0:c.toFixed(1))||"0.0","h"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Taux d'erreur"}),(0,a.jsxs)("span",{className:"text-sm font-medium ".concat(((null===s||void 0===s||null===(d=s.system_health)||void 0===d?void 0:d.error_rate)||0)<5?"text-green-600":"text-red-600"),children:[(null===s||void 0===s||null===(m=s.system_health)||void 0===m||null===(x=m.error_rate)||void 0===x?void 0:x.toFixed(1))||"0.0","%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Taux de succ\xe8s"}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("span",{className:"text-sm font-medium text-green-600",children:[(null===i||void 0===i||null===(u=i.cache_hit_rate)||void 0===u?void 0:u.toFixed(1))||"0.0","%"]})})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-gray-200",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Services RAG"}),(0,a.jsx)("div",{className:"space-y-2",children:(null===s||void 0===s||null===(h=s.system_health)||void 0===h?void 0:h.rag_status)&&Object.entries(s.system_health.rag_status).map((e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-xs text-gray-600 capitalize",children:s}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 ".concat(t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t?"Actif":"Inactif"})]},s)}))})]})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Utilisateurs les Plus Actifs"})}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Utilisateur"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Questions"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Plan"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[(null===r||void 0===r||null===(p=r.top_users)||void 0===p?void 0:p.slice(0,5).map(((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 max-w-48",children:(0,a.jsx)("div",{className:"truncate",title:e.email||"Email non disponible",children:e.email||"Utilisateur anonyme"})}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-600",children:e.question_count||0}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium ".concat("enterprise"===e.plan?"bg-purple-100 text-purple-800":"professional"===e.plan?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.plan||"non d\xe9fini"})})]},e.email||"user-".concat(s)))))||[],(!(null===r||void 0===r?void 0:r.top_users)||0===r.top_users.length)&&(0,a.jsx)("tr",{children:(0,a.jsxs)("td",{colSpan:3,className:"px-4 py-8 text-center text-gray-500",children:[(0,a.jsx)("div",{className:"text-gray-400 text-2xl mb-2",children:"\ud83d\udc65"}),(0,a.jsx)("p",{children:"Aucune donn\xe9e utilisateur disponible"})]})})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"R\xe9partition des Plans"})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"space-y-3",children:(null===r||void 0===r?void 0:r.plans)&&Object.entries(r.plans).map((e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 capitalize",children:s}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:[t.user_count," utilisateurs"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold text-gray-900",children:["$",t.revenue]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"revenus"})]})]},s)}))})})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Co\xfbts et Performance"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-white border border-gray-200",children:[(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["$",(null===i||void 0===i||null===(g=i.openai_costs)||void 0===g?void 0:g.toFixed(2))||"0.00"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Co\xfbts OpenAI"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white border border-gray-200",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:(null===i||void 0===i?void 0:i.error_count)||0}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Erreurs"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white border border-gray-200",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:(null===s||void 0===s||null===(b=s.system_health)||void 0===b?void 0:b.total_requests)||0}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Requ\xeates Totales"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white border border-gray-200",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:(null===t||void 0===t?void 0:t.questions_today)||0}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Questions Aujourd'hui"})]})]}),i&&(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"M\xe9triques de Performance D\xe9taill\xe9es"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("span",{className:"text-sm font-medium text-gray-800",children:"Temps M\xe9dian"})}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-blue-900",children:[(null===(v=i.median_response_time)||void 0===v?void 0:v.toFixed(1))||"0.0","s"]}),(0,a.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"Temps de r\xe9ponse m\xe9dian"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Min/Max"})}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-green-900",children:[(null===(j=i.min_response_time)||void 0===j?void 0:j.toFixed(1))||"0.0","s / ",(null===(f=i.max_response_time)||void 0===f?void 0:f.toFixed(1))||"0.0","s"]}),(0,a.jsx)("p",{className:"text-xs text-green-700 mt-1",children:"Temps min et max"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("span",{className:"text-sm font-medium text-indigo-800",children:"\xc9chantillons"})}),(0,a.jsx)("p",{className:"text-lg font-semibold text-indigo-900",children:i.response_time_count||0}),(0,a.jsx)("p",{className:"text-xs text-indigo-700 mt-1",children:"Nombre de mesures"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("span",{className:"text-sm font-medium text-purple-800",children:"Cache Hit"})}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-purple-900",children:[(null===(y=i.cache_hit_rate)||void 0===y?void 0:y.toFixed(1))||"0.0","%"]}),(0,a.jsx)("p",{className:"text-xs text-purple-700 mt-1",children:"Taux de succ\xe8s cache"})]})]}),i.avg_response_time&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Performance globale du syst\xe8me"}),(0,a.jsx)("span",{children:i.avg_response_time<2?"Excellent":i.avg_response_time<5?"Bon":i.avg_response_time<10?"Acceptable":"\xc0 am\xe9liorer"})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-2 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat(i.avg_response_time<2?"bg-green-500":i.avg_response_time<5?"bg-blue-500":i.avg_response_time<10?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.min(100,Math.max(10,100-5*i.avg_response_time)),"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,a.jsx)("span",{children:"Rapide (<2s)"}),(0,a.jsx)("span",{children:"Lent (>10s)"})]})]})]})]})]})]})},c=e=>{let{questionLogs:s,questionFilters:t,setQuestionFilters:r,selectedTimeRange:i,setSelectedTimeRange:n,currentPage:l,setCurrentPage:c,questionsPerPage:o,setSelectedQuestion:d,isLoading:x=!1,totalQuestions:m=0,cacheStatus:u=null}=e;const h=e=>{switch(e){case"rag":return"text-blue-600 bg-blue-100";case"openai_fallback":return"text-purple-600 bg-purple-100";case"table_lookup":return"text-green-600 bg-green-100";case"validation_rejected":return"text-red-600 bg-red-100";case"quota_exceeded":return"text-orange-600 bg-orange-100";default:return"text-gray-600 bg-gray-100"}},p=e=>{switch(e){case"rag":return"RAG";case"openai_fallback":return"OpenAI";case"table_lookup":return"Table";case"validation_rejected":return"Rejet\xe9";case"quota_exceeded":return"Quota";default:return"Inconnu"}},g=e=>1===e?"\ud83d\udc4d":-1===e?"\ud83d\udc4e":"\u2753",b=()=>{try{const e=window.confirm("\ud83e\udd14 Choix de l'export :\n\n"+"\u2022 OUI = Exporter TOUTES les ".concat(m," questions de la base\n")+"\u2022 NON = Exporter seulement les ".concat(v.length," questions affich\xe9es\n\n")+"Voulez-vous exporter TOUTES les questions ?");let t,a;if(e){if(t=s,a="TOUTES",s.length<m){if(!window.confirm("\u26a0\ufe0f Attention :\n\n"+"\u2022 Total questions dans la base : ".concat(m,"\n")+"\u2022 Questions actuellement charg\xe9es : ".concat(s.length,"\n\n")+"L'export contiendra seulement les ".concat(s.length," questions charg\xe9es.\n\n")+"Continuer l'export ?"))return}}else t=v,a="FILTR\xc9ES";if(0===t.length)return void alert("\u274c Aucune question \xe0 exporter dans la s\xe9lection");const r=(e=>{const s=new Map;e.forEach((e=>{const t=e.session_id;s.has(t)||s.set(t,[]),s.get(t).push(e)}));const t=[];return s.forEach(((e,s)=>{e.sort(((e,s)=>new Date(e.timestamp).getTime()-new Date(s.timestamp).getTime()));const a=e[0],r=e[e.length-1];t.push({session_id:s,user_email:a.user_email,user_name:a.user_name,start_time:a.timestamp,end_time:r.timestamp,total_questions:e.length,questions:e.map((e=>e.question)),responses:e.map((e=>e.response)),sources:e.map((e=>p(e.response_source))),confidence_scores:e.map((e=>e.confidence_score)),response_times:e.map((e=>e.response_time)),feedback_scores:e.map((e=>e.feedback)),feedback_comments:e.map((e=>e.feedback_comment))})})),t})(t),i=Math.max(...r.map((e=>e.total_questions)));console.log("\ud83d\udcca Export CSV ".concat(a," de ").concat(r.length," conversations, max ").concat(i," questions"));const n=["N\xb0","Session ID","Utilisateur","Email","D\xe9but","Fin","Nb Questions","Dur\xe9e (min)"];for(let s=0;s<i;s++)n.push("Q".concat(s+1),"R".concat(s+1),"Source".concat(s+1),"Confiance".concat(s+1),"Temps".concat(s+1),"Feedback".concat(s+1),"Commentaire".concat(s+1));const l=e=>{if(null===e||void 0===e)return"";const s=String(e);return s.includes('"')||s.includes(",")||s.includes("\n")||s.includes("\r")?'"'.concat(s.replace(/"/g,'""'),'"'):s};let c=n.map(l).join(",")+"\n";r.forEach(((e,s)=>{const t=[s+1,e.session_id.substring(0,12)+"...",e.user_name,e.user_email,new Date(e.start_time).toLocaleString("fr-FR"),new Date(e.end_time).toLocaleString("fr-FR"),e.total_questions,Math.max(1,Math.round((new Date(e.end_time).getTime()-new Date(e.start_time).getTime())/6e4))];for(let a=0;a<i;a++)t.push(e.questions[a]||"",e.responses[a]||"",e.sources[a]||"",e.confidence_scores[a]?"".concat((100*e.confidence_scores[a]).toFixed(1),"%"):"",e.response_times[a]?"".concat(e.response_times[a],"s"):"",null!==e.feedback_scores[a]?1===e.feedback_scores[a]?"Positif":"N\xe9gatif":"",e.feedback_comments[a]||"");c+=t.map(l).join(",")+"\n"}));const o="conversations_".concat(e?"TOUTES":"FILTREES","_").concat((new Date).toISOString().split("T")[0],"_").concat(Date.now(),".csv"),d=new Blob(["\ufeff"+c],{type:"text/csv;charset=utf-8"}),x=window.URL.createObjectURL(d),u=document.createElement("a");u.href=x,u.download=o,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(x),console.log("\u2705 Export CSV conversations ".concat(a," r\xe9ussi: ").concat(o));const h=new Set(t.map((e=>e.user_email))).size,g="\u2705 Export CSV ".concat(a," r\xe9ussi !\n\n\ud83d\udcca Scope: ").concat(a," les questions\n\u2022 ").concat(r.length," conversations (lignes)\n\u2022 ").concat(t.length," questions au total\n\u2022 ").concat(h," utilisateurs uniques\n\u2022 ").concat(i," questions max par conversation\n\n\ud83d\udcc4 Fichier: ").concat(o,"\n\n\ud83d\udccb Format: Une ligne par conversation\n\u2022 Colonnes fixes: Session, Utilisateur, Dates...\n\u2022 Colonnes dynamiques: Q1, R1, Q2, R2, Q3, R3...\n\n\ud83d\udca1 Ouvrir avec Excel pour format tabulaire !");alert(g)}catch(e){console.error("\u274c Erreur export CSV conversations:",e),alert("\u274c Erreur export CSV: ".concat(e))}},v=s.filter((e=>{if(t.search&&!e.question.toLowerCase().includes(t.search.toLowerCase())&&!e.response.toLowerCase().includes(t.search.toLowerCase())&&!e.user_email.toLowerCase().includes(t.search.toLowerCase()))return!1;if("all"!==t.source&&e.response_source!==t.source)return!1;if("all"!==t.confidence){const s=e.confidence_score;if("high"===t.confidence&&s<.9)return!1;if("medium"===t.confidence&&(s<.7||s>=.9))return!1;if("low"===t.confidence&&s>=.7)return!1}if("all"!==t.feedback){if("positive"===t.feedback&&1!==e.feedback)return!1;if("negative"===t.feedback&&-1!==e.feedback)return!1;if("none"===t.feedback&&null!==e.feedback)return!1;if("with_comments"===t.feedback&&!e.feedback_comment)return!1;if("no_comments"===t.feedback&&e.feedback_comment)return!1}return"all"===t.user||e.user_email===t.user})),j=Array.from(new Set(s.map((e=>e.user_email)))),f={total:s.filter((e=>null!==e.feedback)).length,positive:s.filter((e=>1===e.feedback)).length,negative:s.filter((e=>-1===e.feedback)).length,withComments:s.filter((e=>e.feedback_comment)).length,satisfactionRate:s.filter((e=>null!==e.feedback)).length>0?s.filter((e=>1===e.feedback)).length/s.filter((e=>null!==e.feedback)).length*100:0},y=s.reduce(((e,s)=>(e[s.response_source]=(e[s.response_source]||0)+1,e)),{});return x&&0===s.length?(0,a.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chargement des questions..."})]})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-8 px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Questions & R\xe9ponses"})]}),x&&(0,a.jsxs)("div",{className:"flex items-center text-blue-600 ml-auto",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),(0,a.jsx)("span",{className:"text-sm",children:"Chargement..."})]})]})}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Filtres"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Recherche"}),(0,a.jsx)("input",{type:"text",value:t.search,onChange:e=>r((s=>({...s,search:e.target.value}))),placeholder:"Rechercher...",className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Source"}),(0,a.jsxs)("select",{value:t.source,onChange:e=>r((s=>({...s,source:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"Toutes les sources"}),(0,a.jsx)("option",{value:"rag",children:"RAG"}),(0,a.jsx)("option",{value:"openai_fallback",children:"OpenAI Fallback"}),(0,a.jsx)("option",{value:"table_lookup",children:"Table Lookup"}),(0,a.jsx)("option",{value:"validation_rejected",children:"Rejet\xe9"}),(0,a.jsx)("option",{value:"quota_exceeded",children:"Quota D\xe9pass\xe9"}),(0,a.jsx)("option",{value:"unknown",children:"Inconnu"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confiance"}),(0,a.jsxs)("select",{value:t.confidence,onChange:e=>r((s=>({...s,confidence:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"Tous niveaux"}),(0,a.jsx)("option",{value:"high",children:"\xc9lev\xe9e (\u226590%)"}),(0,a.jsx)("option",{value:"medium",children:"Moyenne (70-89%)"}),(0,a.jsx)("option",{value:"low",children:"Faible (<70%)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Feedback"}),(0,a.jsxs)("select",{value:t.feedback,onChange:e=>r((s=>({...s,feedback:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"Tous feedback"}),(0,a.jsx)("option",{value:"positive",children:"Positif \ud83d\udc4d"}),(0,a.jsx)("option",{value:"negative",children:"N\xe9gatif \ud83d\udc4e"}),(0,a.jsx)("option",{value:"none",children:"Aucun feedback"}),(0,a.jsx)("option",{value:"with_comments",children:"Avec commentaires"}),(0,a.jsx)("option",{value:"no_comments",children:"Sans commentaires"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Utilisateur"}),(0,a.jsxs)("select",{value:t.user,onChange:e=>r((s=>({...s,user:e.target.value}))),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"Tous utilisateurs"}),j.map((e=>(0,a.jsx)("option",{value:e,children:e.length>25?e.substring(0,25)+"...":e},e)))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"P\xe9riode"}),(0,a.jsxs)("select",{value:i,onChange:e=>n(e.target.value),className:"w-full border border-gray-300 px-3 py-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"day",children:"Aujourd'hui"}),(0,a.jsx)("option",{value:"week",children:"Cette semaine"}),(0,a.jsx)("option",{value:"month",children:"Ce mois"}),(0,a.jsx)("option",{value:"year",children:"Cette ann\xe9e"})]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:v.length})," question(s) trouv\xe9e(s) sur ",(0,a.jsx)("span",{className:"font-medium",children:s.length})," affich\xe9es",m>s.length&&(0,a.jsxs)("span",{className:"text-blue-600",children:[" (Total: ",m,")"]})]}),v.length!==s.length&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800",children:"Filtr\xe9"})]}),(0,a.jsx)("button",{onClick:()=>{r({search:"",source:"all",confidence:"all",feedback:"all",user:"all"}),c(1)},className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"R\xe9initialiser les filtres"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Analyse des Commentaires"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-green-50 border border-green-200",children:[(0,a.jsx)("div",{className:"text-xl font-semibold text-green-600",children:f.positive}),(0,a.jsx)("div",{className:"text-xs text-green-700",children:"Feedback Positifs"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-red-50 border border-red-200",children:[(0,a.jsx)("div",{className:"text-xl font-semibold text-red-600",children:f.negative}),(0,a.jsx)("div",{className:"text-xs text-red-700",children:"Feedback N\xe9gatifs"})]})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Total des feedback:"}),(0,a.jsx)("span",{className:"font-medium",children:f.total})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Avec commentaires:"}),(0,a.jsx)("span",{className:"font-medium",children:f.withComments})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Taux de satisfaction:"}),(0,a.jsxs)("span",{className:"font-medium ".concat(f.satisfactionRate>=80?"text-green-600":f.satisfactionRate>=60?"text-yellow-600":"text-red-600"),children:[f.satisfactionRate.toFixed(1),"%"]})]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-2 mb-4",children:(0,a.jsx)("div",{className:"h-2 transition-all duration-300 ".concat(f.satisfactionRate>=80?"bg-green-500":f.satisfactionRate>=60?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(f.satisfactionRate,"%")}})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Commentaires R\xe9cents"}),(0,a.jsxs)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[s.filter((e=>e.feedback_comment)).sort(((e,s)=>new Date(s.timestamp).getTime()-new Date(e.timestamp).getTime())).slice(0,3).map((e=>(0,a.jsxs)("div",{className:"border border-gray-200 p-2 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.user_email}),(0,a.jsx)("span",{className:"text-sm",children:g(e.feedback)})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-700 italic line-clamp-2",children:['"',e.feedback_comment,'"']}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.timestamp).toLocaleDateString("fr-FR")})]},e.id))),0===s.filter((e=>e.feedback_comment)).length&&(0,a.jsx)("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"Aucun commentaire disponible"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Distribution des Sources"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(y).sort(((e,s)=>{let[,t]=e,[,a]=s;return a-t})).map((e=>{let[t,r]=e;const i=s.length>0?r/s.length*100:0;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium ".concat(h(t)),children:p(t)})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-16 bg-gray-200 h-2",children:(0,a.jsx)("div",{className:"h-2 transition-all duration-300 ".concat("rag"===t?"bg-blue-500":"openai_fallback"===t?"bg-purple-500":"table_lookup"===t?"bg-green-500":"validation_rejected"===t?"bg-red-500":"quota_exceeded"===t?"bg-orange-500":"bg-gray-500"),style:{width:"".concat(i,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900 w-12 text-right",children:r})]})]},t)}))}),(0,a.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"M\xe9triques de Qualit\xe9"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"text-center p-2 bg-blue-50 border border-blue-200",children:[(0,a.jsxs)("div",{className:"text-lg font-semibold text-blue-600",children:[s.length>0?(s.reduce(((e,s)=>e+s.confidence_score),0)/s.length*100).toFixed(1):"0.0","%"]}),(0,a.jsx)("div",{className:"text-xs text-blue-700",children:"Confiance Moyenne"})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-green-50 border border-green-200",children:[(0,a.jsxs)("div",{className:"text-lg font-semibold text-green-600",children:[s.length>0?(s.reduce(((e,s)=>e+s.response_time),0)/s.length).toFixed(1):"0.0","s"]}),(0,a.jsx)("div",{className:"text-xs text-green-700",children:"Temps Moyen"})]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Export des Donn\xe9es"})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-stretch",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Conversations"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Format ligne par conversation, compatible Excel"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsxs)("p",{children:["\u2022 Choix automatique: Filtr\xe9es (",v.length,") ou toutes (",m,")"]}),(0,a.jsx)("p",{children:"\u2022 Colonnes: Q1, R1, Source1, Q2, R2, Source2..."})]})]}),(0,a.jsx)("button",{onClick:()=>b(),disabled:0===s.length,className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Commentaires"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Feedback et commentaires utilisateurs"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsx)("p",{children:"\u2022 Feedback positifs et n\xe9gatifs"}),(0,a.jsx)("p",{children:"\u2022 Commentaires avec contexte question"})]})]}),(0,a.jsx)("button",{onClick:()=>{const e="data:text/csv;charset=utf-8,Date,Utilisateur,Question,Feedback,Commentaire,Source,Confiance\n"+s.filter((e=>e.feedback_comment)).map((e=>({date:new Date(e.timestamp).toLocaleDateString("fr-FR"),user:e.user_email,question:e.question.substring(0,100)+"...",feedback:1===e.feedback?"Positif":"N\xe9gatif",comment:e.feedback_comment,source:p(e.response_source),confidence:(100*e.confidence_score).toFixed(1)+"%"}))).map((e=>Object.values(e).map((e=>'"'.concat(e,'"'))).join(","))).join("\n"),t=encodeURI(e),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download","commentaires_feedback_".concat((new Date).toISOString().split("T")[0],".csv")),document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Questions Filtr\xe9es"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Questions actuellement affich\xe9es"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsxs)("p",{children:["\u2022 ",v.length," questions s\xe9lectionn\xe9es"]}),(0,a.jsx)("p",{children:"\u2022 Donn\xe9es compl\xe8tes avec r\xe9ponses"})]})]}),(0,a.jsx)("button",{onClick:()=>{const e="data:text/csv;charset=utf-8,Date,Utilisateur,Question,R\xe9ponse,Source,Confiance,Temps,Feedback\n"+v.map((e=>({date:new Date(e.timestamp).toLocaleDateString("fr-FR"),user:e.user_email,question:e.question,response:e.response.substring(0,200)+"...",source:p(e.response_source),confidence:(100*e.confidence_score).toFixed(1)+"%",response_time:e.response_time+"s",feedback:1===e.feedback?"Positif":-1===e.feedback?"N\xe9gatif":"Aucun"}))).map((e=>Object.values(e).map((e=>'"'.concat(e,'"'))).join(","))).join("\n"),s=encodeURI(e),t=document.createElement("a");t.setAttribute("href",s),t.setAttribute("download","questions_export_".concat((new Date).toISOString().split("T")[0],".csv")),document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Statistiques"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Donn\xe9es d'analyse et m\xe9triques"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsx)("p",{children:"\u2022 M\xe9triques de satisfaction et performance"}),(0,a.jsx)("p",{children:"\u2022 Format JSON pour analyse avanc\xe9e"})]})]}),(0,a.jsx)("button",{onClick:()=>{const e={export_date:(new Date).toISOString(),total_questions:m,displayed_questions:s.length,filtered_questions:v.length,unique_users:j.length,feedback_stats:f,source_distribution:y,filters_applied:t},a="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download","stats_export_".concat((new Date).toISOString().split("T")[0],".json")),document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"Exporter JSON"})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Questions et R\xe9ponses"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[v.length," questions affich\xe9es"]})]}),0===v.length?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\ud83d\udd0d"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune question trouv\xe9e"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:t.search||"all"!==t.source||"all"!==t.confidence||"all"!==t.feedback||"all"!==t.user?"Essayez de modifier vos filtres pour voir plus de r\xe9sultats.":"Il n'y a pas encore de questions dans cette p\xe9riode."}),(t.search||"all"!==t.source||"all"!==t.confidence||"all"!==t.feedback||"all"!==t.user)&&(0,a.jsx)("button",{onClick:()=>{r({search:"",source:"all",confidence:"all",feedback:"all",user:"all"})},className:"bg-blue-600 text-white px-4 py-2 hover:bg-blue-700 transition-colors",children:"R\xe9initialiser les filtres"})]}):(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:v.map((e=>{return(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 flex items-center justify-center text-white text-xs font-bold",children:e.user_name.split(" ").map((e=>e[0])).join("").toUpperCase()}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.user_name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.user_email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium ".concat(h(e.response_source)),children:p(e.response_source)}),(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium ".concat((s=e.confidence_score,s>=.9?"text-green-600 bg-green-100":s>=.7?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100")),children:[(100*e.confidence_score).toFixed(0),"%"]}),(0,a.jsx)("span",{className:"text-lg",children:g(e.feedback)}),e.feedback_comment&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800",children:"\ud83d\udcac"})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Question:"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 bg-blue-50 p-3 border-l-4 border-blue-400",children:e.question})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"R\xe9ponse:"}),(0,a.jsx)("div",{className:"text-sm text-gray-700 bg-gray-50 p-3 max-h-32 overflow-y-auto border border-gray-200",children:e.response.split("\n").map(((e,s)=>(0,a.jsx)("p",{className:e.startsWith("**")?"font-semibold":"",children:e},s)))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{children:new Date(e.timestamp).toLocaleString("fr-FR")}),(0,a.jsxs)("span",{children:[e.response_time,"s"]}),(0,a.jsx)("span",{children:e.language.toUpperCase()}),(0,a.jsxs)("span",{children:[e.session_id.substring(0,8),"..."]})]}),(0,a.jsx)("button",{onClick:()=>d(e),className:"text-blue-600 hover:text-blue-800 font-medium bg-blue-50 px-2 py-1 border border-blue-200",children:"Voir d\xe9tails \u2192"})]}),e.feedback_comment&&(0,a.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border-l-4 border-blue-400",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{className:"text-lg",children:g(e.feedback)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Commentaire utilisateur:"}),(0,a.jsxs)("p",{className:"text-sm text-blue-800 italic",children:['"',e.feedback_comment,'"']}),(0,a.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:["Feedback ",1===e.feedback?"positif":"n\xe9gatif"," \u2022 ",new Date(e.timestamp).toLocaleDateString("fr-FR")]})]})]})})]})})},e.id);var s}))}),v.length>0&&(0,a.jsxs)("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>c(Math.max(1,l-1)),disabled:1===l,className:"px-3 py-1 border border-gray-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white transition-colors",children:"\u2190 Pr\xe9c\xe9dent"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 px-2 py-1 bg-white border border-gray-300",children:["Page ",l]}),(0,a.jsx)("button",{onClick:()=>c(l+1),disabled:v.length<o,className:"px-3 py-1 border border-gray-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white transition-colors",children:"Suivant \u2192"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[v.length," question(s) affich\xe9e(s)",m>s.length&&(0,a.jsxs)("span",{className:"text-blue-600",children:[" sur ",m," au total"]})]})]})]})]})},o=e=>{let{invitationStats:s,cacheStatus:t=null,isLoading:r=!1}=e;return r?(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-8 text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chargement des statistiques d'invitations..."})]}):s?(0,a.jsxs)("div",{className:"space-y-4",children:[t&&!t.is_available&&(0,a.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-amber-800",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Chargement en mode standard"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Invitations Envoy\xe9es"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:s.total_invitations_sent}),t&&(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:t.is_available?"Cache":"Direct"})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Invitations Accept\xe9es"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-green-600",children:s.total_invitations_accepted}),t&&t.is_available&&(0,a.jsx)("p",{className:"text-xs text-green-500 mt-1",children:"Donn\xe9es mises en cache"})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Utilisateurs Inviteurs"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:s.unique_inviters}),!(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("p",{className:"text-xs text-amber-500 mt-1",children:"Mode direct"})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Taux d'Acceptation"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-blue-600",children:[s.acceptance_rate.toFixed(1),"%"]}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("p",{className:"text-xs text-blue-500 mt-1",children:"Optimis\xe9"})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Analyse du Taux d'Acceptation"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[(0,a.jsx)("span",{children:"Taux global d'acceptation"}),(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[s.acceptance_rate.toFixed(1),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-4 rounded-full transition-all duration-500 ".concat(s.acceptance_rate>=75?"bg-green-500":s.acceptance_rate>=50?"bg-blue-500":s.acceptance_rate>=25?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.min(100,Math.max(5,s.acceptance_rate)),"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,a.jsx)("span",{children:"0%"}),(0,a.jsx)("span",{children:"25%"}),(0,a.jsx)("span",{children:"50%"}),(0,a.jsx)("span",{children:"75%"}),(0,a.jsx)("span",{children:"100%"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[(0,a.jsx)("div",{className:"bg-blue-50 p-3 border border-blue-200 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-blue-600",children:s.total_invitations_sent}),(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"Total Envoy\xe9es"})]})}),(0,a.jsx)("div",{className:"bg-green-50 p-3 border border-green-200 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-green-600",children:s.total_invitations_accepted}),(0,a.jsx)("p",{className:"text-xs text-green-700",children:"Total Accept\xe9es"})]})}),(0,a.jsx)("div",{className:"bg-gray-50 p-3 border border-gray-200 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-600",children:s.total_invitations_sent-s.total_invitations_accepted}),(0,a.jsx)("p",{className:"text-xs text-gray-700",children:"En Attente"})]})})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Top 5 - Invitations Envoy\xe9es"}),t&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(t.is_available?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:t.is_available?"Cache":"Direct"})]})}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rang"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Inviteur"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Envoy\xe9es"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Accept\xe9es"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Taux"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[s.top_inviters.slice(0,5).map(((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-bold text-gray-900",children:(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white ".concat(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-orange-600":"bg-blue-500"),children:s+1})}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 max-w-48",children:(0,a.jsxs)("div",{className:"truncate",title:e.inviter_email,children:[(0,a.jsx)("div",{className:"font-medium",children:e.inviter_name||"Nom non disponible"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.inviter_email})]})}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-blue-900",children:e.invitations_sent}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-green-600 font-medium",children:e.invitations_accepted}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat(e.acceptance_rate>=70?"bg-green-100 text-green-800":e.acceptance_rate>=40?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[e.acceptance_rate.toFixed(0),"%"]})})]},e.inviter_email||"inviter-".concat(s)))),0===s.top_inviters.length&&(0,a.jsx)("tr",{children:(0,a.jsxs)("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:[(0,a.jsx)("div",{className:"text-gray-400 text-2xl mb-2",children:"\ud83d\udce8"}),(0,a.jsx)("p",{children:"Aucun inviteur trouv\xe9"}),t&&(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Mode ",t.is_available?"cache":"direct"," - Aucune donn\xe9e"]})]})})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Top 5 - Invitations Accept\xe9es"}),t&&t.is_available&&(0,a.jsxs)("span",{className:"text-xs text-green-600",children:[t.cache_age_minutes,"min"]})]})}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rang"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Inviteur"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Accept\xe9es"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Efficacit\xe9"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[s.top_accepted.slice(0,5).map(((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-bold text-gray-900",children:(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white ".concat(0===s?"bg-green-500":1===s?"bg-blue-500":2===s?"bg-purple-500":"bg-indigo-500"),children:s+1})}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 max-w-48",children:(0,a.jsxs)("div",{className:"truncate",title:e.inviter_email,children:[(0,a.jsx)("div",{className:"font-medium",children:e.inviter_name||"Nom non disponible"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.inviter_email})]})}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-bold text-green-600 text-lg",children:e.invitations_accepted}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-600",children:e.invitations_sent}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat(e.acceptance_rate>=70?"bg-green-100 text-green-800":e.acceptance_rate>=40?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[e.acceptance_rate.toFixed(0),"%"]}),e.acceptance_rate>=80&&(0,a.jsx)("span",{className:"text-green-600 text-sm",children:"\ud83c\udfc6"})]})})]},e.inviter_email||"accepted-".concat(s)))),0===s.top_accepted.length&&(0,a.jsx)("tr",{children:(0,a.jsxs)("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:[(0,a.jsx)("div",{className:"text-gray-400 text-2xl mb-2",children:"\u2705"}),(0,a.jsx)("p",{children:"Aucune invitation accept\xe9e"}),t&&(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Donn\xe9es ",t.is_available?"en cache":"directes"," - Aucun r\xe9sultat"]})]})})]})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Performance des Invitations"}),t&&t.last_update&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Derni\xe8re M\xe0J: ",new Date(t.last_update).toLocaleString("fr-FR")]})]})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg relative",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:s.total_invitations_sent}),(0,a.jsx)("p",{className:"text-sm text-blue-700",children:"Total Envoy\xe9es"}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg relative",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-green-900",children:s.total_invitations_accepted}),(0,a.jsx)("p",{className:"text-sm text-green-700",children:"Total Accept\xe9es"}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg relative",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.total_invitations_sent-s.total_invitations_accepted}),(0,a.jsx)("p",{className:"text-sm text-gray-700",children:"En Attente"}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg relative",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-900",children:[s.acceptance_rate.toFixed(1),"%"]}),(0,a.jsx)("p",{className:"text-sm text-purple-700",children:"Taux Global"}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Analyse Avanc\xe9e"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-indigo-600",children:s.unique_inviters}),(0,a.jsx)("p",{className:"text-xs text-indigo-700",children:"Inviteurs Actifs"})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-teal-600",children:s.unique_inviters>0?(s.total_invitations_sent/s.unique_inviters).toFixed(1):"0.0"}),(0,a.jsx)("p",{className:"text-xs text-teal-700",children:"Moy. par Inviteur"})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-orange-600",children:s.total_invitations_accepted>0?(s.total_invitations_accepted/s.unique_inviters).toFixed(1):"0.0"}),(0,a.jsx)("p",{className:"text-xs text-orange-700",children:"Succ\xe8s par Inviteur"})]})}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-3 rounded",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold ".concat(s.acceptance_rate>=75?"text-green-600":s.acceptance_rate>=50?"text-yellow-600":"text-red-600"),children:s.acceptance_rate>=75?"Excellent":s.acceptance_rate>=50?"Bon":"\xc0 am\xe9liorer"}),(0,a.jsx)("p",{className:"text-xs text-gray-700",children:"Performance"})]})})]})]}),t&&(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-flex items-center space-x-1 ".concat(t.is_available?"text-green-600":"text-red-600"),children:t.is_available?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"font-medium",children:"Cache Actif"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-red-600 rounded-full"}),(0,a.jsx)("span",{className:"font-medium",children:"Cache Indisponible"})]})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Source des donn\xe9es"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"font-medium text-blue-600",children:t.is_available?t.performance_gain:"Performance standard"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Temps de chargement"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"font-medium text-gray-700",children:t.next_update?new Date(t.next_update).toLocaleString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"Automatique"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Prochaine mise \xe0 jour"})]})]}),t.is_available&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[(0,a.jsx)("span",{children:"Fra\xeecheur des donn\xe9es"}),(0,a.jsxs)("span",{children:[Math.max(0,60-t.cache_age_minutes),"min restantes"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-2 rounded",children:(0,a.jsx)("div",{className:"h-2 rounded transition-all duration-300 ".concat(t.cache_age_minutes<30?"bg-green-500":t.cache_age_minutes<45?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.max(10,Math.min(100,100-t.cache_age_minutes/60*100)),"%")}})})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Export des Statistiques d'Invitations"}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Donn\xe9es optimis\xe9es"})]})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Export CSV Complet"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Toutes les statistiques au format CSV"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsx)("p",{children:"\u2022 Top inviteurs et statistiques d\xe9taill\xe9es"}),(0,a.jsxs)("p",{children:["\u2022 Donn\xe9es ",(null===t||void 0===t?void 0:t.is_available)?"optimis\xe9es par cache":"en temps r\xe9el"]}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("p",{children:"\u2022 Export\xe9 avec performance optimis\xe9e"})]})]}),(0,a.jsx)("button",{onClick:()=>{const e=[["M\xe9trique","Valeur","Source","Timestamp"],["Total Invitations Envoy\xe9es",s.total_invitations_sent,(null===t||void 0===t?void 0:t.is_available)?"Cache":"Direct",(new Date).toISOString()],["Total Invitations Accept\xe9es",s.total_invitations_accepted,(null===t||void 0===t?void 0:t.is_available)?"Cache":"Direct",(new Date).toISOString()],["Taux d'Acceptation Global","".concat(s.acceptance_rate.toFixed(1),"%"),(null===t||void 0===t?void 0:t.is_available)?"Cache":"Direct",(new Date).toISOString()],["Nombre d'Inviteurs Uniques",s.unique_inviters,(null===t||void 0===t?void 0:t.is_available)?"Cache":"Direct",(new Date).toISOString()],["Moyenne Invitations par Inviteur",s.unique_inviters>0?(s.total_invitations_sent/s.unique_inviters).toFixed(1):"0",(null===t||void 0===t?void 0:t.is_available)?"Cache":"Direct",(new Date).toISOString()],["","","",""],["Top Inviteurs (Envoy\xe9es)","","",""],["Rang","Nom","Email","Envoy\xe9es","Accept\xe9es","Taux"],...s.top_inviters.map(((e,s)=>[s+1,e.inviter_name||"N/A",e.inviter_email,e.invitations_sent,e.invitations_accepted,"".concat(e.acceptance_rate.toFixed(1),"%")])),["","","",""],["Top Inviteurs (Accept\xe9es)","","",""],["Rang","Nom","Email","Accept\xe9es","Total","Efficacit\xe9"],...s.top_accepted.map(((e,s)=>[s+1,e.inviter_name||"N/A",e.inviter_email,e.invitations_accepted,e.invitations_sent,"".concat(e.acceptance_rate.toFixed(1),"%")]))].map((e=>e.map((e=>'"'.concat(e,'"'))).join(","))).join("\n"),a=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8"}),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download="invitations_stats_".concat((null===t||void 0===t?void 0:t.is_available)?"cache":"direct","_").concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"\ud83d\udcca Exporter CSV"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 flex flex-col justify-between h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-base font-medium text-gray-900 mb-1",children:"Export JSON D\xe9taill\xe9"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Format JSON avec m\xe9tadonn\xe9es compl\xe8tes"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,a.jsx)("p",{children:"\u2022 Structure compl\xe8te pour analyse avanc\xe9e"}),(0,a.jsx)("p",{children:"\u2022 M\xe9tadonn\xe9es de performance incluses"}),(null===t||void 0===t?void 0:t.is_available)&&(0,a.jsx)("p",{children:"\u2022 Informations de cache d\xe9taill\xe9es"})]})]}),(0,a.jsx)("button",{onClick:()=>{const e={export_metadata:{timestamp:(new Date).toISOString(),data_source:(null===t||void 0===t?void 0:t.is_available)?"ultra_fast_cache":"direct_query",performance_gain:(null===t||void 0===t?void 0:t.performance_gain)||"N/A",cache_age_minutes:(null===t||void 0===t?void 0:t.cache_age_minutes)||null,version:"2.0"},invitation_statistics:s,cache_information:t?{is_cache_enabled:t.is_available,last_cache_update:t.last_update,next_cache_update:t.next_update,cache_performance:t.performance_gain}:null,computed_metrics:{pending_invitations:s.total_invitations_sent-s.total_invitations_accepted,success_rate:s.acceptance_rate,average_invitations_per_inviter:s.unique_inviters>0?(s.total_invitations_sent/s.unique_inviters).toFixed(2):0,performance_rating:s.acceptance_rate>=75?"excellent":s.acceptance_rate>=50?"good":"needs_improvement"},detailed_analysis:{top_performers:s.top_accepted.slice(0,3).map((e=>({name:e.inviter_name,email:e.inviter_email,success_count:e.invitations_accepted,efficiency:e.acceptance_rate}))),most_active:s.top_inviters.slice(0,3).map((e=>({name:e.inviter_name,email:e.inviter_email,invitation_count:e.invitations_sent,success_rate:e.acceptance_rate})))}},a="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download","invitations_complete_".concat((null===t||void 0===t?void 0:t.is_available)?"cached":"direct","_").concat((new Date).toISOString().split("T")[0],".json")),document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"w-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 transition-colors",children:"\ud83d\udd27 Exporter JSON"})]})]})})]})]}):(0,a.jsx)("div",{className:"bg-white border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[(0,a.jsx)("div",{className:"text-gray-400 text-2xl mb-2",children:"\ud83d\udce8"}),(0,a.jsx)("p",{children:"Statistiques d'invitations non disponibles"})]})})},d=()=>{const{user:e}=(0,i.useAuthStore)(),[s,t]=(0,r.useState)("initializing"),[d,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[g,b]=(0,r.useState)(null),[v,j]=(0,r.useState)(null),[f,y]=(0,r.useState)(null),[N,_]=(0,r.useState)(null),[w,k]=(0,r.useState)(""),[S,C]=(0,r.useState)(null),[q,T]=(0,r.useState)(null),[F,R]=(0,r.useState)(null),[A,E]=(0,r.useState)(null),[D,L]=(0,r.useState)(null),[I,P]=(0,r.useState)([]),[O,M]=(0,r.useState)(0),[U,Q]=(0,r.useState)("month"),[z,V]=(0,r.useState)("dashboard"),[B,H]=(0,r.useState)({search:"",source:"all",confidence:"all",feedback:"all",user:"all"}),[J,W]=(0,r.useState)(1),[G]=(0,r.useState)(20),[$,K]=(0,r.useState)(null),X=(0,r.useRef)(!1),Y=(0,r.useRef)(0),Z=(0,r.useRef)(!1),ee=(0,r.useRef)(new Map),se=(0,r.useRef)(!1);(0,r.useEffect)((()=>{let a;const r=()=>{if("ready"!==s||!X.current)return console.log("[StatisticsPage] Auth check:",{user:void 0===e?"undefined":null===e?"null":"defined",email:null===e||void 0===e?void 0:e.email,user_type:null===e||void 0===e?void 0:e.user_type,stabilityCounter:Y.current,currentAuthStatus:s}),void 0===e?(console.log("[StatisticsPage] Phase 1: Attente initialisation auth..."),t("initializing"),void(Y.current=0)):null===e||e.email&&e.user_type?("ready"!==s&&Y.current++,Y.current<2&&"ready"!==s?(console.log("[StatisticsPage] Stabilisation... (".concat(Y.current,"/2)")),t("checking"),void(a=setTimeout(r,150))):null===e?(console.log("[StatisticsPage] Utilisateur non connect\xe9"),t("unauthorized"),void b("Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 cette page")):"super_admin"!==e.user_type?(console.log("[StatisticsPage] Permissions insuffisantes:",e.user_type),t("forbidden"),void b("Acc\xe8s refus\xe9 - Permissions super_admin requises")):void(X.current||(console.log("[StatisticsPage] Authentification r\xe9ussie:",e.email),t("ready"),b(null),X.current=!0))):(console.log("[StatisticsPage] Phase 2: Donn\xe9es utilisateur incompl\xe8tes, attente..."),t("checking"),void(Y.current=0))};return a=setTimeout(r,50),()=>{a&&clearTimeout(a)}}),[e,s]),(0,r.useEffect)((()=>{"ready"!==s||d||Z.current||(console.log("[StatisticsPage] Lancement chargement des statistiques"),Z.current=!0,ie())}),[s]),(0,r.useEffect)((()=>{if("ready"===s&&"questions"===z&&!m){const e="".concat(J,"-").concat(G);ee.current.get(e)||(console.log("[StatisticsPage] Lancement chargement des questions pour page:",e),ee.current.set(e,!0),ne())}}),[s,z,J]),(0,r.useEffect)((()=>{"ready"!==s||"invitations"!==z||h||se.current||(console.log("[StatisticsPage] Lancement chargement des invitations"),se.current=!0,le())}),[s,z]);const te=e=>{e!==z&&(console.log("[StatisticsPage] Changement onglet:",z,"->",e),"questions"===e&&ee.current.clear(),V(e))},ae=async()=>{try{console.log("\ud83d\udd0d getAuthHeaders: D\xe9but...");try{const e=(0,n.getSupabaseClient)();console.log("\ud83d\udd0d getAuthHeaders: Supabase client r\xe9cup\xe9r\xe9");const{data:{session:s},error:t}=await e.auth.getSession();if(console.log("\ud83d\udd0d getAuthHeaders: Session r\xe9cup\xe9r\xe9e:",{hasSession:!!s,hasError:!!t,hasAccessToken:!!(null===s||void 0===s?void 0:s.access_token),errorMessage:null===t||void 0===t?void 0:t.message}),(null===s||void 0===s?void 0:s.access_token)&&!t)return console.log("\u2705 Token trouv\xe9 via Supabase getSession()"),{Authorization:"Bearer ".concat(s.access_token),"Content-Type":"application/json"}}catch(e){console.log("\u26a0\ufe0f Supabase getSession() \xe9chou\xe9, essai cookies...")}console.log("\ud83c\udf6a Tentative r\xe9cup\xe9ration token depuis cookies...");const s=re();return s?(console.log("\u2705 Token trouv\xe9 dans cookies"),{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}):(console.error("\u274c Aucun token trouv\xe9 (ni Supabase ni cookies)"),{})}catch(g){return console.error("\u274c Erreur getAuthHeaders:",g),{}}},re=()=>{try{const e=document.cookie.split(";").find((e=>e.trim().startsWith("sb-cdrmjshmkdfwwtsfdvbl-auth-token=")));if(e){const s=e.split("=")[1],t=decodeURIComponent(s),a=JSON.parse(t);if(a&&a.access_token)return console.log("\ud83c\udf6a Token extrait des cookies avec succ\xe8s"),a.access_token}return console.log("\ud83c\udf6a Pas de cookie Supabase trouv\xe9"),null}catch(g){return console.error("\u274c Erreur parsing cookie:",g),null}},ie=async()=>{if(d)return void console.log("\ud83d\udcca [StatisticsPage] Chargement d\xe9j\xe0 en cours, annulation...");console.log("\ud83d\ude80 [StatisticsPage] D\xc9BUT chargement statistiques"),x(!0),b(null);const e=performance.now();try{var s,t,a;const r=await ae();console.log("\u26a1 Tentative endpoint cache: /api/v1/stats-fast/dashboard");const i=await fetch("/api/v1/stats-fast/dashboard",{headers:r});if(!i.ok)throw new Error("Erreur cache endpoint: ".concat(i.status," - ").concat(i.statusText));const n=await i.json();console.log("\ud83c\udf89 SUCC\xc8S endpoint!",n);const l=performance.now()-e;console.log("\u26a1 Performance: ".concat(l.toFixed(0),"ms"));const c=(null===(s=n.performanceStats)||void 0===s?void 0:s.performance_gain)||(null===(t=n.performance_stats)||void 0===t?void 0:t.performance_gain)||(null===(a=n.cache_info)||void 0===a?void 0:a.performance_gain)||0,o="number"===typeof c?"".concat(c,"%"):(null===c||void 0===c?void 0:c.toString())||"0%",d={...n.cache_info,performance_gain:o};j(d),k("".concat(l.toFixed(0),"ms (vs ").concat(o,")"));const x=n.systemStats||n.system_stats,m=n.usageStats||n.usage_stats,u=n.billingStats||n.billing_stats,h=n.performanceStats||n.performance_stats,p=x?{...x,system_health:x.system_health?{...x.system_health,error_rate:"string"===typeof x.system_health.error_rate?parseFloat(x.system_health.error_rate)||0:x.system_health.error_rate||0}:x.system_health}:null,g=u?{...u,total_revenue:"string"===typeof u.total_revenue?parseFloat(u.total_revenue)||0:u.total_revenue||0}:null,b=h?{...h,avg_response_time:"string"===typeof h.avg_response_time?parseFloat(h.avg_response_time)||0:h.avg_response_time||0,median_response_time:"string"===typeof h.median_response_time?parseFloat(h.median_response_time)||0:h.median_response_time||0,min_response_time:"string"===typeof h.min_response_time?parseFloat(h.min_response_time)||0:h.min_response_time||0,max_response_time:"string"===typeof h.max_response_time?parseFloat(h.max_response_time)||0:h.max_response_time||0,response_time_count:"string"===typeof h.response_time_count?parseInt(h.response_time_count)||0:h.response_time_count||0,openai_costs:"string"===typeof h.openai_costs?parseFloat(h.openai_costs)||0:h.openai_costs||0,error_count:"string"===typeof h.error_count?parseInt(h.error_count)||0:h.error_count||0,cache_hit_rate:"string"===typeof h.cache_hit_rate?parseFloat(h.cache_hit_rate)||0:h.cache_hit_rate||0,performance_gain:"string"===typeof h.performance_gain?parseFloat(h.performance_gain)||0:h.performance_gain||0}:null;C(p),T(m),R(g),E(b),console.log("\u2705 Toutes les statistiques charg\xe9es depuis le cache!")}catch(r){console.error("\u274c [StatisticsPage] Erreur chargement statistiques:",r),b("Erreur lors du chargement des statistiques: ".concat(r)),Z.current=!1}finally{x(!1)}},ne=async()=>{if(m)return void console.log("\ud83d\udcdd [Questions] Chargement d\xe9j\xe0 en cours, annulation...");console.log("\u26a1 [Questions] Chargement"),u(!0);const e=performance.now();try{const s=await ae(),t=new URLSearchParams({page:J.toString(),limit:G.toString()}),a=await fetch("/api/v1/logging/questions?".concat(t),{headers:s});if(!a.ok)throw new Error("Erreur questions: ".concat(a.status," - ").concat(a.statusText));const r=await a.json();console.log("\ud83c\udf89 Questions charg\xe9es!",r);const i=performance.now()-e;console.log("\u26a1 Questions Performance: ".concat(i.toFixed(0),"ms"));const n={is_available:!1,last_update:null,cache_age_minutes:0,performance_gain:"".concat(i.toFixed(0),"ms"),next_update:null};y(n);const l=r.questions.map((e=>({id:e.id,timestamp:e.timestamp,user_email:e.user_email,user_name:e.user_name||(e.user_email||"").split("@")[0].replace("."," ").replace(/\b\w/g,(e=>e.toUpperCase())),question:e.question,response:e.response,response_source:ce(e.response_source),confidence_score:e.confidence_score,response_time:e.response_time,language:e.language,session_id:e.session_id,feedback:e.feedback,feedback_comment:e.feedback_comment})));P(l),M(r.pagination.total)}catch(s){console.error("\u274c Erreur chargement questions:",s),b("Erreur chargement questions: ".concat(s)),P([]);const e="".concat(J,"-").concat(G);ee.current.delete(e)}finally{u(!1)}},le=async()=>{if(h)return void console.log("\ud83d\udce8 [Invitations] Chargement d\xe9j\xe0 en cours, annulation...");console.log("\u26a1 [Invitations] Chargement"),p(!0),b(null);const e=performance.now();try{const s=await ae();if(!s||!("Authorization"in s)||!s.Authorization)throw new Error("Pas de token d'authentification disponible");console.log("\u26a1 Tentative endpoint cache: /api/v1/stats-fast/invitations");const t=await fetch("/api/v1/stats-fast/invitations",{headers:s});if(!t.ok)throw new Error("Erreur cache invitations: ".concat(t.status," - ").concat(t.statusText));const a=await t.json();console.log("\ud83c\udf89 Invitations charg\xe9es!",a);const r=performance.now()-e;console.log("\u26a1 Invitations Performance: ".concat(r.toFixed(0),"ms")),_(a.cache_info),L(a.invitation_stats)}catch(s){console.error("[StatisticsPage] Erreur chargement stats invitations:",s),b("Erreur lors du chargement des statistiques d'invitations: ".concat(s)),se.current=!1,L({total_invitations_sent:0,total_invitations_accepted:0,acceptance_rate:0,unique_inviters:0,top_inviters:[],top_accepted:[]})}finally{p(!1)}},ce=e=>{switch(e){case"rag":return"rag";case"openai_fallback":return"openai_fallback";case"table_lookup":return"table_lookup";case"validation_rejected":return"validation_rejected";case"quota_exceeded":return"quota_exceeded";default:return"unknown"}};return"initializing"===s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Initialisation..."})]})}):"checking"===s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"V\xe9rification des permissions..."}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Stabilisation des donn\xe9es d'authentification"})]})}):"unauthorized"===s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 max-w-md w-full text-center p-8",children:[(0,a.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"\ud83d\udd12"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Connexion requise"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 cette page."}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>window.location.href="/login",className:"flex-1 bg-blue-600 text-white px-6 py-2 hover:bg-blue-700 transition-colors",children:"Se connecter"}),(0,a.jsx)("button",{onClick:()=>window.history.back(),className:"flex-1 bg-gray-100 text-gray-700 px-6 py-2 hover:bg-gray-200 transition-colors border border-gray-300",children:"Retour"})]})]})}):"forbidden"===s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 max-w-md w-full text-center p-8",children:[(0,a.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"\ud83d\udeab"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Acc\xe8s refus\xe9"}),(0,a.jsx)("p",{className:"text-gray-600 mb-2",children:"Cette page est r\xe9serv\xe9e aux super administrateurs."}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:["Votre r\xf4le actuel : ",(0,a.jsx)("span",{className:"font-medium",children:(null===e||void 0===e?void 0:e.user_type)||"non d\xe9fini"})]}),(0,a.jsx)("button",{onClick:()=>window.history.back(),className:"w-full bg-blue-600 text-white px-6 py-2 hover:bg-blue-700 transition-colors",children:"Retour"})]})}):d&&!S?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chargement des statistiques..."})]})}):g&&"ready"===s&&!S?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 max-w-md w-full text-center p-8",children:[(0,a.jsx)("div",{className:"text-amber-600 text-6xl mb-4",children:"\u26a0\ufe0f"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Erreur"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:g}),(0,a.jsx)("button",{onClick:()=>{Z.current=!1,ie()},className:"w-full bg-blue-600 text-white px-6 py-2 hover:bg-blue-700 transition-colors",children:"R\xe9essayer"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("img",{src:"/images/logo.png",alt:"Logo",className:"h-8 w-auto"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,a.jsx)("button",{onClick:()=>te("dashboard"),className:"px-3 py-2 text-sm font-medium transition-colors ".concat("dashboard"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Tableau de bord"}),(0,a.jsx)("button",{onClick:()=>te("questions"),className:"px-3 py-2 text-sm font-medium transition-colors ".concat("questions"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Questions & R\xe9ponses"}),(0,a.jsx)("button",{onClick:()=>te("invitations"),className:"px-3 py-2 text-sm font-medium transition-colors ".concat("invitations"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Invitations"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:["dashboard"===z&&(0,a.jsxs)("button",{onClick:()=>{Z.current=!1,ie()},disabled:d,className:"bg-blue-600 text-white px-3 py-1 text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-1",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,a.jsx)("span",{children:d?"Loading...":"Refresh"})]}),"questions"===z&&(0,a.jsxs)("button",{onClick:()=>{ee.current.clear(),ne()},disabled:m,className:"bg-blue-600 text-white px-3 py-1 text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-1",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,a.jsx)("span",{children:m?"Loading...":"Refresh"})]}),"invitations"===z&&(0,a.jsxs)("button",{onClick:()=>{se.current=!1,le()},disabled:h,className:"bg-blue-600 text-white px-3 py-1 text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-1",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,a.jsx)("span",{children:h?"Loading...":"Refresh"})]})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:["dashboard"===z?(0,a.jsx)(l,{systemStats:S,usageStats:q,billingStats:F,performanceStats:A,cacheStatus:v?{...v,performance_gain:"string"===typeof v.performance_gain?v.performance_gain:"".concat(v.performance_gain,"%")}:null,isLoading:d}):"questions"===z?(0,a.jsx)(c,{questionLogs:I,questionFilters:B,setQuestionFilters:H,selectedTimeRange:U,setSelectedTimeRange:Q,currentPage:J,setCurrentPage:W,questionsPerPage:G,setSelectedQuestion:K,isLoading:m,totalQuestions:O,cacheStatus:f?{...f,performance_gain:"string"===typeof f.performance_gain?f.performance_gain:"".concat(f.performance_gain,"%")}:null}):"invitations"===z?(0,a.jsx)(a.Fragment,{children:h&&!D?(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-8 text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chargement des statistiques d'invitations..."})]}):(0,a.jsx)(o,{invitationStats:D,cacheStatus:N?{...N,performance_gain:"string"===typeof N.performance_gain?N.performance_gain:"".concat(N.performance_gain,"%")}:null,isLoading:h})}):null,$&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"D\xe9tails de la Question"})]}),(0,a.jsx)("button",{onClick:()=>K(null),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 border border-blue-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\u2753"}),(0,a.jsx)("span",{children:"Question:"})]}),(0,a.jsx)("p",{className:"text-gray-700",children:$.question})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 border border-gray-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\ud83d\udcac"}),(0,a.jsx)("span",{children:"R\xe9ponse:"})]}),(0,a.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap",children:$.response})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-3 flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\ud83d\udcca"}),(0,a.jsx)("span",{children:"M\xe9tadonn\xe9es:"})]}),(0,a.jsx)("table",{className:"w-full text-sm",children:(0,a.jsxs)("tbody",{className:"space-y-2",children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Source:"}),(0,a.jsx)("td",{className:"font-medium py-1",children:$.response_source})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Confiance:"}),(0,a.jsxs)("td",{className:"font-medium py-1",children:[(100*$.confidence_score).toFixed(1),"%"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Temps:"}),(0,a.jsxs)("td",{className:"font-medium py-1",children:[$.response_time,"s"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Langue:"}),(0,a.jsx)("td",{className:"font-medium py-1",children:$.language})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-3 flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\ud83d\udc64"}),(0,a.jsx)("span",{children:"Utilisateur:"})]}),(0,a.jsx)("table",{className:"w-full text-sm",children:(0,a.jsxs)("tbody",{className:"space-y-2",children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Email:"}),(0,a.jsx)("td",{className:"font-medium py-1",children:$.user_email})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Session:"}),(0,a.jsxs)("td",{className:"font-medium py-1",children:[$.session_id.substring(0,12),"..."]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Date:"}),(0,a.jsx)("td",{className:"font-medium py-1",children:new Date($.timestamp).toLocaleString("fr-FR")})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-gray-600 py-1",children:"Feedback:"}),(0,a.jsx)("td",{className:"text-lg py-1",children:(oe=$.feedback,1===oe?"\ud83d\udc4d":-1===oe?"\ud83d\udc4e":"\u2753")})]})]})})]})]}),$.feedback_comment&&(0,a.jsxs)("div",{className:"bg-purple-50 p-4 border border-purple-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\ud83d\udcad"}),(0,a.jsx)("span",{children:"Commentaire:"})]}),(0,a.jsxs)("p",{className:"text-gray-700 italic",children:['"',$.feedback_comment,'"']})]})]})})]})})]})]});var oe};function x(){return(0,a.jsx)(d,{})}}},function(e){e.O(0,[216,286,744],(function(){return s=2241,e(e.s=s);var s}));var s=e.O();_N_E=s}]);